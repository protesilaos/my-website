---
layout: page
title: 'Change Log of Denote'
subtitle: 'Simple notes for Emacs with an efficient file-naming scheme'
excerpt: "Denote is a simple note-taking tool, based on the idea that notes should follow a predictable and descriptive file-naming scheme."
permalink: /emacs/denote-changelog
---

<p>
This document contains the release notes for each tagged commit on the
project&rsquo;s main git repository: <a href="https://github.com/protesilaos/denote">https://github.com/protesilaos/denote</a>.
</p>

<p>
The newest release is at the top.  For further details, please consult
the manual: <a href="https://protesilaos.com/emacs/denote">https://protesilaos.com/emacs/denote</a>.
</p>

<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#h:385847d5-4990-4c1f-9869-82113fe1b47f">1. Version 4.1.0 on 2025-10-17</a></li>
<li><a href="#h:8a134846-72cc-4fbf-830d-6ca9fd0f9ec8">2. Version 4.0.0 on 2025-04-15</a></li>
<li><a href="#h:f089ab11-4ad7-4fd9-9bf3-2deb2e070297">3. Version 3.1.0 on 2024-09-04</a></li>
<li><a href="#h:bf5e869d-548f-4c77-bf1c-b7dcf6d1d4da">4. Version 3.0.0 on 2024-06-30</a></li>
<li><a href="#h:e9d3ebdb-8a69-47a9-a5a2-619abc44b7d2">5. Version 2.3.0 on 2024-03-24</a></li>
<li><a href="#h:8efed390-cfa0-420d-b300-0cb76bf2c9f9">6. Version 2.2.0 on 2023-12-10</a></li>
<li><a href="#h:167beb8f-14be-40de-a1f2-d13910924c00">7. Version 2.1.0 on 2023-11-12</a></li>
<li><a href="#h:3f17bf03-4c47-4410-abf8-1db4a0ac7775">8. Version 2.0.0 on 2023-07-21</a></li>
<li><a href="#h:92478a05-4a69-413c-8d95-1dacbcf6af2c">9. Version 1.2.0 on 2022-12-12</a></li>
<li><a href="#h:8e0f536a-ab3b-4cab-82f7-529bc0e40dbd">10. Version 1.1.0 on 2022-10-20</a></li>
<li><a href="#h:053975d7-3fe2-49e5-96a0-336483e5861c">11. Version 1.0.0 on 2022-09-30</a></li>
<li><a href="#h:50aba79a-d702-42b4-a2a5-7fa29033f904">12. Version 0.6.0 on 2022-08-31</a></li>
<li><a href="#h:80b9daaa-c3c8-4457-b109-966bb6a99832">13. Version 0.5.0 on 2022-08-10</a></li>
<li><a href="#h:1c8098ee-089c-4511-bc6a-4140aab01321">14. Version 0.4.0 on 2022-07-25</a></li>
<li><a href="#h:6864cfd4-d0be-4c89-b313-39ba6e892a03">15. Version 0.3.0 on 2022-07-11</a></li>
<li><a href="#h:2002fee6-3f0c-48be-9727-6d4e20f34856">16. Version 0.2.0 on 2022-07-04</a></li>
<li><a href="#h:33939747-ad60-4913-a170-4b2f48f139cc">17. Version 0.1.0 on 2022-06-27</a></li>
</ul>
</div>
</div>
<div id="outline-container-h:385847d5-4990-4c1f-9869-82113fe1b47f" class="outline-2">
<h2 id="h:385847d5-4990-4c1f-9869-82113fe1b47f"><span class="section-number-2">1.</span> Version 4.1.0 on 2025-10-17</h2>
<div class="outline-text-2" id="text-h:385847d5-4990-4c1f-9869-82113fe1b47f">
<p>
The overarching theme of version <code>4.1.0</code> is that of continuing to
deliver on the highly hackable/flexible/powerful potential of Denote.
All the core functionality is the same as before and you still only
need a tiny configuration to use Denote productively. We are adding
more refinements and subtle improvements under the hood, while making
it even easier for advanced users/developers to piece together a
workflow that matches their particular needs.
</p>

<p>
Since version <code>4.0.0</code>, we have moved the &ldquo;Denote extras&rdquo; files into
their own packages. I cover their changes further down after I
elaborate on all the changes to the core Denote package:
</p>

<ul class="org-ul">
<li><a href="#h:ce5befb1-0401-4b06-ad4f-64c567b15b91"><code>denote-journal</code> version 0.2.0</a></li>
<li><a href="#h:1403c3b9-280d-4033-a930-5364bf7b5e90"><code>denote-org</code> version 0.2.0</a></li>
<li><a href="#h:d2e18b7d-dc8d-48ad-a0d7-71f291d5aa7c"><code>denote-sequence</code> version 0.2.0</a></li>
</ul>

<p>
Note that I write all the release notes by hand. The reason is that I
consider this process an essential part of my role as a maintainer.
Taking the time to review and document everything ensures that (i) I am
well informed about the state of the package, (ii) I did not forget
anything about this development cycle, and (iii) I take another look
at the changes we made to ensure everything is in order.
</p>
</div>
<div id="outline-container-h:47ec2fca-8fd4-4f96-af89-454e0a001e46" class="outline-3">
<h3 id="h:47ec2fca-8fd4-4f96-af89-454e0a001e46"><span class="section-number-3">1.1.</span> Overview of the new features for core Denote</h3>
<div class="outline-text-3" id="text-h:47ec2fca-8fd4-4f96-af89-454e0a001e46">
<ul class="org-ul">
<li>The user option <code>denote-directory</code> can be assigned to a list of
directories. The original string value is also acceptable and
remains the default.</li>

<li>Advanced users can define a completely custom scheme for
identifiers. This can be as simple as automatically assigned ordinal
numbers to increasingly complex patterns that may also involve user
input.</li>

<li>The command <code>denote-find-backlink-with-location</code> is like
<code>denote-find-backlink</code> except it also moves to the exact location of
the link in the corresponding file.</li>

<li>All Denote buffer names share a common prefix, which is subject to
the user option <code>denote-buffer-name-prefix</code>. This makes it easier to
spot them in the buffer list.</li>

<li>The command <code>denote-dired</code> (alias <code>denote-sort-dired</code>) can sort
files by <code>random</code> and <code>last-modified</code> in addition to the methods
that involve Denote file name components.</li>

<li>The user option <code>denote-query-sorting</code> controls how files in all
query buffers are sorted by default. This covers backlinks, query
links for file contents, and any buffer produced by the
<code>denote-grep</code> command. It benefits from the internal &ldquo;Denote sort&rdquo;
mechanism, which is also used by <code>denote-dired</code> and the Org dynamic
blocks of the <code>denote-org</code> package.</li>
</ul>

<p>
Remember that the release notes are true only at the time of
publication. The single source of truth always is the official manual.
</p>
</div>
</div>
<div id="outline-container-h:60ed9223-a092-4d2a-a6b6-3ba72150648b" class="outline-3">
<h3 id="h:60ed9223-a092-4d2a-a6b6-3ba72150648b"><span class="section-number-3">1.2.</span> Set <code>denote-directory</code> to a list of directories</h3>
<div class="outline-text-3" id="text-h:60ed9223-a092-4d2a-a6b6-3ba72150648b">
<p>
The user option <code>denote-directory</code> can optionally be bound to a list
of file system paths, each of which represents a directory root, such
as <code>'("/home/prot/Documents/work/" "=/home/prot/Git/hut/")</code> (Denote
has always supported subdirectories, even for a singular <code>denote-directory</code>).
</p>

<p>
When creating new files, such as with the <code>denote</code> command, the first
directory on the list will be selected. This can be changed by
modifying the <code>denote-prompts</code> user option so that it asks for a
directory or subdirectory thereof. Or by writing small wrapper
commands that put files in a predefined directory, like this:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(defun my-denote-for-work ()
  "Like `denote' but always use the ~/Documents/work/ directory."
  (interactive)
  (let ((denote-use-directory "~/Documents/work/"))
    (call-interactively 'denote)))
</pre>
</div>

<p>
Why have many directories as part of the <code>denote-directory</code>? Some
users want to maintain separate directories with Denote files, while
retaining the option of establishing links between (unlike the concept
of &ldquo;silos&rdquo; we support, where the directories are self-contained).
Those two directories can be their own Git repositories, for example,
and have different syncing policies for access across multiple
devices.
</p>

<p>
Thanks to Jean-Philippe Gagné Guay for providing the core
functionality in pull request 609: <a href="https://github.com/protesilaos/denote/pull/609">https://github.com/protesilaos/denote/pull/609</a>.
</p>

<p>
Jean-Philippe is a long-time contributor who has assigned copyright to
the Free Software Foundation. I made several changes on top, such as
to allow <code>denote-dired</code> (alias <code>denote-sort-dired</code>) to work with many
directories, by finding their common root (which would ultimately be
<code>/</code>).
</p>
</div>
</div>
<div id="outline-container-h:e15ef74b-d86e-4c36-812b-2ebd0f4b7dcf" class="outline-3">
<h3 id="h:e15ef74b-d86e-4c36-812b-2ebd0f4b7dcf"><span class="section-number-3">1.3.</span> Define completely custom Denote identifiers</h3>
<div class="outline-text-3" id="text-h:e15ef74b-d86e-4c36-812b-2ebd0f4b7dcf">
<p>
The default Denote identifier should work for most people in most
cases. I have considered the Denote file-naming scheme carefully and
know it is reliable. Advanced users who have a clear use-case of
something out-of-the-ordinary can now get &ldquo;Denoted&rdquo; file names with
arbitrary identifiers. Since this is an advanced feature, I will not
elaborate here on the technicalities. Though I have taken the time to
write at length in the manual about it, with concrete examples ranging
from simple to more complex scenaria. Start with this introduction:
<a href="https://protesilaos.com/emacs/denote#h:3048f558-7d84-45d6-9ef2-53055483e801">https://protesilaos.com/emacs/denote#h:3048f558-7d84-45d6-9ef2-53055483e801</a>.
</p>

<p>
This feature has been discussed and requested for a long time, across
several related issues:
</p>

<ul class="org-ul">
<li><a href="https://github.com/protesilaos/denote/issues/278">https://github.com/protesilaos/denote/issues/278</a>.</li>
<li><a href="https://github.com/protesilaos/denote/issues/474">https://github.com/protesilaos/denote/issues/474</a>.</li>
<li><a href="https://github.com/protesilaos/denote/issues/581">https://github.com/protesilaos/denote/issues/581</a>.</li>
</ul>

<p>
Thanks, in no particular order, to mentalisttraceur, juh2, Christian
Tietze, and Jean-Philippe Gagné Guay for sharing their thoughts. Also
thanks to Jean-Philippe Gagné Guay for contributing the patches that
made this possible, the last of which is in pull request 586:
<a href="https://github.com/protesilaos/denote/issues/586">https://github.com/protesilaos/denote/issues/586</a>.
</p>
</div>
</div>
<div id="outline-container-h:f0388079-05f6-417b-b232-42aee3447909" class="outline-3">
<h3 id="h:f0388079-05f6-417b-b232-42aee3447909"><span class="section-number-3">1.4.</span> Find a backlink at its exact location in the file</h3>
<div class="outline-text-3" id="text-h:f0388079-05f6-417b-b232-42aee3447909">
<p>
Denote has two ways of working with backlinks: (i) to display them in
a dedicated buffer and (ii) to use a minibuffer prompt that supports
completion in order to pick one file out of the list. The new command
<code>denote-find-backlink-with-location</code> is of the latter kind. Like its
more generic <code>denote-find-backlink</code> counterpart, it uses the
minibuffer to pick a file that links to the current one. Then, it also
moves the cursor to where the link is.
</p>

<p>
I did this is in response to issue 471 as reported by johkneisl:
<a href="https://github.com/protesilaos/denote/issues/471">https://github.com/protesilaos/denote/issues/471</a>.
</p>
</div>
</div>
<div id="outline-container-h:9057709b-8e5f-4628-9463-8bd938a8e92e" class="outline-3">
<h3 id="h:9057709b-8e5f-4628-9463-8bd938a8e92e"><span class="section-number-3">1.5.</span> Denote buffer names use the <code>denote-buffer-name-prefix</code></h3>
<div class="outline-text-3" id="text-h:9057709b-8e5f-4628-9463-8bd938a8e92e">
<p>
This is a new user option that takes an arbitrary string. Its value is
<code>"[D]"</code> by default. It consolidates how we name all of our buffers.
Out-of-the-box, this applies to special buffers, like those produced
by the commands <code>denote-backlinks</code> and <code>denote-dired</code>. When the
optional minor mode <code>denote-rename-buffer-mode</code> is enabled, all
buffers whose file naming scheme is that of Denote will get the
<code>denote-buffer-name-prefix</code> in addition to their own <code>denote-rename-buffer-format</code>.
</p>

<p>
This is related to pull request 597 by James Kalyan:
<a href="https://github.com/protesilaos/denote/pull/597">https://github.com/protesilaos/denote/pull/597</a>. James has assigned
copyright to the Free Software Foundation.
</p>
</div>
</div>
<div id="outline-container-h:f6ea4714-1ed4-4db7-ad4b-c040b6c60c6d" class="outline-3">
<h3 id="h:f6ea4714-1ed4-4db7-ad4b-c040b6c60c6d"><span class="section-number-3">1.6.</span> The Denote sort mechanism can sort by <code>random</code> and <code>last-modified</code></h3>
<div class="outline-text-3" id="text-h:f6ea4714-1ed4-4db7-ad4b-c040b6c60c6d">
<p>
In core Denote, this is used internally by the <code>denote-dired</code> command
(alias <code>denote-sort-dired</code>) and the query buffers (more in the next
section). By default, <code>denote-dired</code> prompts for the sort method and
whether to reverse the order. Though there are user options to tweak
its behaviour (consult the manual). The Org dynamic blocks of the
<code>denote-org</code> package also rely on this mechanism (<a href="#h:1403c3b9-280d-4033-a930-5364bf7b5e90"><code>denote-org</code> version 0.2.0</a>).
</p>
</div>
</div>
<div id="outline-container-h:42bd3513-98fa-4653-9e4b-b0918938ae3b" class="outline-3">
<h3 id="h:42bd3513-98fa-4653-9e4b-b0918938ae3b"><span class="section-number-3">1.7.</span> Control the default sort of files in query buffers</h3>
<div class="outline-text-3" id="text-h:42bd3513-98fa-4653-9e4b-b0918938ae3b">
<p>
Query buffers are those of <code>denote-backlinks</code>, <code>denote-grep</code>, and
<code>denote-query-contents-link</code> (in the latter case, the query buffer is
produced when you click on the link). Users can now modify how they
sort matching files via the option <code>denote-query-sorting</code>. The sorting
methods are by any of the Denote file names components (per
<code>denote-sort-components</code>), random order, last modified, or an
arbitrary function.
</p>

<p>
Thanks to Lucas Quintana for the contribution in pull request 594:
<a href="https://github.com/protesilaos/denote/pull/594">https://github.com/protesilaos/denote/pull/594</a>. Lucas has assigned
copyright to the Free Software Foundation.
</p>
</div>
</div>
<div id="outline-container-h:889e72d5-3532-431d-a691-2e2ca7237d58" class="outline-3">
<h3 id="h:889e72d5-3532-431d-a691-2e2ca7237d58"><span class="section-number-3">1.8.</span> Miscellaneous for core Denote</h3>
<div class="outline-text-3" id="text-h:889e72d5-3532-431d-a691-2e2ca7237d58">
<ul class="org-ul">
<li>The <code>denote-dired</code> command (alias <code>denote-sort-dired</code>) sets up its
<code>revert-buffer-function</code> in a more robust way, such that it does not
affect the window layout under certain conditions.</li>

<li>Fixed a bug with the menu entry of Denote that broke
<code>context-menu-mode</code>. It addresses issue 592, as reported by artelse:
<a href="https://github.com/protesilaos/denote/issues/592">https://github.com/protesilaos/denote/issues/592</a>. Thanks to Lucas
Quintana for the patch. Lucas has assigned copyright to the Free
Software Foundation.</li>

<li>Thanks to ryota for refining the documentation of the variable
<code>denote-use-template</code> and its potential interference with
<code>denote-org-capture-identifiers</code> in custom user code. We discussed
this in issue 545 and the patch was sent as pull request 598:
<ul class="org-ul">
<li><a href="https://github.com/protesilaos/denote/issues/545">https://github.com/protesilaos/denote/issues/545</a>.</li>
<li><a href="https://github.com/protesilaos/denote/pull/598">https://github.com/protesilaos/denote/pull/598</a>. The change is
small, meaning that ryota does not need to assign copyright to
the Free Software Foundation.</li>
</ul></li>

<li>An internal check to determine if a file has backlinks is now faster
than before: it exits with a non-<code>nil</code> value as soon as it finds one
match, instead of trying to collect all the backlinks. Thanks to
Yann Dutrieux for addressing an omission of mine in the original
implementation and then for discussing with me some further
refinements. Yann&rsquo;s contribution was sent as pull request 637:
<a href="https://github.com/protesilaos/denote/pull/637">https://github.com/protesilaos/denote/pull/637</a>.</li>

<li>Thanks to Alan Schmitt and Ashish Panigrahi for fixing a couple of
typos, in pull requests 623 and 626, respectively:
<ul class="org-ul">
<li><a href="https://github.com/protesilaos/denote/pull/623">https://github.com/protesilaos/denote/pull/623</a>.</li>
<li><a href="https://github.com/protesilaos/denote/pull/626">https://github.com/protesilaos/denote/pull/626</a>.</li>
</ul></li>
</ul>
</div>
</div>
<div id="outline-container-h:ef286c08-8e04-4d33-b72c-696c026c8183" class="outline-3">
<h3 id="h:ef286c08-8e04-4d33-b72c-696c026c8183"><span class="section-number-3">1.9.</span> Git commits for core Denote</h3>
<div class="outline-text-3" id="text-h:ef286c08-8e04-4d33-b72c-696c026c8183">
<div class="org-src-container">
<pre class="src src-sh">~/Git/Projects/denote $ git shortlog 4.0.0..4.1.0  --summary --numbered
   156	Protesilaos Stavrou
    29	Jean-Philippe Gagné Guay
     4	Lucas Quintana
     2	James Kalyan
     1	Alan Schmitt
     1	Ashish Panigrahi
     1	Hanwen Guo
     1	Ryota
     1	Yann Dutrieux
</pre>
</div>
</div>
</div>
<div id="outline-container-h:dec0751e-6757-46e8-9982-718cc454b1ed" class="outline-3">
<h3 id="h:dec0751e-6757-46e8-9982-718cc454b1ed"><span class="section-number-3">1.10.</span> Changes to the extensions of Denote I maintain</h3>
<div class="outline-text-3" id="text-h:dec0751e-6757-46e8-9982-718cc454b1ed">
<p>
This concerns all the former &ldquo;Denote extras&rdquo; that were shipped with
core Denote as well as <code>consult-denote</code>.
</p>
</div>
<div id="outline-container-h:52525fbf-6801-4676-91da-095a7439e582" class="outline-4">
<h4 id="h:52525fbf-6801-4676-91da-095a7439e582"><span class="section-number-4">1.10.1.</span> <code>consult-denote</code> version 0.4.0</h4>
<div class="outline-text-4" id="text-h:52525fbf-6801-4676-91da-095a7439e582">
<ul class="org-ul">
<li>The commands <code>consult-denote-grep</code> and <code>consult-denote-find</code> also
work when <code>denote-directory</code> is set to a list value, as explained
further above (<a href="#h:60ed9223-a092-4d2a-a6b6-3ba72150648b">Set <code>denote-directory</code> to a list of directories</a>).</li>

<li>There is a Consult-powered counterpart to the
<code>denote-sequence-file-prompt</code>. It is for users of the
<code>denote-sequence</code> package and comes into effect when the
<code>consult-denote-mode</code> is enabled (that mode &ldquo;Consults&rdquo; all relevant
minibuffer prompts Denote uses so they get the familiar preview
functionality). The <code>denote-sequence-file-prompt</code> is used by
commands such as <code>denote-sequence</code>, <code>denote-sequence-find</code>, and
<code>denote-sequence-link</code>, among others (<a href="#h:d2e18b7d-dc8d-48ad-a0d7-71f291d5aa7c"><code>denote-sequence</code> version 0.2.0</a>).</li>

<li>The command <code>consult-denote-find</code> sorts its files by default. We
discussed this with Gianluca Della Vedova and Gianluca implemented
the tweak in pull request 18:
<a href="https://github.com/protesilaos/consult-denote/pull/18">https://github.com/protesilaos/consult-denote/pull/18</a>. The change
is small, meaning that Gianluca does not need to assign copyright to
the Free Software Foundation.</li>
</ul>
</div>
</div>
<div id="outline-container-h:ce5befb1-0401-4b06-ad4f-64c567b15b91" class="outline-4">
<h4 id="h:ce5befb1-0401-4b06-ad4f-64c567b15b91"><span class="section-number-4">1.10.2.</span> <code>denote-journal</code> version 0.2.0</h4>
<div class="outline-text-4" id="text-h:ce5befb1-0401-4b06-ad4f-64c567b15b91">
<ul class="org-ul">
<li>It is now possible to specify the desired interval used by the
command <code>denote-journal-new-or-existing-entry</code> to determine what
&ldquo;new&rdquo; and &ldquo;existing&rdquo; mean. Users may want to, for example, maintain
one file per month, with daily entries as headings or as free-form
text. The user option <code>denote-journal-interval</code> specifies the
interval as a symbol among <code>daily</code>, <code>weekly</code>, <code>monthly</code>, and
<code>yearly</code>. Thanks to Ning Xu for floating the idea of non-daily
journaling in issue 18: <a href="https://github.com/protesilaos/denote-journal/issues/18">https://github.com/protesilaos/denote-journal/issues/18</a>.
<ul class="org-ul">
<li>Thanks to Alan Schmitt for catching a couple of errors in my
original implementation and for suggesting fixes in pull requests
20 and 21. Also thanks to Abdelhak Bougouffa for addressing
another problem in pull request 23. Further changes by me.
<ul class="org-ul">
<li><a href="https://github.com/protesilaos/denote-journal/pull/20">https://github.com/protesilaos/denote-journal/pull/20</a>.</li>
<li><a href="https://github.com/protesilaos/denote-journal/pull/21">https://github.com/protesilaos/denote-journal/pull/21</a>.</li>
<li><a href="https://github.com/protesilaos/denote-journal/pull/23">https://github.com/protesilaos/denote-journal/pull/23</a>.</li>
</ul></li>
</ul></li>

<li><p>
The new user option <code>denote-journal-signature</code> specifies a signature
that will be applied to all new journal entries. It is the
counterpart of <code>denote-journal-keyword</code>. Possible values are <code>nil</code>,
for no predefined signature, a string for a constant signature, and a
function that returns a string which is then used as-is. Thanks to
Halogen3576 for suggesting an option for a signature in issue 13:
<a href="https://github.com/protesilaos/denote-journal/issues/13">https://github.com/protesilaos/denote-journal/issues/13</a>.
</p>

<p>
In the case of a function value, users may wish to integrate the
<code>denote-journal</code> package with the <code>denote-sequence</code> package
(<a href="#h:d2e18b7d-dc8d-48ad-a0d7-71f291d5aa7c"><code>denote-sequence</code> version 0.2.0</a>). For example, each new journal
entry should be defined as a new parent sequence. Thus:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (setq denote-journal-signature
        (lambda ()
          (denote-sequence-get-new 'parent)))
</pre>
</div></li>

<li>The user option <code>denote-journal-keyword</code> is extended to support a
function value which should return a string or list of strings.</li>

<li>The integration with <code>M-x calendar</code> (when the minor mode
<code>denote-journal-calendar-mode</code> is enabled) is more robust when
highlighting dates that have a Denote journal entry. Thanks to Alan
Schmitt for the patch that improves the check for visible dates
only. This was done in pull request 12: <a href="https://github.com/protesilaos/denote-journal/pull/12">https://github.com/protesilaos/denote-journal/pull/12</a>.</li>

<li>The <code>denote-journal-calendar</code> face is extended to also work when
Emacs is ran in a TTY. Thanks to Ettore Berardi for the original
contribution and for discussing this with me. It was done in pull
request 14: <a href="https://github.com/protesilaos/denote-journal/pull/14">https://github.com/protesilaos/denote-journal/pull/14</a>.
The contribution is less than 15 lines of code, meaning that Ettore
does not need to assign copyright to the Free Software Foundation.</li>

<li>The function <code>denote-journal-path-to-new-or-existing-entry</code> is
tweaked to not kill the buffer of the new file it might generate.
Thanks to jbwfu for the change in pull request 17:
<a href="https://github.com/protesilaos/denote-journal/pull/17">https://github.com/protesilaos/denote-journal/pull/17</a>. The change
is small, meaning that the author does not need to assign copyright
to the Free Software Foundation.</li>

<li>Dates with a single digit in the title of a new journal entry no
longer have a space where the second digit normally is. So something
like <code>October 1</code> instead of <code>October  1</code>. Thanks to Josh Kingsley for
the patch. The change is small, meaning that Josh does not need to
assign copyright to the Free Software Foundation. It was done in
pull request 24: <a href="https://github.com/protesilaos/denote-journal/pull/24">https://github.com/protesilaos/denote-journal/pull/24</a>.</li>

<li>Thanks to gk2803 for renaming a couple of old symbols to their
current names in the commentary of the package. This was done in
pull request 10: <a href="https://github.com/protesilaos/denote-journal/pull/10">https://github.com/protesilaos/denote-journal/pull/10</a>.</li>
</ul>

<div class="org-src-container">
<pre class="src src-sh">~/Git/Projects/denote-journal $ git shortlog 0.1.0..0.2.0  --summary --numbered
    35	Protesilaos Stavrou
     3	Alan Schmitt
     2	Ettore Berardi
     1	Abdelhak Bougouffa
     1	Josh Kingsley
     1	gk2803
     1	jbwfu
</pre>
</div>
</div>
</div>
<div id="outline-container-h:1403c3b9-280d-4033-a930-5364bf7b5e90" class="outline-4">
<h4 id="h:1403c3b9-280d-4033-a930-5364bf7b5e90"><span class="section-number-4">1.10.3.</span> <code>denote-org</code> version 0.2.0</h4>
<div class="outline-text-4" id="text-h:1403c3b9-280d-4033-a930-5364bf7b5e90">
<ul class="org-ul">
<li>A new Org dynamic block integrates with the <code>denote-sequence</code>
package (<a href="#h:d2e18b7d-dc8d-48ad-a0d7-71f291d5aa7c"><code>denote-sequence</code> version 0.2.0</a>). The block is called
<code>denote-sequence</code> and can be inserted at point with the command
<code>denote-org-dblock-insert-sequence</code>. What this block does is list
the descendants of a given sequence up to a maximum depth. The
presentation is a typographic list of lists to visualise the
hierarchy of the complete sequence, with each set of children nested
under its parent. Thanks to Peter Prevos for the original
implementation in pull request 9 and for subsequent tweaks in pull
request 13. Other changes by me are done to ensure tighter
integration with the <code>denote-sequence</code> package.

<ul class="org-ul">
<li><a href="https://github.com/protesilaos/denote-org/pull/9">https://github.com/protesilaos/denote-org/pull/9</a>.</li>
<li><a href="https://github.com/protesilaos/denote-org/pull/13">https://github.com/protesilaos/denote-org/pull/13</a>.</li>
</ul></li>

<li>All Org dynamic blocks that have a <code>:sort-by-component</code> parameter
can now sort by <code>random</code> and <code>last-modified</code>. This is made possible
by the aforementioned improvements to the core Denote sort mechanism
(<a href="#h:f6ea4714-1ed4-4db7-ad4b-c040b6c60c6d">The Denote sort mechanism can sort by <code>random</code> and <code>last-modified</code></a>).</li>

<li>The <code>denote-missing-links</code> Org dynamic block, which can be inserted
at point with the command <code>denote-org-dblock-insert-missing-links</code>
takes an optional <code>:not-regexp</code> parameter. This is a regular
expression of files to omit from the results. Same for the
<code>denote-backlinks</code> block, which can be inserted at point with the
command <code>denote-org-dblock-insert-backlinks</code>.</li>

<li>The <code>denote-files-as-headings</code> Org dynamic block, which can be
inserted at point with the command <code>denote-org-dblock-insert-files-as-headings</code>
now also accepts an optional <code>:exclude-tags</code> parameter. It is either
<code>nil</code> or non-<code>nil</code> and determines whether the heading will have the
file&rsquo;s <code>#+filetags</code> as its own tags. Thanks to Matt Nolan for
suggesting this idea in issue 14: <a href="https://github.com/protesilaos/denote-org/issues/14">https://github.com/protesilaos/denote-org/issues/14</a>.</li>
</ul>

<div class="org-src-container">
<pre class="src src-sh">~/Git/Projects/denote-org $ git shortlog 0.1.0..0.2.0  --summary --numbered
    42	Protesilaos Stavrou
     8	Peter Prevos
</pre>
</div>
</div>
</div>
<div id="outline-container-h:d2e18b7d-dc8d-48ad-a0d7-71f291d5aa7c" class="outline-4">
<h4 id="h:d2e18b7d-dc8d-48ad-a0d7-71f291d5aa7c"><span class="section-number-4">1.10.4.</span> <code>denote-sequence</code> version 0.2.0</h4>
<div class="outline-text-4" id="text-h:d2e18b7d-dc8d-48ad-a0d7-71f291d5aa7c">
<ul class="org-ul">
<li>The new commands <code>denote-sequence-find-next-sibling</code> and
<code>denote-sequence-find-previous-sibling</code> move to the next or previous
sibling in the given sequence. When called interactively, they work
relative to the current file. When called from Lisp, they expect a
<code>SEQUENCE</code> argument and its corresponding <code>RELATIVES</code>.</li>

<li>The <code>denote-sequence-dired</code> command is updated to (i) work with a
list value for <code>denote-directory</code> (<a href="#h:60ed9223-a092-4d2a-a6b6-3ba72150648b">Set <code>denote-directory</code> to a list of directories</a>),
as noted further above and (ii) benefit from the refinements done to
<code>denote-dired</code> with regard to its <code>revert-buffer-function</code>.</li>

<li><p>
The new command <code>denote-sequence-rename-as-parent</code> makes it easier
to apply the Denote file-naming scheme to an existing file and make
it a new parent sequence. Thanks to Alex Carney for requesting
something along those lines in issue 4:
<a href="https://github.com/protesilaos/denote-sequence/issues/4">https://github.com/protesilaos/denote-sequence/issues/4</a>.
</p>

<p>
[ Remember that Denote is highly adaptable/hackable, meaning that
  many of these convenience commands build on top of the core with small
  extensions to it. The body of <code>denote-sequence-rename-as-parent</code> is
  only 4 lines long, two of which are for an error check. This is
  typical of much of what we provide and is how users can always
  extend Denote to do something slightly different than what we
  support out-of-the-box. ]
</p></li>

<li>Made several other refinements under the hood, including the
addition of more tests. In this regard, thanks to Rory Molinari,
Peter Prevos, and Ashton Wiersdorf for fixing three bugs in pull
requests 5, 8, and 11, respectively:
<ul class="org-ul">
<li><a href="https://github.com/protesilaos/denote-sequence/pull/5">https://github.com/protesilaos/denote-sequence/pull/5</a>.</li>
<li><a href="https://github.com/protesilaos/denote-sequence/pull/8">https://github.com/protesilaos/denote-sequence/pull/8</a>.</li>
<li><a href="https://github.com/protesilaos/denote-sequence/pull/11">https://github.com/protesilaos/denote-sequence/pull/11</a>.</li>
</ul></li>
</ul>

<div class="org-src-container">
<pre class="src src-sh">~/Git/Projects/denote-sequence $ git shortlog 0.1.0..0.2.0  --summary --numbered
    61	Protesilaos Stavrou
     1	Ashton Wiersdorf
     1	Peter Prevos
     1	Rory Molinari
</pre>
</div>
</div>
</div>
<div id="outline-container-h:6c5aa212-226f-4f14-a4e9-2d1eb00d7707" class="outline-4">
<h4 id="h:6c5aa212-226f-4f14-a4e9-2d1eb00d7707"><span class="section-number-4">1.10.5.</span> Changes to <code>denote-markdown</code></h4>
<div class="outline-text-4" id="text-h:6c5aa212-226f-4f14-a4e9-2d1eb00d7707">
<p>
Nothing of substance.
</p>
</div>
</div>
<div id="outline-container-h:f5f6675e-fbbe-45c8-9a05-dbcc611c6dab" class="outline-4">
<h4 id="h:f5f6675e-fbbe-45c8-9a05-dbcc611c6dab"><span class="section-number-4">1.10.6.</span> Changes to <code>denote-silo</code></h4>
<div class="outline-text-4" id="text-h:f5f6675e-fbbe-45c8-9a05-dbcc611c6dab">
<p>
Nothing of substance.
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-h:8a134846-72cc-4fbf-830d-6ca9fd0f9ec8" class="outline-2">
<h2 id="h:8a134846-72cc-4fbf-830d-6ca9fd0f9ec8"><span class="section-number-2">2.</span> Version 4.0.0 on 2025-04-15</h2>
<div class="outline-text-2" id="text-h:8a134846-72cc-4fbf-830d-6ca9fd0f9ec8">
<p>
This is a massive release. There is one breaking change, which should
be easy to adapt to: this pertains to the reorganisation of the
project to separate the &ldquo;core&rdquo; of Denote from its &ldquo;extensions&rdquo;. The
core is the <code>denote</code> package. Each extension now has its own package
(details below).
</p>

<p>
Other than that, this version includes lots of new features for
searching and linking as well as quality-of-life refinements. We have
generalised the infrastructure for performing queries in the
<code>denote-directory</code> and made the buffers with the search results more
useful.
</p>

<p>
Take your time to read through this publication. I am writing it for
you. Also remember that the most up-to-date resource for anything
related to Denote is its manual. You are always welcome to contact me:
<a href="https://protesilaos.com/contact">https://protesilaos.com/contact</a>. Or join the development on the Git
repository.
</p>

<p>
As usual, special thanks to Jean-Philippe Gagné Guay for making high
quality contributions to Denote since the beginning of the project ~3
years ago. Those will not always be headline features, but are
important improvements to the underlying code base.
</p>

<p>
I mention contributions from Jean-Philippe and others in its context.
Though I do not cover implementation details, otherwise this document
will be the size of a book. This does not mean that they are no
important though. Please consult the Git commit log for all the
technicalities.
</p>
</div>
<div id="outline-container-h:26ed2af1-60c8-4217-93b3-bbe344e4eb7b" class="outline-3">
<h3 id="h:26ed2af1-60c8-4217-93b3-bbe344e4eb7b"><span class="section-number-3">2.1.</span> All the &ldquo;extras&rdquo; are in separate packages, including the Org dynamic blocks</h3>
<div class="outline-text-3" id="text-h:26ed2af1-60c8-4217-93b3-bbe344e4eb7b">
<p>
In previous versions of Denote, we included some optional extensions
as part of the <code>denote</code> package. These included the files
<code>denote-org-extras.el</code> (Org dynamic blocks, among others),
<code>denote-journal-extras.el</code> (streamlined for journaling),
<code>denote-silo-extras.el</code> (working with multiple Denote silos).
</p>

<p>
The files <code>denote-md-extras.el</code> (Markdown extras) and
<code>denote-sequence.el</code> (sequence notes, including Luhmann-style
alphanumeric sequences) were also part of the project during the last
development cycle, though they never made it into a tagged release.
</p>

<p>
All these are now available as standalone packages on the official GNU
ELPA archive:
</p>

<dl class="org-dl">
<dt><code>denote-org</code></dt><dd>In the Emacs configuration file, replace all
instances of <code>denote-org-extras</code> with <code>denote-org</code>.</dd>

<dt><code>denote-journal</code></dt><dd>Replace <code>denote-journal-extras</code> with <code>denote-journal</code>.</dd>

<dt><code>denote-silo</code></dt><dd>Replace <code>denote-silo-extras</code> with <code>denote-silo</code>.</dd>

<dt><code>denote-markdown</code> </dt><dd>Replace <code>denote-md-extras</code> with <code>denote-markdown</code>.</dd>

<dt><code>denote-sequence</code></dt><dd>No changes to any of the defined symbols.
Simply get the new package.</dd>
</dl>

<p>
I will document each of these packages further below. The plan, going
forward, is to maintain all the packages and coordinate their new
versions.
</p>
</div>
</div>
<div id="outline-container-h:3820e9cf-f034-4c3c-a4ed-1e7d11f1cd23" class="outline-3">
<h3 id="h:3820e9cf-f034-4c3c-a4ed-1e7d11f1cd23"><span class="section-number-3">2.2.</span> More things in &ldquo;core&rdquo;</h3>
<div class="outline-text-3" id="text-h:3820e9cf-f034-4c3c-a4ed-1e7d11f1cd23">
<p>
While the extras are moved out to their own code repositories, all
other features are merged into <code>denote.el</code>. Those include everything
that was in <code>denote-sort.el</code> and <code>denote-rename-buffer.el</code>.
</p>

<ul class="org-ul">
<li>The &ldquo;sort&rdquo; mechanism is mostly for package developers. We use it
extensively in our Org dynamic blocks, which are now part of the
<code>denote-org</code> package.</li>

<li>The <code>denote-dired</code> command (alias <code>denote-sort-dired</code>) is the only
user-facing &ldquo;sort&rdquo; command we have always provided. It produces a
fully fledged Dired buffer showing the results of the given search
for file names. The matching files are sorted according to the
user&rsquo;s expressed preference. The details are described in the
manual.</li>

<li>The <code>denote-rename-buffer-mode</code> and all of its user options are
unchanged. This mode automatically renames the buffer of a given
Denote file so that it is easier to read it. Again, the manual
covers the technicalities.</li>
</ul>

<p>
Users do not need to make changes, unless they are explicitly loading
<code>denote-sort-dired</code> and <code>denote-rename-buffer</code>. In that case, they may
just remove those calls: only <code>denote</code> needs to be loaded.
</p>
</div>
</div>
<div id="outline-container-h:36f305e2-310d-4327-941a-ca0570b473d2" class="outline-3">
<h3 id="h:36f305e2-310d-4327-941a-ca0570b473d2"><span class="section-number-3">2.3.</span> The <code>denote-query-mode</code></h3>
<div class="outline-text-3" id="text-h:36f305e2-310d-4327-941a-ca0570b473d2">
<p>
Many of the features I will describe below produce search results via
the built-in Xref mechanism. Xref performs a search with a Grep or
Grep-like program, subject to the user option <code>xref-search-program</code>.
The buffer those search results are displayed in runs the
<code>denote-query-mode</code>. It supersedes <code>denote-backlinks-mode</code>.
</p>

<p>
The <code>denote-query-mode</code> supports the following:
</p>

<ul class="org-ul">
<li>Results are shown in the context, with the exact match in highlight.</li>
<li>Matches are grouped by file. Each file is a &ldquo;heading&rdquo;.</li>
<li>Headings can be folded with <code>TAB</code>, just how it is done in Org buffers.</li>
<li>The results can be used for further queries. Type <code>C-h m</code>
(<code>describe-mode</code>) to learn about all the relevant commands.</li>
</ul>

<p>
We have had support for Xref since the original version of Denote. It
now is more generalised to cover backlinks, query links, and
<code>denote-grep</code> (more below).
</p>
</div>
</div>
<div id="outline-container-h:c217a37a-db73-46bd-ab5f-3f9c54f9d53b" class="outline-3">
<h3 id="h:c217a37a-db73-46bd-ab5f-3f9c54f9d53b"><span class="section-number-3">2.4.</span> Use query links for file contents or file names</h3>
<div class="outline-text-3" id="text-h:c217a37a-db73-46bd-ab5f-3f9c54f9d53b">
<p>
Denote has always provided the option to link directly to a file with
a given name by referencing its identifier. This can be done with the
command <code>denote-link</code>, among a few others like it (always consult the
manual of Denote).
</p>

<p>
In addition to these &ldquo;direct links&rdquo;, we also support &ldquo;query links&rdquo;.
Those do not point to a file but instead trigger a search. The results
are placed in a buffer that uses the appropriate major mode.
</p>

<p>
There are two types of query links:
</p>

<dl class="org-dl">
<dt>Query file contents</dt><dd>Use the command <code>denote-query-contents-link</code>
to insert a query link at point for &ldquo;file contents&rdquo;. It perform a
search inside files in the <code>denote-directory</code> and put the results in
a <code>denote-query-mode</code> buffer.</dd>

<dt>Query file names</dt><dd>Use the <code>denote-query-filenames-link</code> to insert
a query link for &ldquo;file names&rdquo;. It performs the query against file
names (not contents!) and puts the results in a <code>dired</code> buffer.</dd>
</dl>

<p>
The display of the buffer with the query link results is controlled by
the user option <code>denote-query-links-display-buffer-action</code>.
</p>

<p>
Query links are styled a little bit differently than direct links.
Compare the <code>denote-faces-link</code> with <code>denote-faces-query-link</code>. Both
should look okay with most themes.
</p>

<p>
Denote query links are supported as part of the <code>denote:</code> hyperlink
type. They are available in all file types we define (per the user
option <code>denote-file-type</code>) and should, in principle, work in any
custom file type (advanced users can check the variable <code>denote-file-types</code>).
</p>
</div>
</div>
<div id="outline-container-h:8ebc6ae8-1087-46fa-a0ec-464749f0ac4d" class="outline-3">
<h3 id="h:8ebc6ae8-1087-46fa-a0ec-464749f0ac4d"><span class="section-number-3">2.5.</span> Backlinks now always show their context</h3>
<div class="outline-text-3" id="text-h:8ebc6ae8-1087-46fa-a0ec-464749f0ac4d">
<p>
In the past, the command <code>denote-backlinks</code> would produce a bespoke
buffer showing a list of file names that included links to the current
file (any file with the Denote file-naming scheme can have backlinks,
by the way, including PDFs, videos, etc.). This buffer did not provide
any additional functionality. We used to support the option to show
results in their context via <code>denote-backlinks-show-context</code>. Those
would be rendered in a standard Xref buffer.
</p>

<p>
The contextual results are now the default and sole option. This is
because we have expanded the functionality of those buffers to use the
<code>denote-query-mode</code>, as explained above. Plus, it makes our code base
simpler.
</p>

<p>
Users will notice how backlikns look just like a query link for file
contents. This is because backlinks are the original query links since
day one of Denote.
</p>
</div>
</div>
<div id="outline-container-h:a1a7b766-328d-4883-93b2-c68b49bd1aa3" class="outline-3">
<h3 id="h:a1a7b766-328d-4883-93b2-c68b49bd1aa3"><span class="section-number-3">2.6.</span> Direct links to a file with matching contents</h3>
<div class="outline-text-3" id="text-h:a1a7b766-328d-4883-93b2-c68b49bd1aa3">
<p>
The command <code>denote-link-to-file-with-contents</code> allows users to
produce a direct link to a file whose contents (not file name!)
includes the given query.
</p>

<p>
Similarly, the command <code>denote-link-to-all-files-with-contents</code>
generates a typographic list (bullet list) to all files whose contents
match the given query.
</p>

<p>
The manual covers all linking commands in depth.
</p>
</div>
</div>
<div id="outline-container-h:5d2ac378-304c-4ea8-bbfb-b3f7b649b27d" class="outline-3">
<h3 id="h:5d2ac378-304c-4ea8-bbfb-b3f7b649b27d"><span class="section-number-3">2.7.</span> The essence of <code>denote-search</code> is part of <code>denote</code></h3>
<div class="outline-text-3" id="text-h:5d2ac378-304c-4ea8-bbfb-b3f7b649b27d">
<p>
The <code>denote-search</code> package by Lucas Quintana uses the infrastructure
of Denote to perform searches in file contents. We now provide its
feature set as part of core <code>denote</code>.
</p>

<p>
We decided to do this since query links already introduced all of the
requisite generalisations to <code>denote-query-mode</code>.
</p>

<p>
Users can rely on the commands <code>denote-grep</code>, <code>denote-grep-marked-dired-files</code>,
and <code>denote-grep-files-referenced-in-region</code>.
</p>

<p>
The placement of these buffers is subject to the user option
<code>denote-grep-display-buffer-action</code>.
</p>

<p>
This functionality was introduced in two pull requests by Lucas
Quintana, 571 and 573, with further changes by me:
</p>

<ul class="org-ul">
<li><a href="https://github.com/protesilaos/denote/pull/571">https://github.com/protesilaos/denote/pull/571</a>.</li>
<li><a href="https://github.com/protesilaos/denote/pull/573">https://github.com/protesilaos/denote/pull/573</a>.</li>
</ul>

<p>
Lucas has assigned copyright to the Free Software Foundation.
</p>

<p>
I think this was a much-needed addition to the core of Denote. It
complements <code>denote-dired</code> and query links.
</p>
</div>
</div>
<div id="outline-container-h:635b7f04-891a-4a8b-b420-4e0d9dadc232" class="outline-3">
<h3 id="h:635b7f04-891a-4a8b-b420-4e0d9dadc232"><span class="section-number-3">2.8.</span> Formatting of links with <code>denote-link-description-format</code></h3>
<div class="outline-text-3" id="text-h:635b7f04-891a-4a8b-b420-4e0d9dadc232">
<p>
The old user option <code>denote-link-description-function</code> is deprecated
and superseded by the new <code>denote-link-description-format</code>. The new
user option still accepts a custom function as its value, so the old
behaviour should be retained.
</p>

<p>
What the new <code>denote-link-description-format</code> supports is an easier
way to customise the description of a link by using format specifiers
for common options. For example, users who only want to see the title
of the linked file can do this:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(setq denote-link-description-format "%t")
</pre>
</div>

<p>
The documentation of this user option covers all the format specifiers
and further details.
</p>
</div>
</div>
<div id="outline-container-h:76a56ab5-c44b-4c67-8048-25dd0dd88dcf" class="outline-3">
<h3 id="h:76a56ab5-c44b-4c67-8048-25dd0dd88dcf"><span class="section-number-3">2.9.</span> Miscellaneous changes for all users</h3>
<div class="outline-text-3" id="text-h:76a56ab5-c44b-4c67-8048-25dd0dd88dcf">
<ul class="org-ul">
<li>The command <code>denote-add-front-matter</code> is superseded by
<code>denote-rename-file</code> and related. Those renaming commands will add
missing front matter or rewrite the modified lines of existing front
matter. This is due to refinements made by Jean-Philippe Gagné Guay
to the file renaming mechanism. We discussed this deprecation in
issue 498: <a href="https://github.com/protesilaos/denote/issues/498">https://github.com/protesilaos/denote/issues/498</a>. Also
thanks to Samuel Flint for reporting an earlier problem with file
name signatures: <a href="https://github.com/protesilaos/denote/issues/492">https://github.com/protesilaos/denote/issues/492</a>.</li>

<li>The user option <code>denote-open-link-function</code> specifies the function
used by Denote to open the file of a direct link.</li>

<li>The user option <code>denote-org-store-link-to-heading</code> can now be set to
form generic context links without a <code>PROPERTIES</code> drawer and
corresponding <code>CUSTOM_ID</code>. Set the value of this variable to
<code>'context</code>. Read its documentation for further details.</li>

<li>Also about <code>denote-org-store-link-to-heading</code>, we have changed its
default value to <code>nil</code>, which is what we were doing for most of
Denote&rsquo;s history. This means that, by default, <code>org-store-link</code> and
anything building on top of it will create a link only to the
current Denote file, like <code>denote:IDENTIFIER</code>, but not to the
current heading within that file. To create links to the
file+heading, set the value of this variable to <code>'id</code>.</li>

<li>The command <code>denote-dired-link-marked-notes</code> is an alias for
<code>denote-link-dired-marked-notes</code>.</li>

<li>The user option <code>denote-sort-dired-extra-prompts</code> control what
<code>denote-dired</code> (alias <code>denote-sort-dired</code>) prompts for. It accepts
either a nil value or a list of symbols among <code>sort-by-component</code>,
<code>reverse-sort</code>, and <code>exclude-regexp</code>. The order those symbols appear
in the list is significant, with the leftmost coming first.</li>

<li>There is a new <code>denote-sort-identifier-comparison-function</code> variable
which determines how identifier-based sorting should be done by
default. It complements the existing <code>denote-sort-title-comparison-function</code>,
<code>denote-sort-keywords-comparison-function</code>, <code>denote-sort-signature-comparison-function</code>.
Thanks to Maikol Solís for the contribution in pull request 517:
<a href="https://github.com/protesilaos/denote/pull/517">https://github.com/protesilaos/denote/pull/517</a>. The change is
small, meaning that Maikol does not need to assign copyright to the
Free Software Foundation (though I believe the paperwork is done, anyway).</li>

<li>Lots of refinements to the doc strings of individual variables
and/or functions as well as the manual.</li>

<li>Lots of other contributions to discussions and questions on the Git
repository. Granted, these are not &ldquo;changes&rdquo; per se but are part of
the development effort nonetheless.</li>

<li>Made <code>denote-get-path-by-id</code> use <code>denote-get-file-extension-sans-encryption</code>
instead of <code>denote-get-file-extension</code>. This fixes a bug where the
extension is duplicated if it has an encryption component. Thanks to
eum3l for the patch in pull request 562: <a href="https://github.com/protesilaos/denote/pull/562">https://github.com/protesilaos/denote/pull/562</a>.
The change is small, meaning that the author does not need to assign
copyright to the Free Software Foundation.</li>

<li>Same as above for <code>denote--rename-file</code>, which was done in pull
request 557: <a href="https://github.com/protesilaos/denote/pull/557">https://github.com/protesilaos/denote/pull/557</a>.</li>
</ul>
</div>
</div>
<div id="outline-container-h:7eaf43a6-7d62-440e-bf7c-8d9536c7d36e" class="outline-3">
<h3 id="h:7eaf43a6-7d62-440e-bf7c-8d9536c7d36e"><span class="section-number-3">2.10.</span> For developers or advanced users</h3>
<div class="outline-text-3" id="text-h:7eaf43a6-7d62-440e-bf7c-8d9536c7d36e">
<p>
The following have been added or modified.
</p>

<dl class="org-dl">
<dt>NEW Function <code>denote-file-has-denoted-filename-p</code></dt><dd>Return non-nil
if <code>FILE</code> respects the file-naming scheme of Denote. This tests the
rules of Denote&rsquo;s file-naming scheme. Sluggification is ignored. It
is done by removing all file name components and validating what
remains. Thanks to Jean-Philippe Gagné Guay for the pull request
515: <a href="https://github.com/protesilaos/denote/pull/515">https://github.com/protesilaos/denote/pull/515</a>.</dd>

<dt>NEW Functions <code>denote-infer-keywords-from-files</code></dt><dd>Return list of
keywords in <code>denote-directory-files</code>. With optional
<code>FILES-MATCHING-REGEXP</code>, only extract keywords from the matching
files. Otherwise, do it for all files. Keep any duplicates. Users
who do not want duplicates should refer to the functions
<code>denote-keywords</code>.</dd>

<dt>MODIFIED Function <code>denote-keywords</code></dt><dd>Returns an appropriate list
of keyword candidates, while accounting for the value of the user
option <code>denote-infer-keywords</code>. It now also accepts the optional
<code>FILES-MATCHING-REGEXP</code> parameter.</dd>

<dt>MODIFIED Function <code>denote-directory-files</code></dt><dd>Returns a list of
absolute file paths in variable <code>denote-directory</code>. It now accepts
the optional <code>EXCLUDE-REGEXP</code> parameter.</dd>

<dt>MODIFIED Function <code>denote-format-file-name</code></dt><dd>Formats a file name.
The way it treats its <code>ID</code> parameter has changed. Please read its
doc string. Thanks to Jean-Philippe Gagné Guay for the pull request
496: <a href="https://github.com/protesilaos/denote/pull/496">https://github.com/protesilaos/denote/pull/496</a>.</dd>

<dt>ALIAS Function <code>denote-retrieve-filename-keywords-as-list</code></dt><dd>This
is a name that is easier to discover than <code>denote-extract-keywords-from-path</code>,
because of the many other functions with the <code>denote-retrieve-*</code> prefix.</dd>

<dt>MODIFIED Function <code>denote-retrieve-filename-identifier</code></dt><dd>Extracts
the identifier from <code>FILE</code> name, if present, else returns nil. To
create a new one from a date, refer to the <code>denote-get-identifier</code>
function. Thanks to Jean-Philippe Gagné Guay for the pull request
476: <a href="https://github.com/protesilaos/denote/pull/476">https://github.com/protesilaos/denote/pull/476</a>.</dd>

<dt>MODIFIED Function <code>denote-get-identifier</code></dt><dd>Converts <code>DATE</code> into a
Denote identifier using <code>denote-id-format</code>. If <code>DATE</code> is nil, it
returns an empty string as the identifier. Also by Jean-Philippe in
pull request 476 mentioned right above.</dd>

<dt>MODIFIED Function <code>denote-date-prompt</code></dt><dd>Prompts for a date,
expecting <code>YYYY-MM-DD</code> or that plus <code>HH:MM</code> (or even <code>HH:MM:SS</code>).
Can also use Org&rsquo;s more advanced date selection utility if the user
option <code>denote-date-prompt-use-org-read-date</code> is non-nil. It now has
the optional parameters <code>INITIAL-DATE</code> and <code>PROMPT-TEXT</code>. Thanks to
Jean-Philippe Gagné Guay for the pull request 576:
<a href="https://github.com/protesilaos/denote/pull/576">https://github.com/protesilaos/denote/pull/576</a>.</dd>

<dt>NEW Function <code>denote-retrieve-groups-xref-query</code></dt><dd>Accesses the
location of xrefs for <code>QUERY</code> and group them per file. Limit the
search to text files.</dd>

<dt>NEW Function <code>denote-retrieve-files-xref-query</code></dt><dd>Returns sorted,
deduplicated file names with matches for <code>QUERY</code> in their contents.
Limits the search to text files.</dd>

<dt>NEW Function <code>denote-retrieve-xref-alist</code></dt><dd>Returns xref alist of
files with the location of matches for <code>QUERY</code>. With optional
<code>FILES-MATCHING-REGEXP</code>, it limits the list of files accordingly
(per <code>denote-directory-files</code>). At all times, it limits the search
to text files.</dd>

<dt>NEW Function <code>denote-prepend-front-matter</code></dt><dd>Prepend front matter
to <code>FILE</code>. The <code>TITLE</code>, <code>KEYWORDS</code>, <code>DATE</code>, <code>ID</code>, <code>SIGNATURE</code>, and
<code>FILE-TYPE</code> are passed from the renaming command and are used to
construct a new front matter block if appropriate.</dd>

<dt>MODIFIED Function <code>denote-rewrite-front-matter</code></dt><dd>Rewrites front
matter of note after <code>denote-rename-file</code> (or related). The <code>FILE</code>,
<code>TITLE</code>, <code>KEYWORDS</code>, <code>SIGNATURE</code>, <code>DATE</code>, <code>IDENTIFIER</code>, and
<code>FILE-TYPE</code> arguments are given by the renaming command and are used
to construct new front matter values if appropriate. If
<code>denote-rename-confirmations</code> contains <code>rewrite-front-matter</code>,
prompt to confirm the rewriting of the front matter. Otherwise
produce a <code>y-or-n-p</code> prompt to that effect. Thanks to
Jean-Philippe Gagné Guay for the pull request 558:
<a href="https://github.com/protesilaos/denote/pull/558">https://github.com/protesilaos/denote/pull/558</a>.</dd>
</dl>
</div>
</div>
<div id="outline-container-h:40e030cd-f462-44ce-add9-ab1525359ae6" class="outline-3">
<h3 id="h:40e030cd-f462-44ce-add9-ab1525359ae6"><span class="section-number-3">2.11.</span> Denote &ldquo;extensions&rdquo; that are not in the <code>denote</code> package anymore</h3>
<div class="outline-text-3" id="text-h:40e030cd-f462-44ce-add9-ab1525359ae6">
</div>
<div id="outline-container-h:f8ab710d-852f-4d8b-b0f8-9a24c5c83808" class="outline-4">
<h4 id="h:f8ab710d-852f-4d8b-b0f8-9a24c5c83808"><span class="section-number-4">2.11.1.</span> <code>denote-journal</code> integrates nicely with <code>M-x calendar</code></h4>
<div class="outline-text-4" id="text-h:f8ab710d-852f-4d8b-b0f8-9a24c5c83808">
<p>
The <code>calendar</code> can now highlight days that have journal entry. It may
also be used as a date picker to view or write a journal entry for
that day.
</p>

<ul class="org-ul">
<li>Thanks to Alan Schmitt for reporting an issue with the calendar
integration during development:
<a href="https://github.com/protesilaos/denote-journal/issues/8">https://github.com/protesilaos/denote-journal/issues/8</a>.</li>

<li>Thanks to Vineet C. Kulkarni for tweaking the identification of the
journal keyword to be more robust:
<a href="https://github.com/protesilaos/denote-journal/pull/4">https://github.com/protesilaos/denote-journal/pull/4</a>.</li>

<li>Thanks to Honza Pokorny for fixing two small issues with the path
expansion:

<ul class="org-ul">
<li><a href="https://github.com/protesilaos/denote-journal/pull/5">https://github.com/protesilaos/denote-journal/pull/5</a></li>
<li><a href="https://github.com/protesilaos/denote-journal/pull/7">https://github.com/protesilaos/denote-journal/pull/7</a></li>
</ul></li>
</ul>

<p>
Other than that, the package is providing the same functionality as
the discontinued <code>denote-journal-extras.el</code>.
</p>

<ul class="org-ul">
<li>Manual: <a href="https://protesilaos.com/emacs/denote-journal">https://protesilaos.com/emacs/denote-journal</a>.</li>
<li>GitHub: <a href="https://github.com/protesilaos/denote-journal">https://github.com/protesilaos/denote-journal</a>.</li>
</ul>
</div>
</div>
<div id="outline-container-h:db491fe0-0c96-4c2e-9320-dc2697106e12" class="outline-4">
<h4 id="h:db491fe0-0c96-4c2e-9320-dc2697106e12"><span class="section-number-4">2.11.2.</span> <code>denote-org</code> is almost the same as the discontinued <code>denote-org-extras.el</code></h4>
<div class="outline-text-4" id="text-h:db491fe0-0c96-4c2e-9320-dc2697106e12">
<p>
The only addition to dynamic blocks the optional <code>:not-regexp</code> parameter.
This is a regular expression that can further filter the results of a
search, such that the matching items are removed from the output.
</p>

<p>
The official manual of <code>denote-org</code> covers the technicalities.
</p>

<ul class="org-ul">
<li>Manual: <a href="https://protesilaos.com/emacs/denote-org">https://protesilaos.com/emacs/denote-org</a>.</li>
<li>GitHub: <a href="https://github.com/protesilaos/denote-org">https://github.com/protesilaos/denote-org</a>.</li>
</ul>

<p>
Also thanks to Elias Storms for fixing a small issue with the &ldquo;missing
links&rdquo; Org dynamic block, in pull request 486: <a href="https://github.com/protesilaos/denote/pull/486">https://github.com/protesilaos/denote/pull/486</a>
</p>
</div>
</div>
<div id="outline-container-h:ed7c77f5-9b44-4e76-9ada-80ff0ed6d5f6" class="outline-4">
<h4 id="h:ed7c77f5-9b44-4e76-9ada-80ff0ed6d5f6"><span class="section-number-4">2.11.3.</span> <code>denote-silo</code> is the same as the discontinued <code>denote-silo-extras.el</code></h4>
<div class="outline-text-4" id="text-h:ed7c77f5-9b44-4e76-9ada-80ff0ed6d5f6">
<p>
I have only made small tweaks to it, but nothing that changes the user
experience.
</p>

<ul class="org-ul">
<li>Manual: <a href="https://protesilaos.com/emacs/denote-silo">https://protesilaos.com/emacs/denote-silo</a></li>
<li>GitHub: <a href="https://github.com/protesilaos/denote-silo">https://github.com/protesilaos/denote-silo</a></li>
</ul>
</div>
</div>
<div id="outline-container-h:e01d236c-fb50-488f-9fb2-15e866fa122a" class="outline-4">
<h4 id="h:e01d236c-fb50-488f-9fb2-15e866fa122a"><span class="section-number-4">2.11.4.</span> <code>denote-markdown</code> for some Markdown-specific extras</h4>
<div class="outline-text-4" id="text-h:e01d236c-fb50-488f-9fb2-15e866fa122a">
<p>
This package provides some convenience functions to better integrate
Markdown with Denote. This is mostly about converting links from one
type to another so that they can work in different applications
(because Markdown does not have a standardised way to define custom
link types). It also defines an &ldquo;Obsidian&rdquo; file type which does not
have any front matter but only uses a level 1 heading for the title of
the note.
</p>

<p>
The code of <code>denote-markdown</code> used to be bundled up with the <code>denote</code>
package before version <code>4.0.0</code> of the latter and was available in the
file <code>denote-md-extras.el</code>. Users of the old code will need to adapt
their setup to use the <code>denote-markdown</code> package. This can be done by
replacing all instances of <code>denote-md-extras</code> with <code>denote-markdown</code>
across their configuration.
</p>

<ul class="org-ul">
<li>Manual: <a href="https://protesilaos.com/emacs/denote-markdown">https://protesilaos.com/emacs/denote-markdown</a></li>
<li>GitHub: <a href="https://github.com/protesilaos/denote-markdown">https://github.com/protesilaos/denote-markdown</a></li>
</ul>
</div>
</div>
<div id="outline-container-h:6181df9e-790f-4fcf-8093-cefbba324cb5" class="outline-4">
<h4 id="h:6181df9e-790f-4fcf-8093-cefbba324cb5"><span class="section-number-4">2.11.5.</span> Write sequence notes (or &ldquo;folgezettel&rdquo;) with <code>denote-sequence</code></h4>
<div class="outline-text-4" id="text-h:6181df9e-790f-4fcf-8093-cefbba324cb5">
<p>
Users who want their notes to have an inherent structure can use
<code>denote-sequence</code>. The idea is to have thoughts that naturally form
sequences and are named accordingly. The sequence scheme is either
numeric or alphanumeric. The manual of the package explains all the
details.
</p>

<ul class="org-ul">
<li>Manual: <a href="https://protesilaos.com/emacs/denote-sequence">https://protesilaos.com/emacs/denote-sequence</a></li>
<li>GitHub: <a href="https://github.com/protesilaos/denote-sequence">https://github.com/protesilaos/denote-sequence</a></li>
</ul>

<p>
I had a lot of fun developing this comprehensive package during the
winter holidays.
</p>

<p>
Thanks to Claudio Migliorelli, Kierin Bell, Mirko Hernandez for
helping me fix some issues during development:
</p>

<ul class="org-ul">
<li><a href="https://github.com/protesilaos/denote/pull/518">https://github.com/protesilaos/denote/pull/518</a>.</li>
<li><a href="https://github.com/protesilaos/denote/pull/528">https://github.com/protesilaos/denote/pull/528</a>.</li>
<li><a href="https://github.com/protesilaos/denote/pull/540">https://github.com/protesilaos/denote/pull/540</a>.</li>
<li><a href="https://github.com/protesilaos/denote/pull/541">https://github.com/protesilaos/denote/pull/541</a>.</li>
<li><a href="https://github.com/protesilaos/denote-sequence/issues/2">https://github.com/protesilaos/denote-sequence/issues/2</a>.</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-h:90a9287d-a7dd-4d65-9214-4be6ebdf5943" class="outline-3">
<h3 id="h:90a9287d-a7dd-4d65-9214-4be6ebdf5943"><span class="section-number-3">2.12.</span> The <code>consult-denote</code> also gets a small update</h3>
<div class="outline-text-3" id="text-h:90a9287d-a7dd-4d65-9214-4be6ebdf5943">
<p>
This has always been a standalone package. I made the function
<code>consult-denote-file-prompt</code> read the special-purpose variable
<code>denote-file-prompt-use-files-matching-regexp</code>. This is related to
commit <code>e0f1d47</code> in denote.git, about issue 536 as reported by Alan
Schmitt: <a href="https://github.com/protesilaos/denote/issues/536">https://github.com/protesilaos/denote/issues/536</a>. The
variable <code>denote-file-prompt-use-files-matching-regexp</code> is meant to be
<code>let</code> bound and is for advanced users or developers.
</p>
</div>
</div>
<div id="outline-container-h:8624e698-90cd-429e-a072-b0fa2df76662" class="outline-3">
<h3 id="h:8624e698-90cd-429e-a072-b0fa2df76662"><span class="section-number-3">2.13.</span> Feature freeze at least until the end of April 2025</h3>
<div class="outline-text-3" id="text-h:8624e698-90cd-429e-a072-b0fa2df76662">
<p>
I will not develop new features or accept pull request for a couple of
weeks. The idea is to focus on fixing any bug reports. We can then
publish point releases quickly.
</p>

<p>
New features can be included after we are confident that the packages
we have are okay.
</p>
</div>
</div>
<div id="outline-container-h:5191b423-6dc5-4ca7-9bcc-39797be5707c" class="outline-3">
<h3 id="h:5191b423-6dc5-4ca7-9bcc-39797be5707c"><span class="section-number-3">2.14.</span> Git commits</h3>
<div class="outline-text-3" id="text-h:5191b423-6dc5-4ca7-9bcc-39797be5707c">
<p>
This is just an overview of the Git commits, though remember that
there is more that goes into a project, such as the reporting of
inconsistencies, discussion of new ideas, et cetera. Thanks to
everybody involved! Plus, some commits are large while others are
tiny.
</p>

<div class="org-src-container">
<pre class="src src-nil">~/Git/Projects/denote $ git shortlog 3.1.0..4.0.0  --summary --numbered
   470	Protesilaos Stavrou
    90	Jean-Philippe Gagné Guay
     6	Kierin Bell
     4	Alan Schmitt
     3	eum3l
     2	Claudio Migliorelli
     2	Lucas Quintana
     2	grtcdr
     1	Elias Storms
     1	Laurent Gatto
     1	Maikol Solís
     1	Octavian
     1	TomoeMami
</pre>
</div>

<p>
The following are not accurate because they only reflect the changes
after the reorganisation I made. But we have to start from somewhere.
</p>

<div class="org-src-container">
<pre class="src src-nil">~/Git/Projects/denote-journal $ git shortlog  --summary --numbered
    54	Protesilaos Stavrou
     2	Honza Pokorny
     1	Vineet C. Kulkarni
</pre>
</div>

<div class="org-src-container">
<pre class="src src-nil">~/Git/Projects/denote-sequence $ git shortlog  --summary --numbered
    22	Protesilaos Stavrou
</pre>
</div>

<div class="org-src-container">
<pre class="src src-nil">~/Git/Projects/denote-silo $ git shortlog  --summary --numbered
    17	Protesilaos Stavrou
</pre>
</div>

<div class="org-src-container">
<pre class="src src-nil">~/Git/Projects/denote-org $ git shortlog  --summary --numbered
    15	Protesilaos Stavrou
</pre>
</div>

<div class="org-src-container">
<pre class="src src-nil">~/Git/Projects/denote-markdown $ git shortlog  --summary --numbered
    11	Protesilaos Stavrou
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:f089ab11-4ad7-4fd9-9bf3-2deb2e070297" class="outline-2">
<h2 id="h:f089ab11-4ad7-4fd9-9bf3-2deb2e070297"><span class="section-number-2">3.</span> Version 3.1.0 on 2024-09-04</h2>
<div class="outline-text-2" id="text-h:f089ab11-4ad7-4fd9-9bf3-2deb2e070297">
<p>
Denote is stable and reliable though we keep adding minor refinements
to it. Remember that many&#x2014;if not all&#x2014;of these are intended for
experienced users who have developed their own workflow and want to
adapt Denote to its particularities. We may call them &ldquo;power users&rdquo;.
</p>

<p>
New users do not need to know about every single feature. A basic
configuration is enough and is why the original video I did about
Denote (from even before I published version <code>0.1.0</code>) is still relevant.
For example:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">;; Start with something like this.
(use-package denote
  :ensure t
  :bind
  (("C-c n n" . denote)
   ("C-c n r" . denote-rename-file)
   ("C-c n i" . denote-link) ; "insert" mnemonic
   ("C-c n b" . denote-backlinks))
  :config
  (setq denote-directory (expand-file-name "~/Documents/notes/")))
</pre>
</div>

<p>
And here is the same idea with a little bit more convenience:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">;; Another basic setup with a little more to it.
(use-package denote
  :ensure t
  :hook (dired-mode . denote-dired-mode)
  :bind
  (("C-c n n" . denote)
   ("C-c n r" . denote-rename-file)
   ("C-c n l" . denote-link)
   ("C-c n b" . denote-backlinks))
  :config
  (setq denote-directory (expand-file-name "~/Documents/notes/"))

  ;; Automatically rename Denote buffers when opening them so that
  ;; instead of their long file name they have a literal "[D]"
  ;; followed by the file's title.  Read the doc string of
  ;; `denote-rename-buffer-format' for how to modify this.
  (denote-rename-buffer-mode 1))
</pre>
</div>
</div>
<div id="outline-container-h:717765ae-f76f-4b41-96c0-895fe131a83d" class="outline-3">
<h3 id="h:717765ae-f76f-4b41-96c0-895fe131a83d"><span class="section-number-3">3.1.</span> The <code>denote-sort-dired</code> command is more configurable</h3>
<div class="outline-text-3" id="text-h:717765ae-f76f-4b41-96c0-895fe131a83d">
<p>
The <code>denote-sort-dired</code> command asks for a literal string or regular
expression and then produces a fully fledged Dired listing of matching
files in the <code>denote-directory</code>. Combined with the efficient Denote
file-naming scheme, this is a killer feature to collect your relevant
files in a consolidated view and have the full power of Dired available.
</p>

<p>
By default <code>denote-sort-dired</code> prompts for the file name component to
sort by and then asks whether to reverse the sorting or not. Users who
want a more streamlined experience can configure the user option
<code>denote-sort-dired-extra-prompts</code>.
</p>

<p>
It is possible to skip the prompts altogether and use the default
values for (i) which component to sort by and (ii) whether to reverse
the sort. To this end, users can have something like this in their
configuration:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">;; Do not issue any extra prompts.  Always sort by the `title' file
;; name component and never do a reverse sort.
(setq denote-sort-dired-extra-prompts nil)
(setq denote-sort-dired-default-sort-component 'title)
(setq denote-sort-dired-default-reverse-sort nil)
</pre>
</div>

<p>
For me, Dired is one of the best things about Emacs and I like how it
combines so nicely with Denote file names (this is the cornerstone of
Denote, after all).
</p>
</div>
</div>
<div id="outline-container-h:7c4824c0-7f9b-46f5-98ea-4ebbab092193" class="outline-3">
<h3 id="h:7c4824c0-7f9b-46f5-98ea-4ebbab092193"><span class="section-number-3">3.2.</span> The <code>denote-sort-dired</code> sorting functions are customisable</h3>
<div class="outline-text-3" id="text-h:7c4824c0-7f9b-46f5-98ea-4ebbab092193">
<p>
Power users may want to control how the sorting works and what it is
matching on a per file-name-component basis. The user options are
these:
</p>

<ul class="org-ul">
<li><code>denote-sort-title-comparison-function</code>.</li>
<li><code>denote-sort-keywords-comparison-function</code>.</li>
<li><code>denote-sort-signature-comparison-function</code>.</li>
</ul>

<p>
One use-case is to match specific patterns inside of file names, such
as Luhmann-style signatures. I wrote about this in the manual as well
as on my blog (with screenshots):
<a href="https://protesilaos.com/codelog/2024-08-01-emacs-denote-luhmann-signature-sort/">https://protesilaos.com/codelog/2024-08-01-emacs-denote-luhmann-signature-sort/</a>.
</p>

<p>
Thanks to Riccardo Giannitrapani for discussing this with me and
helping me understand the use-case better. This was done via a private
channel and I am sharing it with permission.
</p>
</div>
</div>
<div id="outline-container-h:ad222eb0-06db-4416-820c-c60f31169f66" class="outline-3">
<h3 id="h:ad222eb0-06db-4416-820c-c60f31169f66"><span class="section-number-3">3.3.</span> Show the date of each linked file in Org dynamic blocks</h3>
<div class="outline-text-3" id="text-h:ad222eb0-06db-4416-820c-c60f31169f66">
<p>
All our Org dynamic blocks that produce links to files now read the
parameter <code>:include-date</code>. When it is set to <code>t</code>, the listed files
will include their corresponding date inside of parentheses after the
file&rsquo;s title.
</p>

<p>
Thanks to Sergio Rey for describing this idea to me. This was done via
a private channel and the information is shared with permission.
</p>
</div>
</div>
<div id="outline-container-h:5c0b76fc-2758-4a33-875a-fa9eee705d83" class="outline-3">
<h3 id="h:5c0b76fc-2758-4a33-875a-fa9eee705d83"><span class="section-number-3">3.4.</span> Exclude specific directories from Org dynamic blocks</h3>
<div class="outline-text-3" id="text-h:5c0b76fc-2758-4a33-875a-fa9eee705d83">
<p>
The optional Org dynamic blocks we define let users collect links to
other files (and more) in a quick and effective way. Each block
accepts parameters which control its output, such as how to sort
files.
</p>

<p>
All our dynamic blocks now accept the <code>:excluded-dirs-regexp</code>. This is
a regular expression which is matched against directory file system
paths. Matching directories and their files are not included in the
data handled by the dynamic block.
</p>

<p>
Note that we have the user option <code>denote-excluded-punctuation-regexp</code>
which defines a global preference along the same lines.
</p>

<p>
I did a video about this feature:
<a href="https://protesilaos.com/codelog/2024-07-30-emacs-denote-exclude-dirs-org-blocks/">https://protesilaos.com/codelog/2024-07-30-emacs-denote-exclude-dirs-org-blocks/</a>.
</p>

<p>
Thanks to Claudio Migliorelli for discussing this idea with me. It was
done via a private channel and this information is shared with permission.
</p>
</div>
</div>
<div id="outline-container-h:0cae3fdb-ba83-46f0-9006-13d0073ae092" class="outline-3">
<h3 id="h:0cae3fdb-ba83-46f0-9006-13d0073ae092"><span class="section-number-3">3.5.</span> New dynamic block to insert files as headings</h3>
<div class="outline-text-3" id="text-h:0cae3fdb-ba83-46f0-9006-13d0073ae092">
<p>
We already had an Org dynamic block that would insert file contents.
Though that one inserts files as they are, optionally without their
front matter. However, users may have a workflow where they want to
eventually copy some of the block&rsquo;s output into the main file they are
editing, at which point it is easier for the entire inserted file to
appear as a series of headings. The <code>#+title</code> of the inserted file
becomes a top-level heading and every other heading is pushed deeper
one level.
</p>

<p>
To this end, we provide the Org dynamic block known as <code>denote-files-as-headings</code>.
Insert it with the command <code>denote-org-extras-dblock-insert-files-as-headings</code>
or select it with the minibuffer after calling Org&rsquo;s own command
<code>org-dynamic-block-insert-dblock</code>.
</p>

<p>
The top-level headings (those that were the <code>#+title</code>) can optionally
link back to the original file. Though please read the manual for all
the parameters this dynamic block takes.
</p>
</div>
</div>
<div id="outline-container-h:6e6deff6-c02d-4157-85c0-fc405f64ad34" class="outline-3">
<h3 id="h:6e6deff6-c02d-4157-85c0-fc405f64ad34"><span class="section-number-3">3.6.</span> The dynamic block for backlinks can be about the current heading only</h3>
<div class="outline-text-3" id="text-h:6e6deff6-c02d-4157-85c0-fc405f64ad34">
<p>
The Org dynamic block for backlinks can now read the optional
<code>:this-heading-only</code> parameter. When it is set to <code>t</code>, the block will
only include links that point to the specific heading inside of the
current file. Otherwise, backlinks are about the whole file.
</p>

<p>
To insert such a dynamic block, use the command
<code>denote-org-extras-dblock-insert-backlinks</code>.
</p>
</div>
</div>
<div id="outline-container-h:01b4dfb0-3883-4cc8-ac41-8a7b55e42fe8" class="outline-3">
<h3 id="h:01b4dfb0-3883-4cc8-ac41-8a7b55e42fe8"><span class="section-number-3">3.7.</span> Toggle the detailed view in backlinks buffers</h3>
<div class="outline-text-3" id="text-h:01b4dfb0-3883-4cc8-ac41-8a7b55e42fe8">
<p>
By default, the buffer produced by the command <code>denote-backlinks</code> has
a compact view of showing the file names linking to the current file.
With the user option <code>denote-backlinks-show-context</code> set to a non-nil
value, the backlinks buffer produces a detailed listing of matching
results, where the links are shown in their original context.
</p>

<p>
Users can now choose to have this on-demand by calling the command
<code>denote-backlinks-toggle-context</code> which switches between the detailed
and compact views.
</p>

<p>
This blog post I wrote about it include screenshots:
<a href="https://protesilaos.com/codelog/2024-07-25-emacs-denote-backlinks-context-toggle/">https://protesilaos.com/codelog/2024-07-25-emacs-denote-backlinks-context-toggle/</a>.
</p>
</div>
</div>
<div id="outline-container-h:8d0ac1eb-d057-4fce-bf60-98d5de932a0d" class="outline-3">
<h3 id="h:8d0ac1eb-d057-4fce-bf60-98d5de932a0d"><span class="section-number-3">3.8.</span> Templates can have a function that returns a string</h3>
<div class="outline-text-3" id="text-h:8d0ac1eb-d057-4fce-bf60-98d5de932a0d">
<p>
The <code>denote-templates</code> variable allows the user to specify one or more
named templates which can then be inserted during the creation of a
new note. One way to be prompted for a template among those specified
is to modify the <code>denote-prompts</code> user option and then use the regular
<code>denote</code> command. Another way is to use the command <code>denote-template</code>
(alias <code>denote-create-note-with-template</code>), which will prompt for the
template to use.
</p>

<p>
Templates ordinarily have a string as their value, though now their
value can also be the symbol of a function. This function takes no
arguments and is expected to return a string. Denote takes care to
insert that below the front matter of the new note.
</p>

<p>
So it can look like this:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(setq denote-templates
      `((report . "* Some heading\n\n* Another heading") ; A string with newline characters
        (blog . my-denote-template-function-for-blog) ; the symbol of a function that will return a string
        (memo . ,(concat "* Some heading" ; expand this `concat' into a string
                         "\n\n"
                         "* Another heading"
                         "\n\n"))))
</pre>
</div>

<p>
Thanks to skissue (Ad) for the contribution in pull request 398:
<a href="https://github.com/protesilaos/denote/pull/398">https://github.com/protesilaos/denote/pull/398</a>. The change is small,
meaning that its author does not need to assign copyright to the Free
Software Foundation.
</p>

<p>
Also thanks to Jean-Philippe Gagné Guay for extending this to
<code>denote-org-capture</code>. Done in pull request 399:
<a href="https://github.com/protesilaos/denote/pull/399">https://github.com/protesilaos/denote/pull/399</a>. Jean-Philippe is a
long-time contributor who has assigned copyright to the Free Software
Foundation.
</p>
</div>
</div>
<div id="outline-container-h:b163982b-3fea-48c8-90a0-d8358e066951" class="outline-3">
<h3 id="h:b163982b-3fea-48c8-90a0-d8358e066951"><span class="section-number-3">3.9.</span> The <code>denote-rename-buffer-mode</code> can now show if a file has backlinks</h3>
<div class="outline-text-3" id="text-h:b163982b-3fea-48c8-90a0-d8358e066951">
<p>
This global minor mode takes care to rename the buffers of Denote
files to a pattern that is easier for users to read. As with
everything, it is highly configurable. The default value now includes
an indicator that shows if the current file has backlinks (other files
linking to it).
</p>

<p>
The exact characters used in this indicator are specified in the new
user option <code>denote-rename-buffer-backlinks-indicator</code>. The default
value is <code>"&lt;--&gt;"</code>, which hopefully communicates the idea of a link
(but, yeah, symbolism is hard). Users may want to modify this to add
some fancier Unicode character.
</p>

<p>
Thanks to Ashton Wiersdorf for the original contribution in pull
request 392: <a href="https://github.com/protesilaos/denote/pull/392">https://github.com/protesilaos/denote/pull/392</a>. Ashton
has assigned copyright to the Free Software Foundation.
</p>
</div>
</div>
<div id="outline-container-h:8913785e-5c87-48ab-9df2-dafbbb9b1a5d" class="outline-3">
<h3 id="h:8913785e-5c87-48ab-9df2-dafbbb9b1a5d"><span class="section-number-3">3.10.</span> The <code>denote-rename-buffer-format</code> has changed</h3>
<div class="outline-text-3" id="text-h:8913785e-5c87-48ab-9df2-dafbbb9b1a5d">
<p>
In the same theme as above, the user option <code>denote-rename-buffer-format</code>
has a new default value. Before, it would only show the title of the
file. Now it shows the aforementioned <code>denote-rename-buffer-backlinks-indicator</code>,
if there are backlinks, plus the title, plus a literal <code>"[D]"</code> prefix.
The prefix should make it easier to spot Denote files in a buffer
listing.
</p>

<p>
Read the documentation of <code>denote-rename-buffer-format</code> for how to
tweak this to your liking.
</p>
</div>
</div>
<div id="outline-container-h:14177204-6269-48c1-bc65-de72b59d4e84" class="outline-3">
<h3 id="h:14177204-6269-48c1-bc65-de72b59d4e84"><span class="section-number-3">3.11.</span> New user option <code>denote-kill-buffers</code></h3>
<div class="outline-text-3" id="text-h:14177204-6269-48c1-bc65-de72b59d4e84">
<p>
This controls whether and when Denote should automatically kill any
buffer it generates while creating a new note or renaming an existing
file. The manual describes the details.
</p>

<p>
By default, Denote does not kill any buffers to give users the chance
to review what is on display and confirm any changes or revert them
accordingly.
</p>

<p>
Thanks to Jean-Philippe Gagné Guay for the contribution in pull
request 426: <a href="https://github.com/protesilaos/denote/pull/426">https://github.com/protesilaos/denote/pull/426</a>. This is
related to issues 273 and 413, so also thanks to Vineet C. Kulkarni
and mentalisttraceur for their participation and/or questions.
</p>
</div>
</div>
<div id="outline-container-h:0b570a97-3e0c-488f-9c9d-02d2f8ac786f" class="outline-3">
<h3 id="h:0b570a97-3e0c-488f-9c9d-02d2f8ac786f"><span class="section-number-3">3.12.</span> The <code>denote-journal-extras-new-or-existing-entry</code> handles any filename component order</h3>
<div class="outline-text-3" id="text-h:0b570a97-3e0c-488f-9c9d-02d2f8ac786f">
<p>
Version <code>3.0.0</code> of Denote introduced a new option to rearrange the
file name components. All Denote commands should respect it. We did,
however, have a problem with the command <code>denote-journal-extras-new-or-existing-entry</code> 
which was not recognising the date properly.
</p>

<p>
Thanks to Jakub Szczerbowski for the contribution in pull request 395:
<a href="https://github.com/protesilaos/denote/pull/395">https://github.com/protesilaos/denote/pull/395</a>. The change is small,
meaning that Jakub does not need to assign copyright to the Free
Software Foundation.
</p>

<p>
While I am documenting this here, users should already have the fix as
I published a minor release for it in July (in fact, there were 8
minor releases in the aftermath of the <code>3.0.0</code> release, which
addressed several small issues).
</p>
</div>
</div>
<div id="outline-container-h:01f652c5-5713-4884-8a01-ee39f1388a12" class="outline-3">
<h3 id="h:01f652c5-5713-4884-8a01-ee39f1388a12"><span class="section-number-3">3.13.</span> The <code>denote-rename-file-using-front-matter</code> recognises the file-at-point in Dired</h3>
<div class="outline-text-3" id="text-h:01f652c5-5713-4884-8a01-ee39f1388a12">
<p>
This makes it consistent with how <code>denote-rename-file</code> works. I am
implemented this in response to issue 401 where Alp Eren Kose assumed
it was the default behaviour: <a href="https://github.com/protesilaos/denote/issues/401">https://github.com/protesilaos/denote/issues/401</a>.
</p>

<p>
I think it makes sense to have it this way to avoid such confusion.
Still, it seems easier to edit the file and call <code>denote-rename-file-using-front-matter</code>
directly, rather do an intermediate step through Dired.
</p>
</div>
</div>
<div id="outline-container-h:337c5640-8e75-408e-b5cf-4a37ac8e249b" class="outline-3">
<h3 id="h:337c5640-8e75-408e-b5cf-4a37ac8e249b"><span class="section-number-3">3.14.</span> The <code>denote-rename-file-using-front-matter</code> does not ask to rewrite front matter</h3>
<div class="outline-text-3" id="text-h:337c5640-8e75-408e-b5cf-4a37ac8e249b">
<p>
The workflow for this command is that the user modifies the front
matter, invokes the command, and Denote takes care to rename the file
accordingly. We had a regression were this would happen as expected,
but Denote would still prompt if it was okay to update the front
matter. That made no sense.
</p>

<p>
As with the change mentioned above, this was also fixed in a minor
release so that users would not have to wait all this time.
</p>
</div>
</div>
<div id="outline-container-h:9c343ddb-a31a-41d5-90c2-ce54622558fa" class="outline-3">
<h3 id="h:9c343ddb-a31a-41d5-90c2-ce54622558fa"><span class="section-number-3">3.15.</span> The <code>denote-add-links</code> and <code>denote-find-link</code> commands always works inside a silo</h3>
<div class="outline-text-3" id="text-h:9c343ddb-a31a-41d5-90c2-ce54622558fa">
<p>
This was always the intended behaviour, though there was an issue with
the implementation that prevented the directory-local value from being
read.
</p>

<p>
Thanks to yetanotherfossman for reporting the problem with
<code>denote-add-links</code> in issue 386 and to Kolmas for doing the same for
<code>denote-find-link</code>:
</p>

<ul class="org-ul">
<li><a href="https://github.com/protesilaos/denote/issues/386">https://github.com/protesilaos/denote/issues/386</a>.</li>
<li><a href="https://github.com/protesilaos/denote/issues/416">https://github.com/protesilaos/denote/issues/416</a>.</li>
</ul>

<p>
Also thanks to Jean-Philippe Gagné Guay for following up with a change
to the code that should address the underlying problem with temporary
buffers. This was done in pull request 419:
<a href="https://github.com/protesilaos/denote/pull/419">https://github.com/protesilaos/denote/pull/419</a>.
</p>
</div>
</div>
<div id="outline-container-h:e33bea49-f2b4-43ee-96ac-d24630c9bcd7" class="outline-3">
<h3 id="h:e33bea49-f2b4-43ee-96ac-d24630c9bcd7"><span class="section-number-3">3.16.</span> Denote commands should work in more special Org buffers</h3>
<div class="outline-text-3" id="text-h:e33bea49-f2b4-43ee-96ac-d24630c9bcd7">
<p>
A case we already handled was <code>org-capture</code> buffers. Another one is
the buffer produced by the command <code>org-tree-to-indirect-buffer</code>.
</p>

<p>
Thanks to coherentstate for bringing this matter to my attention in
issue 418: <a href="https://github.com/protesilaos/denote/issues/418">https://github.com/protesilaos/denote/issues/418</a>.
</p>

<p>
Also thanks to skissue for noting another edge case that prevented
<code>denote-rename-buffer-mode</code> from doing the right thing. This was
reported in issue 393: <a href="https://github.com/protesilaos/denote/issues/393">https://github.com/protesilaos/denote/issues/393</a>.
</p>
</div>
</div>
<div id="outline-container-h:c9c04d9a-776d-4b6b-826a-cd9a56f31643" class="outline-3">
<h3 id="h:c9c04d9a-776d-4b6b-826a-cd9a56f31643"><span class="section-number-3">3.17.</span> Denote will not create a <code>CUSTOM_ID</code> via <code>org-capture</code> if not necessary</h3>
<div class="outline-text-3" id="text-h:c9c04d9a-776d-4b6b-826a-cd9a56f31643">
<p>
If the <code>org-capture</code> template does not include one of the specifiers
which produce a link, then we take care to not include a <code>CUSTOM_ID</code>
in the properties of the current heading. We do this to make it
possible to link directly to a heading inside of a file (a feature
that is documented in the manual).
</p>

<p>
Before, we were creating the <code>CUSTOM_ID</code> unconditionally, which was
not the desired behaviour. Thanks to Jonas Großekathöfer for bringing
this matter to my attention in issue 404:
<a href="https://github.com/protesilaos/denote/issues/404">https://github.com/protesilaos/denote/issues/404</a>.
</p>
</div>
</div>
<div id="outline-container-h:cc5951b1-ee87-4126-b3f2-91c32e3431ae" class="outline-3">
<h3 id="h:cc5951b1-ee87-4126-b3f2-91c32e3431ae"><span class="section-number-3">3.18.</span> The prompt for selecting a silo has the appropriate metadata</h3>
<div class="outline-text-3" id="text-h:cc5951b1-ee87-4126-b3f2-91c32e3431ae">
<p>
All the Denote minibuffer prompts have the appropriate completion
metadata to integrate with core Emacs functionalities and with
third-party packages that leverage them. One such case pertains to the
completion category our prompts report. This is used by a package such
as <code>embark</code> to infer the set of relevant actions to perform or by the
<code>marginalia</code> package to produce the appropriate annotations.
</p>

<p>
Users will now notice a difference while using commands such as
<code>denote-silo-extras-create-note</code> if they have <code>marginalia-mode</code>
enabled: all completion candidates will have file-related annotations.
</p>

<p>
This is a small change which goes to show how the little things
contribute to a more refined experience.
</p>
</div>
</div>
<div id="outline-container-h:3e0e2242-8802-4c63-adce-0e20d3f27ad9" class="outline-3">
<h3 id="h:3e0e2242-8802-4c63-adce-0e20d3f27ad9"><span class="section-number-3">3.19.</span> New name for option that controls where backlinks buffers are displayed</h3>
<div class="outline-text-3" id="text-h:3e0e2242-8802-4c63-adce-0e20d3f27ad9">
<p>
The user option is now called <code>denote-backlinks-display-buffer-action</code>.
The old name <code>denote-link-backlinks-display-buffer-action</code> is an alias
for it and will thus work the same way. Though you are encouraged to
rename it in your configuration as I will eventually remove those
obsolete symbols from the Denote code base.
</p>
</div>
</div>
<div id="outline-container-h:2982cfcd-6bef-452d-aa0d-d8ab4e721b25" class="outline-3">
<h3 id="h:2982cfcd-6bef-452d-aa0d-d8ab4e721b25"><span class="section-number-3">3.20.</span> The <code>revert-buffer</code> should do the right thing in backlinks buffers</h3>
<div class="outline-text-3" id="text-h:2982cfcd-6bef-452d-aa0d-d8ab4e721b25">
<p>
I made several tweaks to the underlying code to ensure that reverting
a backlinks buffer will always reuse the original parameters that
generated it. Backlinks buffers are produced by the <code>denote-backlinks</code>
command, among others.
</p>
</div>
</div>
<div id="outline-container-h:991d980b-1353-4b53-8ae4-ae09450cce05" class="outline-3">
<h3 id="h:991d980b-1353-4b53-8ae4-ae09450cce05"><span class="section-number-3">3.21.</span> Lots of new entries in the manual with custom code</h3>
<div class="outline-text-3" id="text-h:991d980b-1353-4b53-8ae4-ae09450cce05">
<p>
The manual of Denote is a rich resource of knowledge for how to use
this package and how to extend it with custom code. I have written the
following entries to further help you improve your productivity:
</p>

<ul class="org-ul">
<li>A custom <code>denote-region</code> that references the source</li>
<li>Custom sluggification to remove non-ASCII characters</li>
<li>Sort signatures that include Luhmann-style sequences</li>
<li>Why are some Org links opening outside Emacs?</li>
</ul>
</div>
</div>
<div id="outline-container-h:2e41930a-1907-47f2-956e-fef8b2459461" class="outline-3">
<h3 id="h:2e41930a-1907-47f2-956e-fef8b2459461"><span class="section-number-3">3.22.</span> More functions for developers or advanced users</h3>
<div class="outline-text-3" id="text-h:2e41930a-1907-47f2-956e-fef8b2459461">
<p>
The following functions are now public, meaning that they are safe to
be used in the code of other packages or incorporated in user
configurations:
</p>

<ul class="org-ul">
<li><code>denote-identifier-p</code>.</li>

<li><code>denote-get-identifier-at-point</code>. I am implementing this in response
to a question by Alan Schmitt in issue 400: <a href="https://github.com/protesilaos/denote/issues/400">https://github.com/protesilaos/denote/issues/400</a>.</li>

<li><code>denote-org-extras-outline-prompt</code>.</li>

<li><code>denote-silo-extras-directory-prompt</code>.</li>
</ul>

<p>
Consult their respective doc strings for the technicalities.
</p>

<p>
Note that the Elisp convention is that private functions (intended for
use only inside the package) have a double dash (<code>--</code>) in their name.
In principle, these are undocumented and can change at any moment
without any notice. I do try to avoid such cases and even add warnings
when I make changes to them. Still, you should not use private
functions without understanding the risks involved.
</p>
</div>
</div>
<div id="outline-container-h:be41d902-8d65-4012-aad2-d66507d34f78" class="outline-3">
<h3 id="h:be41d902-8d65-4012-aad2-d66507d34f78"><span class="section-number-3">3.23.</span> Miscellaneous</h3>
<div class="outline-text-3" id="text-h:be41d902-8d65-4012-aad2-d66507d34f78">
<ul class="org-ul">
<li>Wrote more unit tests for various functions.</li>
<li>Improve the doc strings of several symbols (everything in the Denote
code base is documented).</li>
<li>Fix some typos thanks to Nicolas Semrau and bryanrinders:
<ul class="org-ul">
<li><a href="https://github.com/protesilaos/denote/commit/e7cfd48bd63e0815718cd9f1f0465d8c1c4f4a84">https://github.com/protesilaos/denote/commit/e7cfd48bd63e0815718cd9f1f0465d8c1c4f4a84</a>.</li>
<li><a href="https://github.com/protesilaos/denote/pull/425">https://github.com/protesilaos/denote/pull/425</a>.</li>
</ul></li>
<li>Commented on all sorts of issues on the GitHub repository and many
more in private.</li>
</ul>
</div>
</div>
<div id="outline-container-h:2b55dd84-6ebe-438d-aba8-97dd329ec34e" class="outline-3">
<h3 id="h:2b55dd84-6ebe-438d-aba8-97dd329ec34e"><span class="section-number-3">3.24.</span> New release cycle starts in mid-September</h3>
<div class="outline-text-3" id="text-h:2b55dd84-6ebe-438d-aba8-97dd329ec34e">
<p>
I have many ideas for how to further refine Denote. Maybe you do too.
Though we must all wait a couple of weeks in case someone reports a
bug. This way, it is easy to fix it and publish a new minor version.
Otherwise, we may have to bundle the fix with some in-development
feature that we have not fully tested yet.
</p>
</div>
</div>
<div id="outline-container-h:c0da6de0-c683-4029-9d95-06c27102dc4a" class="outline-3">
<h3 id="h:c0da6de0-c683-4029-9d95-06c27102dc4a"><span class="section-number-3">3.25.</span> Git commits</h3>
<div class="outline-text-3" id="text-h:c0da6de0-c683-4029-9d95-06c27102dc4a">
<p>
This is just an overview of the Git commits, though remember that
there is more that goes into a project, such as the reporting of
inconsistencies, discussion of new ideas, etc.. Thanks to everybody
involved!
</p>

<div class="org-src-container">
<pre class="src src-nil">~/Git/Projects/denote $ git shortlog 3.0.0..3.1.0 --summary --numbered
   104	Protesilaos Stavrou
     7	Jean-Philippe Gagné Guay
     3	Ashton Wiersdorf
     1	Ad
     1	Jakub Szczerbowski
     1	bryanrinders
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:bf5e869d-548f-4c77-bf1c-b7dcf6d1d4da" class="outline-2">
<h2 id="h:bf5e869d-548f-4c77-bf1c-b7dcf6d1d4da"><span class="section-number-2">4.</span> Version 3.0.0 on 2024-06-30</h2>
<div class="outline-text-2" id="text-h:bf5e869d-548f-4c77-bf1c-b7dcf6d1d4da">
<p>
This major release comes about two years after the first version of
Denote, which was published on 2022-06-27. A lot of technicalities
have changed in the meantime, though the core idea remains the same.
In fact, the original video presentation I did is still relevant,
especially for those looking to get started with Denote (but remember
to consult the latest documentation for up-to-date information&#x2014;and
ask me if you have any questions).
</p>

<p>
Version 3 iterates on refinements that we made over the life cycle of
version 2. Existing users will find that their workflow remains the
same, though they now have even more options at their disposal.
</p>

<p>
As usual, my release notes are detailed. Please take your time to read
them: they are here for you.
</p>

<p>
Special thanks to Jean-Philippe Gagné Guay, a long-time contributor to
the project, for working on some of the items covered herein. I am not
covering everything, as many important changes are not user-facing.
Please consult the Git log for further details.
</p>
</div>
<div id="outline-container-h:fa0ffaf5-f762-4667-abe2-350f4ea4aac5" class="outline-3">
<h3 id="h:fa0ffaf5-f762-4667-abe2-350f4ea4aac5"><span class="section-number-3">4.1.</span> File name components can be written in any order</h3>
<div class="outline-text-3" id="text-h:fa0ffaf5-f762-4667-abe2-350f4ea4aac5">
<p>
[ Relevant blog post: <a href="https://protesilaos.com/codelog/2024-05-19-emacs-denote-reorder-file-name-components/">https://protesilaos.com/codelog/2024-05-19-emacs-denote-reorder-file-name-components/</a>.]
</p>

<p>
Users can now change the variable <code>denote-file-name-components-order</code>
to affect how Denote file names are constructed. By default, file
names are written using this scheme (consult the manual for the
details):
</p>

<pre class="example">
IDENTIFIER--TITLE__KEYWORDS.EX
</pre>


<p>
An optional <code>SIGNATURE</code> field can be added, thus:
</p>

<pre class="example">
IDENTIFIER==SIGNATURE--TITLE__KEYWORDS.EXT
</pre>


<p>
By modifying the <code>denote-file-name-components-order</code>, users can
produce file names like these:
</p>

<pre class="example">
--TITLE__KEYWORDS@@IDENTIFIER.EXT
__SIGNATURE--TITLE__KEYWORDS@@IDENTIFIER.EXT
__SIGNATURE--TITLE@@IDENTIFIER__KEYWORDS.EXT
</pre>


<p>
Note that when the <code>DATE</code> is not the first component, it gets the <code>@@</code>
prefix to (i) remain unambiguous and (ii) make it easy to target it
directly for search purposes.
</p>

<p>
Thanks to Jean-Philippe Gagné Guay for the contribution in pull
request 360: <a href="https://github.com/protesilaos/denote/pull/360">https://github.com/protesilaos/denote/pull/360</a>.
</p>

<p>
We discussed the possible delimiters for the <code>IDENTIFIER</code> in issue
332: <a href="https://github.com/protesilaos/denote/issues/332">https://github.com/protesilaos/denote/issues/332</a>. Thanks to
Jean-Philippe, Nick Bell, Maikol Solis, and mentalisttraceur for their
insights. Our concern was to use characters that are stylistically
fine, while they are not special symbol in regular expressions (as
those make searching a bit less convenient).
</p>

<p>
Please remember that the file-naming scheme is the cornerstone of
Denote. If you do change how your notes are named, make sure to be
consistent throughout, otherwise you will likely make it harder for
yourself to find what you need.
</p>
</div>
</div>
<div id="outline-container-h:1c751e58-2f57-4aa8-9990-4ecb73054262" class="outline-3">
<h3 id="h:1c751e58-2f57-4aa8-9990-4ecb73054262"><span class="section-number-3">4.2.</span> Exclude certain files from all prompts</h3>
<div class="outline-text-3" id="text-h:1c751e58-2f57-4aa8-9990-4ecb73054262">
<p>
Sometimes users keep files in their <code>denote-directory</code> that they do
not want to interactive with. These can, for example, be what Org
produces when exporting to another file format or when archiving a
heading.
</p>

<p>
The user option <code>denote-excluded-files-regexp</code> makes is possible to
omit all those files from the relevant Denote prompts.
</p>

<p>
This is in response to requests for such a user option done by Samuel
W. Flint and zadca123 in issues 376 and 384, respectively:
</p>

<ul class="org-ul">
<li><a href="https://github.com/protesilaos/denote/issues/376">https://github.com/protesilaos/denote/issues/376</a></li>
<li><a href="https://github.com/protesilaos/denote/issues/384">https://github.com/protesilaos/denote/issues/384</a></li>
</ul>

<p>
[ Please let me know if you need this feature but do not know how to
  write a regular expression. I can include concrete examples in the
  manual, though I need to know about them first. ]
</p>
</div>
</div>
<div id="outline-container-h:9f9b978f-3c2b-4b27-9ff5-ec0ac24a76d0" class="outline-3">
<h3 id="h:9f9b978f-3c2b-4b27-9ff5-ec0ac24a76d0"><span class="section-number-3">4.3.</span> Links in plain text and Markdown files are buttonised differently</h3>
<div class="outline-text-3" id="text-h:9f9b978f-3c2b-4b27-9ff5-ec0ac24a76d0">
<p>
Before we were using the function <code>denote-link-buttonize-buffer</code>,
which would create &ldquo;buttons&rdquo; for all the <code>denote:</code> links it would.
Users probably had something like this in their configuration:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">;; DEPRECATED method
(add-hook 'text-mode-hook #'denote-link-buttonize-buffer)
</pre>
</div>

<p>
We now provide an approach that is technically better by using Emacs&rsquo;
fontification mechanism. All the user needs is to add this to their
configuration:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'text-mode-hook #'denote-fontify-links-mode-maybe)
</pre>
</div>

<p>
The notion of &ldquo;maybe&rdquo; in the symbol of that function is because this
will take care to be activated only in the right context.
</p>

<p>
Thanks to Abdul-Lateef Haji-Ali for the contribution in pull request
344 (further changes by me): <a href="https://github.com/protesilaos/denote/pull/344">https://github.com/protesilaos/denote/pull/344</a>.
</p>

<p>
Abdul-Lateef has assigned copyright to the Free Software Foundation.
</p>
</div>
</div>
<div id="outline-container-h:dd39bb26-a2c0-47ad-8d54-61f1ba82d3d5" class="outline-3">
<h3 id="h:dd39bb26-a2c0-47ad-8d54-61f1ba82d3d5"><span class="section-number-3">4.4.</span> How to make Org export work in a Denote silo</h3>
<div class="outline-text-3" id="text-h:dd39bb26-a2c0-47ad-8d54-61f1ba82d3d5">
<p>
[ Relevant blog post: <a href="https://protesilaos.com/codelog/2024-06-18-emacs-denote-silos-org-export/">https://protesilaos.com/codelog/2024-06-18-emacs-denote-silos-org-export/</a>. ]
</p>

<p>
This is not a change in Denote per se, though I have added the
relevant details in the manual. Basically, the Org export machinery
dismisses directory-local variables, thus breaking how Denote silos
work. We can work around this by having an extra <code>#+bind</code> directive in
the front matter of each file. The manual, or the aforementioned blog
post, describe the technicalities.
</p>
</div>
</div>
<div id="outline-container-h:2464625e-e041-467c-a4fd-5744e3bb79c3" class="outline-3">
<h3 id="h:2464625e-e041-467c-a4fd-5744e3bb79c3"><span class="section-number-3">4.5.</span> Org headings can have their own backlinks</h3>
<div class="outline-text-3" id="text-h:2464625e-e041-467c-a4fd-5744e3bb79c3">
<p>
[ Relevant blog: <a href="https://protesilaos.com/codelog/2024-04-21-emacs-denote-heading-backlinks/">https://protesilaos.com/codelog/2024-04-21-emacs-denote-heading-backlinks/</a>. ]
</p>

<p>
Denote could already link to an Org heading directly. Now it can also
generate a backlinks buffer for the current heading, using the
command <code>denote-org-extras-backlinks-for-heading</code>.
</p>

<p>
This is part of the optional extension <code>denote-org-extras.el</code> (it is
part of the Denote package, but not loaded by default if you use
something like <code>(require 'denote)</code>).
</p>

<p>
I am providing this as an option for those who absolutely need it,
though in my opinion it is better to have atomic notes, such that each
file contains information that is relevant as a whole. In this
workflow, individual headings can be added or removed, but the big
picture idea of the file remain intact.
</p>

<p>
At any rate, this change is possible due to the requisite refactoring
of the code that handles the backlinks. We can technically produce
backlinks to any pattern in files, though this may be more of interest
to developers rather than foreshadow future features in core Denote.
</p>
</div>
</div>
<div id="outline-container-h:b3dc71a6-fa0b-48d1-b8a7-2842bf725092" class="outline-3">
<h3 id="h:b3dc71a6-fa0b-48d1-b8a7-2842bf725092"><span class="section-number-3">4.6.</span> Finer control over confirmations while renaming</h3>
<div class="outline-text-3" id="text-h:b3dc71a6-fa0b-48d1-b8a7-2842bf725092">
<p>
The <code>denote-rename-no-confirm</code> is deprecated and superseded by the
more flexible user option <code>denote-rename-confirmations</code>.
</p>

<p>
The command <code>denote-rename-file</code> (and others like it) prompts for
confirmation before changing the name of a file and updating its front
matter. The user option <code>denote-rename-confirmations</code> controls what
the user is prompted for, if anything. Please consult its
documentation for the technicalities.
</p>

<p>
Thanks to Jean-Philippe Gagné Guay for the contribution in pull
request 324: <a href="https://github.com/protesilaos/denote/pull/324">https://github.com/protesilaos/denote/pull/324</a>.
</p>
</div>
</div>
<div id="outline-container-h:10883c47-0f5e-4267-a122-86906bf25a61" class="outline-3">
<h3 id="h:10883c47-0f5e-4267-a122-86906bf25a61"><span class="section-number-3">4.7.</span> The user option <code>denote-save-buffer-after-creation</code> is renamed to <code>denote-save-buffers</code></h3>
<div class="outline-text-3" id="text-h:10883c47-0f5e-4267-a122-86906bf25a61">
<p>
Please update your configuration accordingly, if you were using the
old name.
</p>
</div>
</div>
<div id="outline-container-h:042699ec-5516-44ca-93ee-60b32e599029" class="outline-3">
<h3 id="h:042699ec-5516-44ca-93ee-60b32e599029"><span class="section-number-3">4.8.</span> The commands <code>denote-keywords-add</code> and <code>denote-keywords-remove</code> are replaced by <code>denote-rename-file-keywords</code></h3>
<div class="outline-text-3" id="text-h:042699ec-5516-44ca-93ee-60b32e599029">
<p>
The new command can add or remove keywords. It does this by
prepopulating the minibuffer prompt with the existing keywords. Users
can then use the <code>crm-separator</code> (normally a comma), to write new
keywords or edit what is in the prompt to rewrite them accordingly. An
empty input means to remove all keywords.
</p>

<p>
[ NOTE: Please check with your minibuffer user interface how to
  provide an empty input. The Emacs default setup accepts the empty
  minibuffer contents as they are, though popular packages like
  <code>vertico</code> use the first available completion candidate instead. For
  <code>vertico</code>, the user must either move one up to select the prompt and
  then type <code>RET</code> there with empty contents, or use the command
  <code>vertico-exit-input</code> with empty contents. That Vertico command is
  bound to <code>M-RET</code> as of this writing on 2024-06-30 10:37 +0300. ]
</p>

<p>
Technically, <code>denote-rename-file-keywords</code> is a wrapper for
<code>denote-rename-file</code>, doing all the things that does.
</p>
</div>
</div>
<div id="outline-container-h:2c2c0f6f-413b-4492-b6a2-062034692c4c" class="outline-3">
<h3 id="h:2c2c0f6f-413b-4492-b6a2-062034692c4c"><span class="section-number-3">4.9.</span> The commands <code>denote-rename-file-title</code> and <code>denote-rename-file-signature</code></h3>
<div class="outline-text-3" id="text-h:2c2c0f6f-413b-4492-b6a2-062034692c4c">
<p>
These are like the <code>denote-rename-file-keywords</code> we just covered.
There are wrappers of the <code>denote-rename-file</code> command, which are used
to change on the file name component they reference.
</p>

<p>
If that component exists, its text is included in the minibuffer. The
user can then modify it accordingly. If there is no text, the user is
adding a new one. An empty input means to remove the title/signature
from the file altogether (again, check your minibuffer for how to
provide an empty input).
</p>
</div>
</div>
<div id="outline-container-h:01770801-c511-46c0-9a05-890276374b63" class="outline-3">
<h3 id="h:01770801-c511-46c0-9a05-890276374b63"><span class="section-number-3">4.10.</span> More commands to add/remove keywords in bulk from Dired</h3>
<div class="outline-text-3" id="text-h:01770801-c511-46c0-9a05-890276374b63">
<p>
Two new specialised commands are available to help users add or remove
keywords from many files at once. These are:
</p>

<ul class="org-ul">
<li><code>denote-dired-rename-marked-files-add-keywords</code></li>
<li><code>denote-dired-rename-marked-files-remove-keywords</code>.</li>
</ul>

<p>
They complement the <code>denote-dired-rename-marked-files-with-keywords</code>,
which we have had for a long time already, and which rewrites all the
keywords (instead of only adding/removing from the list).
</p>

<p>
All three of those commands operate only on the <code>KEYWORDS</code> component
of the file name, leaving everything else as-is (while respecting the
aforementioned <code>denote-file-name-components-order</code>).
</p>

<p>
Thanks to Vedang Manerikar for the contribution in pull request 316:
<a href="https://github.com/protesilaos/denote/pull/316">https://github.com/protesilaos/denote/pull/316</a>. Vedang has already
assigned copyright to the Free Software Foundation.
</p>
</div>
</div>
<div id="outline-container-h:5f97d3f5-294d-467d-858b-281e46060625" class="outline-3">
<h3 id="h:5f97d3f5-294d-467d-858b-281e46060625"><span class="section-number-3">4.11.</span> The <code>denote-org-extras-convert-links-to-file-type</code> can return relative paths</h3>
<div class="outline-text-3" id="text-h:5f97d3f5-294d-467d-858b-281e46060625">
<p>
The previous implementation would always return an absolute file path,
ignoring the Org user option <code>org-link-file-path-type</code>. Whereas now it
will return a relative path if that user option is set to a value of
either <code>'adaptive</code> or <code>'relative</code>.
</p>

<p>
Thanks to Alexandre Rousseau for the contribution in pull request 325:
<a href="https://github.com/protesilaos/denote/pull/325">https://github.com/protesilaos/denote/pull/325</a>. The change is small,
meaning that Alexandre does not need to assign copyright to the Free
Software Foundation.
</p>
</div>
</div>
<div id="outline-container-h:6911a5d6-6de3-4e04-b9d2-12a6526b4e97" class="outline-3">
<h3 id="h:6911a5d6-6de3-4e04-b9d2-12a6526b4e97"><span class="section-number-3">4.12.</span> For developers or advanced users</h3>
<div class="outline-text-3" id="text-h:6911a5d6-6de3-4e04-b9d2-12a6526b4e97">
</div>
<div id="outline-container-h:28bfa74b-5a38-4f3c-a5fe-bf5a697385db" class="outline-4">
<h4 id="h:28bfa74b-5a38-4f3c-a5fe-bf5a697385db"><span class="section-number-4">4.12.1.</span> The <code>denote-add-prompts</code> is made public</h4>
<div class="outline-text-4" id="text-h:28bfa74b-5a38-4f3c-a5fe-bf5a697385db">
<p>
This is used to <code>let</code> bind any additional prompts that should be used
by the <code>denote</code> command. Check the source code for how we are using
this function.
</p>
</div>
</div>
<div id="outline-container-h:669f8eee-bdab-406a-aada-73ee8de9caf2" class="outline-4">
<h4 id="h:669f8eee-bdab-406a-aada-73ee8de9caf2"><span class="section-number-4">4.12.2.</span> The <code>denote-select-linked-file-prompt</code> is now public</h4>
<div class="outline-text-4" id="text-h:669f8eee-bdab-406a-aada-73ee8de9caf2">
<p>
This is used internally but the commands <code>denote-find-link</code>,
<code>denote-find-backlink</code>. Refer to the implementation of those commands
to get an idea of how to use this prompt.
</p>
</div>
</div>
<div id="outline-container-h:414cfd70-1850-44bf-b0fe-fb3809af302e" class="outline-4">
<h4 id="h:414cfd70-1850-44bf-b0fe-fb3809af302e"><span class="section-number-4">4.12.3.</span> The <code>denote-retrieve-title-or-filename</code> is just a wrapper</h4>
<div class="outline-text-4" id="text-h:414cfd70-1850-44bf-b0fe-fb3809af302e">
<p>
It simply calls the <code>denote-retrieve-front-matter-title-value</code> or
<code>denote-retrieve-filename-title</code>. We do not want it to return the
<code>file-name-base</code>, as it used to, because this will duplicate the text
of the file name when there is no <code>TITLE</code> component, as demonstrated by
duli in issue 347: <a href="https://github.com/protesilaos/denote/issues/347">https://github.com/protesilaos/denote/issues/347</a>.
</p>
</div>
</div>
<div id="outline-container-h:f7fb9e1f-e7b9-4dd1-a517-79069f28dcfe" class="outline-4">
<h4 id="h:f7fb9e1f-e7b9-4dd1-a517-79069f28dcfe"><span class="section-number-4">4.12.4.</span> The <code>denote-file-prompt</code> is more robust</h4>
<div class="outline-text-4" id="text-h:f7fb9e1f-e7b9-4dd1-a517-79069f28dcfe">
<p>
We have made this function show relative file paths for the
convenience of the user, but we take care to internally return and
store the full file path (which is unambiguous). Thanks to Alan
Schmitt for noting that the history was not working properly. This was
done in issue 339: <a href="https://github.com/protesilaos/denote/issues/339">https://github.com/protesilaos/denote/issues/339</a>.
A series of commits dealt with the implementation details, including a
contribution by Jean-Philippe Gagné Guay in pull request 342:
<a href="https://github.com/protesilaos/denote/pull/342">https://github.com/protesilaos/denote/pull/342</a>. Also read 353 for a
further set of tweaks from my side: <a href="https://github.com/protesilaos/denote/discussions/353">https://github.com/protesilaos/denote/discussions/353</a>.
</p>

<p>
As part of these changes, the <code>denote-file-prompt</code> now takes a
<code>NO-REQUIRE-MATCH</code> argument. It also respects the aforementioned user
option of <code>denote-excluded-files-regexp</code>.
</p>
</div>
</div>
<div id="outline-container-h:b056abdf-b9d9-4799-8e24-ae6507b4780e" class="outline-4">
<h4 id="h:b056abdf-b9d9-4799-8e24-ae6507b4780e"><span class="section-number-4">4.12.5.</span> Relevant functions conform with the <code>denote-rename-confirmations</code></h4>
<div class="outline-text-4" id="text-h:b056abdf-b9d9-4799-8e24-ae6507b4780e">
<p>
These include the <code>denote-rename-file-prompt</code> and
<code>denote-rewrite-front-matter</code>, as well as the new
<code>denote-add-front-matter-prompt</code>.
</p>

<p>
This has the meaning of what I mentioned above. Commands that need to
deviate from the user option <code>denote-rename-confirmations</code> can <code>let</code>
bind it accordingly: we even do this for some commands in <code>denote.el</code>,
because certain prompts do not make sense there.
</p>
</div>
</div>
<div id="outline-container-h:0118ad59-5fc2-4a19-8946-324410adb107" class="outline-4">
<h4 id="h:0118ad59-5fc2-4a19-8946-324410adb107"><span class="section-number-4">4.12.6.</span> All file name components can be <code>let</code> bound</h4>
<div class="outline-text-4" id="text-h:0118ad59-5fc2-4a19-8946-324410adb107">
<p>
We define a new series of variables which can be set to a lexically
scoped value to control what the <code>denote</code> function parses. These are:
</p>

<ul class="org-ul">
<li><code>denote-use-date</code></li>
<li><code>denote-use-directory</code></li>
<li><code>denote-use-file-type</code></li>
<li><code>denote-use-keywords</code></li>
<li><code>denote-use-signature</code></li>
<li><code>denote-use-template</code></li>
<li><code>denote-use-title</code></li>
</ul>

<p>
Employ those for custom extensions you may have.
</p>

<p>
Thanks to Jean-Philippe Gagné Guay for adding those in pull request
365: <a href="https://github.com/protesilaos/denote/pull/365">https://github.com/protesilaos/denote/pull/365</a>.
</p>
</div>
</div>
</div>
<div id="outline-container-h:1fc6d700-e8aa-4d05-bbae-5623a9565922" class="outline-3">
<h3 id="h:1fc6d700-e8aa-4d05-bbae-5623a9565922"><span class="section-number-3">4.13.</span> Miscellaneous</h3>
<div class="outline-text-3" id="text-h:1fc6d700-e8aa-4d05-bbae-5623a9565922">
<ul class="org-ul">
<li>All the Org dynamic blocks defined by Denote in the optional
<code>denote-org-extras.el</code> are now autoloaded. This means that
evaluating such a code block will work even if the user has not
explicitly used something like <code>(require 'denote-org-extras)</code>.
Thanks to Julian Hoch for asking for a relevant clarification in
issue 337: <a href="https://github.com/protesilaos/denote/issues/337">https://github.com/protesilaos/denote/issues/337</a>.
Thanks to Kolmas for reporting some missing autoloads in issue 371:
<a href="https://github.com/protesilaos/denote/issues/371">https://github.com/protesilaos/denote/issues/371</a>.</li>

<li>The value of the user option <code>denote-link-backlinks-display-buffer-action</code>
is slightly modified to (i) make the buffer dedicated to its window
and (ii) try to preserve its size during automatic recombinations of
the frame&rsquo;s layout.</li>

<li>There was a regression in version <code>2.3.0</code> relative to <code>2.2.0</code> where
the <code>denote-link</code> command would fail in Org capture buffers. Thanks
to Sven Seebeck for reporting this bug in issue 298:
<a href="https://github.com/protesilaos/denote/issues/298">https://github.com/protesilaos/denote/issues/298</a>.</li>

<li>The <code>denote-filetype-heuristics</code> function no longer chokes if it
gets a nil value (such as in Org capture buffers).</li>

<li>The <code>denote-journal-extras-directory</code> (part of the optional
<code>denote-journal-extras</code> file) falls back to <code>denote-directory</code> if
its value is nil. This is what the user option
<code>denote-journal-extras-directory</code> promises in its doc string.</li>

<li>All prompts should have their scope of application in all capital
letters, such as <code>Select TEMPLATE key</code>. The idea is to make it
easier for the user to quickly spot for the prompt is about.</li>

<li>The user option <code>denote-link-description-function</code> is documented in
the manual. Thanks to Sven Seebeck for noticing that we did not
document this for the <code>2.3.0</code> release. Thanks to Jean-Philippe Gagné
Guay for helping me refine the code. This was all done in issue 298:
<a href="https://github.com/protesilaos/denote/issues/298">https://github.com/protesilaos/denote/issues/298</a>.</li>

<li>As part of internal changes to how our various &ldquo;rename&rdquo; commands
work, Kolmas reported a regression with wrongly assigned file
extensions. This was done in issue 343:
<a href="https://github.com/protesilaos/denote/issues/343">https://github.com/protesilaos/denote/issues/343</a>.</li>

<li>In the <code>denote-org-extras.el</code> we now always jump to the correct Org
heading line, instead of missing it by 1 under certain conditions.
Thanks to kilesduli for bringing this matter to my attention in
issue 354: <a href="https://github.com/protesilaos/denote/issues/354">https://github.com/protesilaos/denote/issues/354</a>.</li>
</ul>
</div>
</div>
<div id="outline-container-h:250e8abe-8e8d-41b9-a9dc-b2951a07d5bd" class="outline-3">
<h3 id="h:250e8abe-8e8d-41b9-a9dc-b2951a07d5bd"><span class="section-number-3">4.14.</span> Policy for the aftermath of this release</h3>
<div class="outline-text-3" id="text-h:250e8abe-8e8d-41b9-a9dc-b2951a07d5bd">
<p>
The next few days or weeks are reserved for bug fixes. We first want
to make sure that the current code base is rock solid, before making
any further changes. Any bugs will be addressed outright and new point
releases will be published (though those are not accompanied by a
change log entry).
</p>
</div>
</div>
<div id="outline-container-h:e9ea8288-99d1-407d-919a-b6024d35a501" class="outline-3">
<h3 id="h:e9ea8288-99d1-407d-919a-b6024d35a501"><span class="section-number-3">4.15.</span> Git commits</h3>
<div class="outline-text-3" id="text-h:e9ea8288-99d1-407d-919a-b6024d35a501">
<p>
Just an overview of what we did. Thanks again to everyone involved.
</p>

<div class="org-src-container">
<pre class="src src-sh">~/Git/Projects/denote $ git shortlog 2.3.0..3.0.0 --summary --numbered
   169  Protesilaos Stavrou
    52  Jean-Philippe Gagné Guay
     3  Al Haji-Ali
     2  Alan Schmitt
     1  Alexandre Rousseau
     1  Jianwei Hou
     1  Vedang Manerikar
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:e9d3ebdb-8a69-47a9-a5a2-619abc44b7d2" class="outline-2">
<h2 id="h:e9d3ebdb-8a69-47a9-a5a2-619abc44b7d2"><span class="section-number-2">5.</span> Version 2.3.0 on 2024-03-24</h2>
<div class="outline-text-2" id="text-h:e9d3ebdb-8a69-47a9-a5a2-619abc44b7d2">
<p>
This release brings a host of user-facing refinements to an already
stable base, as well as some impressive new features. There is a lot
to cover, so take your time reading these notes.
</p>

<p>
Special thanks to Jean-Philippe Gagné Guay for the numerous
refinements to parts of the code base. Some of these are not directly
visible to users, but are critical regardless. In the interest of
brevity, I will not be covering the most technical parts here. I
mention Jean-Philippe&rsquo;s contributions at the outset for this reason.
Though the Git commit log is there for interested parties to study
things further.
</p>
</div>
<div id="outline-container-h:3e49dd9d-59db-40e5-9116-ce678231b08d" class="outline-3">
<h3 id="h:3e49dd9d-59db-40e5-9116-ce678231b08d"><span class="section-number-3">5.1.</span> Check out the <code>denote-explore</code> package by Peter Prevos</h3>
<div class="outline-text-3" id="text-h:3e49dd9d-59db-40e5-9116-ce678231b08d">
<p>
This package provides several neat extensions that help you make
better sense of your knowledge base, while keeping it in good order.
The <code>denote-explore</code> package has commands to summarise the usage of
keywords, visualise connections between notes, spot infrequently used
keywords, and jump to previous historical entries.
</p>

<ul class="org-ul">
<li>Git repository: <a href="https://github.com/pprevos/denote-explore">https://github.com/pprevos/denote-explore</a>.</li>
<li>Documentation: <a href="https://lucidmanager.org/productivity/denote-explore">https://lucidmanager.org/productivity/denote-explore</a>.</li>
</ul>

<p>
Now on to Denote version <code>2.3.0</code>!
</p>
</div>
</div>
<div id="outline-container-h:ca7baf4f-04af-4467-a1e6-20403357280f" class="outline-3">
<h3 id="h:ca7baf4f-04af-4467-a1e6-20403357280f"><span class="section-number-3">5.2.</span> Link to a heading inside a Denote Org file</h3>
<div class="outline-text-3" id="text-h:ca7baf4f-04af-4467-a1e6-20403357280f">
<p>
Denote creates links to files by using their unique identifier. As Org
provides the <code>CUSTOM_ID</code> property for per-heading identifiers, we now
leverage this infrastructure to compose links that point to a file and
then to a heading therein. This only works for Org, as no other plain
text major mode has a concept of heading identifiers (and it is not
Denote&rsquo;s job to create such a feature).
</p>

<p>
I demonstrated the functionality in a video:
<a href="https://protesilaos.com/codelog/2024-01-20-emacs-denote-link-org-headings/">https://protesilaos.com/codelog/2024-01-20-emacs-denote-link-org-headings/</a>
</p>

<p>
Technically, the <code>denote:</code> link type has the same implementation
details as Org&rsquo;s standard <code>file:</code> and has always had this potential to
jump to a section inside the given file.
</p>
</div>
<div id="outline-container-h:a7864660-5b4c-4467-a252-9140baedeb1a" class="outline-4">
<h4 id="h:a7864660-5b4c-4467-a252-9140baedeb1a"><span class="section-number-4">5.2.1.</span> The <code>denote-org-store-link-to-heading</code> user option</h4>
<div class="outline-text-4" id="text-h:a7864660-5b4c-4467-a252-9140baedeb1a">
<p>
The user option <code>denote-org-store-link-to-heading</code> determines whether
<code>org-store-link</code> links to the current Org heading (such links are
merely &ldquo;stored&rdquo; and need to be inserted afterwards with the command
<code>org-insert-link</code>). Note that the <code>org-capture</code> command uses the
<code>org-link</code> internally if it has to store a link.
</p>

<p>
When its value is non-nil, <code>org-store-link</code> stores a link to the
current Org heading inside the Denote Org file. If the heading does
not have a <code>CUSTOM_ID</code>, it creates it and includes it in the heading&rsquo;s
<code>PROPERTIES</code> drawer. If a <code>CUSTOM_ID</code> exists, <code>org-store-link</code> use it
as-is.
</p>

<p>
This makes the resulting link a combination of the <code>denote:</code> link type,
pointing to the identifier of the current file, plus the value of the
heading&rsquo;s <code>CUSTOM_ID</code>, such as:
</p>

<ul class="org-ul">
<li><code>[[denote:20240118T060608][Some test]]</code></li>
<li><code>[[denote:20240118T060608::#h:eed0fb8e-4cc7-478f-acb6-f0aa1a8bffcd][Some test::Heading text]]</code></li>
</ul>

<p>
Both lead to the same Denote file, but the latter jumps to the heading
with the given <code>CUSTOM_ID</code>. Notice that the link to the heading also
has a different description, which includes the heading text.
</p>

<p>
The value of the <code>CUSTOM_ID</code> is determined by the Org user option
<code>org-id-method</code>. The sample shown above uses the default UUID
infrastructure.
</p>

<p>
If <code>denote-org-store-link-to-heading</code> is set to a nil value, the
command <code>org-store-link</code> only stores links to the Denote file (using
its identifier), but not to the given heading. This is what Denote was
doing in all versions prior to <code>2.3.0</code>.
</p>

<p>
Thanks to Kristoffer Balintona for discussing with me how
<code>org-capture</code> interfaces with <code>org-store-link</code>. I updated the
documentation accordingly. This was done in issue 267:
<a href="https://github.com/protesilaos/denote/issues/267">https://github.com/protesilaos/denote/issues/267</a>.
</p>
</div>
</div>
<div id="outline-container-h:dd054536-8d20-4251-b23d-77fec7d7d036" class="outline-4">
<h4 id="h:dd054536-8d20-4251-b23d-77fec7d7d036"><span class="section-number-4">5.2.2.</span> Insert link to an Org file with a further pointer to a heading</h4>
<div class="outline-text-4" id="text-h:dd054536-8d20-4251-b23d-77fec7d7d036">
<p>
As part of the optional <code>denote-org-extras.el</code> extension that comes
with the <code>denote</code> package, the command <code>denote-org-extras-link-to-heading</code>
prompts for a link to an Org file and then asks for a heading therein,
using minibuffer completion. Once the user provides input at the two
prompts, the command inserts a link at point which has the following
pattern: <code>[[denote:IDENTIFIER::#ORG-HEADING-CUSTOM-ID]][Description::Heading text]]</code>.
</p>

<p>
Because only Org files can have links to individual headings, the
command <code>denote-org-extras-link-to-heading</code> prompts only for Org files
(i.e. files which include the <code>.org</code> extension). Remember that Denote
works with many file types.
</p>

<p>
This feature is similar to the concept of the aforementioned user
option <code>denote-org-store-link-to-heading</code>. It is, however, interactive
and differs in the directionality of the action. With that user
option, the command <code>org-store-link</code> will generate a <code>CUSTOM_ID</code> for
the current heading (or capture the value of one as-is), giving the
user the option to then call <code>org-insert-link</code> wherever they see fit.
By contrast, the command <code>denote-org-extras-link-to-heading</code> prompts
for a file, then a heading, and inserts the link at point.
</p>
</div>
</div>
</div>
<div id="outline-container-h:e509402b-a58f-4a10-b364-b158b31d1ee5" class="outline-3">
<h3 id="h:e509402b-a58f-4a10-b364-b158b31d1ee5"><span class="section-number-3">5.3.</span> Refinements galore to minibuffer prompts</h3>
<div class="outline-text-3" id="text-h:e509402b-a58f-4a10-b364-b158b31d1ee5">
</div>
<div id="outline-container-h:11f0fc1e-552b-4a02-bf01-9d8508ce68c8" class="outline-4">
<h4 id="h:11f0fc1e-552b-4a02-bf01-9d8508ce68c8"><span class="section-number-4">5.3.1.</span> All commands that affect file names conform with <code>denote-prompts</code></h4>
<div class="outline-text-4" id="text-h:11f0fc1e-552b-4a02-bf01-9d8508ce68c8">
<p>
The scope of the <code>denote-prompts</code> user option is broadened to make it
more useful. In the past, this variable would only affect the
behaviour of the <code>denote</code> command. For example, the user would make
the command prompt for a subdirectory, then keywords, then a title.
But all other commands were not following this setting, as they were
hardcoding the prompts for title and keywords.
</p>

<p>
Take the <code>denote-subdirectory</code> command as an example. It would first
prompt for a subdirectory to place the new note in, then for a title,
and then for keywords. Whereas now, it prepends the <code>subdirectory</code>
prompt to the list of <code>denote-prompts</code>. So if the user has configured
their <code>denote-prompts</code> to, for example, ask for a signature and a file
type, the <code>denote-subdirectory</code> will do just that with the addition of
the <code>subdirectory</code> prompt.
</p>

<p>
Same idea for all commands that either create or modify file names,
wherever conformity with <code>denote-prompts</code> makes sense. For example,
the <code>denote-rename-file</code> will never ask for a <code>subdirectory</code> because
our renaming policy is to always rename in place (to avoid
mistakes&#x2014;you can always move the file afterwards).
</p>

<p>
This also means that the <code>denote-rename-file</code> and its multi-file
counterpart, <code>denote-dired-rename-files</code>, will only prompt for a
signature if it is part of the <code>denote-prompts</code>. Whereas in the
previous version this was unconditional, thus burdening users who do
not need the <code>SIGNATURE</code> file name component (more about renaming
further into the release notes).
</p>

<p>
Lots of Git commits went into this redesign, per my initiave in issue
247: <a href="https://github.com/protesilaos/denote/issues/247">https://github.com/protesilaos/denote/issues/247</a>. Thanks to
Vedang Manerikar for the changes to the convenience wrappers of the
<code>denote</code> command (like <code>denote-subdirectory</code>), which were done in pull
request 248: <a href="https://github.com/protesilaos/denote/pull/248">https://github.com/protesilaos/denote/pull/248</a>.
</p>

<p>
Vedang has assigned copyright to the Free Software Foundation.
</p>

<p>
Also thanks to Max Brieiev for joining the technical discussion
therein.
</p>

<p>
The renaming commands are more intuitive now, which addresses a
discussion point raised by user babusri in issue 204:
<a href="https://github.com/protesilaos/denote/issues/204">https://github.com/protesilaos/denote/issues/204</a>.
</p>
</div>
</div>
<div id="outline-container-h:a502217d-8eff-4a6f-b66a-33e5e7ecda9d" class="outline-4">
<h4 id="h:a502217d-8eff-4a6f-b66a-33e5e7ecda9d"><span class="section-number-4">5.3.2.</span> A simple tweak for more informative minibuffer prompts</h4>
<div class="outline-text-4" id="text-h:a502217d-8eff-4a6f-b66a-33e5e7ecda9d">
<p>
The text of each prompt now has all capital letters for the word
referencing its scope of its application, like <code>TITLE</code>, <code>KEYWORDS</code>,
<code>SIGNATURE</code>. The idea is to make it easier to quickly scan the text,
especially while working through multiple prompts. For example, the
prompt for a title now reads:
</p>

<pre class="example">
New file TITLE:
</pre>


<p>
This paradigm is followed by all prompts. It is a small yet effective
tweak to get a better sense of context.
</p>
</div>
</div>
<div id="outline-container-h:8f182ad3-c97f-45dc-a451-c552f2a7957c" class="outline-4">
<h4 id="h:8f182ad3-c97f-45dc-a451-c552f2a7957c"><span class="section-number-4">5.3.3.</span> The file prompt uses relative names once again</h4>
<div class="outline-text-4" id="text-h:8f182ad3-c97f-45dc-a451-c552f2a7957c">
<p>
In previous versions of Denote, the minibuffer prompt to pick a file
(such as a file to link to) would show relative file names: the name
without the full file system path. The functionality depended on the
built-in <code>project.el</code> library, which did not allow us to do everything
we wanted with our prompts, such as to have a dedicated minibuffer
history or to easily enable the workflow of commands like
<code>denote-open-or-create</code>.
</p>

<p>
In the previous version, I made the decision to remove the
<code>project.el</code> dependency and the concomitant presentation of relative
names in order to add the functionality we want. I did it with the
intention to find a better solution down the line. Et voilá! Relative
file names are back. We now have all the functionality we need. Sorry
if in the meantime you had to deal with those longer names! It was a
necessary intermediate arrangement for the greater good.
</p>

<p>
For the technicalities, refer to the source code of the function
<code>denote-title-prompt</code>.
</p>
</div>
</div>
<div id="outline-container-h:bcf382e4-bd00-49f3-859a-3f86e9770b77" class="outline-4">
<h4 id="h:bcf382e4-bd00-49f3-859a-3f86e9770b77"><span class="section-number-4">5.3.4.</span> Completion using previous inputs is now optional</h4>
<div class="outline-text-4" id="text-h:bcf382e4-bd00-49f3-859a-3f86e9770b77">
<p>
All our minibuffer prompts have their dedicated history (you can
persist histories with the built-in <code>savehist-mode</code>). They store
previous values, giving the user easy access to their past input
values. Some of our commands not only record a history, but also
leverage it to provide completion. These commands are named in the
variable <code>denote-prompts-with-history-as-completion</code>. As of this
writing, they are:
</p>

<ul class="org-ul">
<li><code>denote-title-prompt</code></li>
<li><code>denote-signature-prompt</code></li>
<li><code>denote-files-matching-regexp-prompt</code></li>
</ul>

<p>
Users who do not want to use completion for those can set the new user
option <code>denote-history-completion-in-prompts</code> to a nil value.
</p>
</div>
</div>
</div>
<div id="outline-container-h:747e126a-b966-4ac8-a8ec-cf900012e37e" class="outline-3">
<h3 id="h:747e126a-b966-4ac8-a8ec-cf900012e37e"><span class="section-number-3">5.4.</span> Renaming files got better all-round</h3>
<div class="outline-text-3" id="text-h:747e126a-b966-4ac8-a8ec-cf900012e37e">
<p>
One of the pillars of the <code>denote</code> package is its ability to rename
any file to use the efficient Denote file-naming scheme (makes file
names predictable and easy to retrieve even with rudimentary tools).
To this end, we provide several commands that affect file names,
beside the commands that create new files.
</p>

<p>
As noted above, the commands which rename files to follow the Denote
file-naming scheme now conform with the user option <code>denote-prompts</code>,
but there is more!
</p>
</div>
<div id="outline-container-h:f93b8075-de2d-416e-9275-7225d03678ad" class="outline-4">
<h4 id="h:f93b8075-de2d-416e-9275-7225d03678ad"><span class="section-number-4">5.4.1.</span> A broadened scope for the <code>denote-rename-no-confirm</code> option</h4>
<div class="outline-text-4" id="text-h:f93b8075-de2d-416e-9275-7225d03678ad">
<p>
The implementation of this user option is redone (i) to save the
underlying buffer outright if the user does not want to provide their
confirmation for a rename each time and (ii) to cover all relevant
commands that perform a rename operation. The assumption is that the
user who opts in to this feature is familiar with the Denote renaming
modalities and knows they are reliable.
</p>

<p>
The default is still the same: Denote always asks for confirmation
before renaming a file, showing the difference between the old and new
names, as well as any changes to the file&rsquo;s contents. In this light,
buffers are not saved to give the user the chance to further inspect
the changes (such as by running <code>diff-buffer-with-file</code>).
</p>

<p>
Commands that will now skip all confirmation prompts to rename the file
and, where relevant, save the corresponding buffer outright:
</p>

<ul class="org-ul">
<li><code>denote-rename-file</code></li>
<li><code>denote-dired-rename-files</code></li>
<li><code>denote-dired-rename-marked-files-with-keywords</code></li>
<li><code>denote-rename-file-using-front-matter</code></li>
<li><code>denote-rename-add-keywords</code></li>
<li><code>denote-rename-remove-keywords</code></li>
<li><code>denote-rename-add-signature</code> (new, more below)</li>
<li><code>denote-rename-remove-signature</code> (new, more below)</li>
</ul>
</div>
</div>
<div id="outline-container-h:01ab0277-b4d4-433e-bd25-b9a0357412f6" class="outline-4">
<h4 id="h:01ab0277-b4d4-433e-bd25-b9a0357412f6"><span class="section-number-4">5.4.2.</span> Rename a file by adding or removing a <code>SIGNATURE</code> component</h4>
<div class="outline-text-4" id="text-h:01ab0277-b4d4-433e-bd25-b9a0357412f6">
<p>
The <code>SIGNATURE</code> is an optional free-form field that is part of a
Denote file name. A common use-case is to write sequence notes with
it, though Denote does not enforce any particular convention (you may
prefer to have it as a special kind of keyword for certain files that
simply stands out more due to its placement).
</p>

<p>
[ Besides, the <code>denote-sort-dired</code> command lets you filter and sort
  files while putting them in a fully fledged Dired buffer, so
  manually sequencing notes via their signature may not be needed. ]
</p>

<p>
We now provide two commands to add or remove a signature from file
names:
</p>

<ul class="org-ul">
<li>The <code>denote-rename-add-signature</code> prompts for a file and a
signature. The default value for the file prompt is the file of the
currently open buffer or the file-at-point in a Dired buffer. The
signature is an ordinary string, defaulting to the selected file&rsquo;s
signature, if any.</li>

<li>The <code>denote-rename-remove-signature</code> uses the same file prompt as
above. It performs its action only if the selected file has a
signature. Otherwise, it does nothing.</li>
</ul>

<p>
Files that do not have a Denote file name are renamed accordingly.
Though for such cases it is better to use <code>denote-rename-file</code> or
<code>denote-dired-rename-files</code> as they are more general.
</p>
</div>
</div>
<div id="outline-container-h:57f4f60c-7873-4542-a7a5-5c997cdbd137" class="outline-4">
<h4 id="h:57f4f60c-7873-4542-a7a5-5c997cdbd137"><span class="section-number-4">5.4.3.</span> Use the <code>denote-after-rename-file-hook</code> for optional post-rename operations</h4>
<div class="outline-text-4" id="text-h:57f4f60c-7873-4542-a7a5-5c997cdbd137">
<p>
All renaming commands run the <code>denote-after-rename-file-hook</code> after a
successful operation. This is meant for users who want to do something
specific after the renaming is done.
</p>
</div>
</div>
</div>
<div id="outline-container-h:a0a2753e-5be9-4776-9f3f-e3b7556c13c1" class="outline-3">
<h3 id="h:a0a2753e-5be9-4776-9f3f-e3b7556c13c1"><span class="section-number-3">5.5.</span> More optional features of the <code>denote-org-extras.el</code></h3>
<div class="outline-text-3" id="text-h:a0a2753e-5be9-4776-9f3f-e3b7556c13c1">
<p>
I already covered the <code>denote-org-extras-link-to-heading</code>, though the
file <code>denote-org-extras.el</code> has some more optional goodies for those
who work with Org files.
</p>
</div>
<div id="outline-container-h:fbf1e574-e9aa-4c67-8034-27341d7a5536" class="outline-4">
<h4 id="h:fbf1e574-e9aa-4c67-8034-27341d7a5536"><span class="section-number-4">5.5.1.</span> Create a note from the current Org subtree</h4>
<div class="outline-text-4" id="text-h:fbf1e574-e9aa-4c67-8034-27341d7a5536">
<p>
In Org parlance, an entry with all its subheadings and other contents
is a &ldquo;subtree&rdquo;. Denote can operate on the subtree to extract it from
the current file and create a new file out of it. One such workflow is
to collect thoughts in a single document and produce longer standalone
notes out of them upon review.
</p>

<p>
The command <code>denote-org-extras-extract-org-subtree</code> (part of the
optional <code>denote-org-extras.el</code> extension) is used for this purpose.
It creates a new Denote note using the current Org subtree. In doing
so, it removes the subtree from its current file and moves its
contents into a new file.
</p>

<p>
The text of the subtree&rsquo;s heading becomes the <code>#+title</code> of the new
note. Everything else is inserted as-is.
</p>

<p>
Read the documentation string of <code>denote-org-extras-extract-org-subtree</code>
or consult the manual for further details.
</p>
</div>
</div>
<div id="outline-container-h:042e26e8-e3e0-4c57-9855-6b363671ae9a" class="outline-4">
<h4 id="h:042e26e8-e3e0-4c57-9855-6b363671ae9a"><span class="section-number-4">5.5.2.</span> Convert <code>denote:</code> links to <code>file:</code> links</h4>
<div class="outline-text-4" id="text-h:042e26e8-e3e0-4c57-9855-6b363671ae9a">
<p>
Sometimes the user needs to translate all <code>denote:</code> link types to
their <code>file:</code> equivalent. This may be because some other tool does not
recognise <code>denote:</code> links (or other custom links types&#x2014;which are a
standard feature of Org, by the way). The user thus needs to (i)
either make a copy of their Denote note or edit the existing one, and
(ii) convert all links to the generic <code>file:</code> link type that
external/other programs understand.
</p>

<p>
The optional extension <code>denote-org-extras.el</code> contains two commands
that are relevant for this use-case:
</p>

<dl class="org-dl">
<dt>Convert <code>denote:</code> links to <code>file:</code> links</dt><dd>The command
<code>denote-org-extras-convert-links-to-file-type</code> goes through the
buffer to find all <code>denote:</code> links. It gets the identifier of the
link and resolves it to the actual file system path. It then
replaces the match so that the link is written with the <code>file:</code> type
and then the file system path. The optional search terms and/or link
description are preserved.</dd>

<dt>Convert <code>file:</code> links to <code>denote:</code> links</dt><dd>The command
<code>denote-org-extras-convert-links-to-denote-type</code> behaves like the
one above. The difference is that it finds the file system path and
converts it into its identifier.</dd>
</dl>
</div>
</div>
<div id="outline-container-h:51d72c47-d434-4954-98d6-2db7a7ea6812" class="outline-4">
<h4 id="h:51d72c47-d434-4954-98d6-2db7a7ea6812"><span class="section-number-4">5.5.3.</span> The Denote Org dynamic blocks are now in <code>denote-org-extras.el</code></h4>
<div class="outline-text-4" id="text-h:51d72c47-d434-4954-98d6-2db7a7ea6812">
<p>
As part of this version, all our dynamic blocks are defined in the
file <code>denote-org-extras.el</code>. The file which once contained these block
definitions, <code>denote-org-dblock.el</code>, now only has aliases for the new
function names and dipslays a warning about its deprecation.
</p>

<p>
There is no need to <code>require</code> the <code>denote-org-extras</code> feature because
all of Denote&rsquo;s Org dynamic blocks are autoloaded (meaning that they
work as soon as they are used). For backward compatibility, all
dynamic blocks retain their original names as an alias for the newer
one.
</p>

<p>
We will not remove <code>denote-org-dblock.el</code> anytime soon to avoid any
potential breakage with people&rsquo;s existing notes. Though if you are new
to this functionality, you better avoid the deprecated symbols.
</p>
</div>
</div>
<div id="outline-container-h:45176e63-c609-40f6-a11d-1cc0c28460dd" class="outline-4">
<h4 id="h:45176e63-c609-40f6-a11d-1cc0c28460dd"><span class="section-number-4">5.5.4.</span> Org dynamic block to only insert missing links</h4>
<div class="outline-text-4" id="text-h:45176e63-c609-40f6-a11d-1cc0c28460dd">
<p>
The <code>denote-missing-links</code> block is available with the command
<code>denote-org-extras-dblock-insert-missing-links</code>. It is like the
<code>denote-links</code> block (documented at length in the manual), except it
only lists links to files that are not present in the current buffer.
The parameters are otherwise the same:
</p>

<pre class="example">
#+BEGIN: denote-missing-links :regexp "YOUR REGEXP HERE" :sort-by-component nil :reverse-sort nil :id-only nil

#+END:
</pre>


<p>
Remember to type <code>C-c C-x C-u</code> (<code>org-dblock-update</code>) with point on the
<code>#+BEGIN</code> line to update the block.
</p>

<p>
This brings back a feature that was deprecated in version 2.2.0, but
makes changes to it so that (i) it is more limited in scope and (ii)
available as a standalone Org dynamic block.
</p>

<p>
Thanks to Stephen R. Kifer, Peter Prevos, and Elias Storms for the
discussion which made it clear to me that users do have a need for
such functionality. This was done in the now-defunct mailing list:
<a href="https://lists.sr.ht/~protesilaos/denote/%3C1db2104e-70bd-47f9-a7ed-b8d4bb370a7f%40app.fastmail.com%3E">https://lists.sr.ht/~protesilaos/denote/%3C1db2104e-70bd-47f9-a7ed-b8d4bb370a7f%40app.fastmail.com%3E</a>.
</p>

<p>
Also thanks to Vedang Manerikar for fixing an edge case bug. This was
done in pull request 260: <a href="https://github.com/protesilaos/denote/pull/260">https://github.com/protesilaos/denote/pull/260</a>.
</p>

<p>
Org dynamic blocks are a powerful feature which also showcases how far
we can go with Denote&rsquo;s efficient file-naming scheme.
</p>
</div>
</div>
</div>
<div id="outline-container-h:08f27f36-0ed2-4a5e-b02b-f0075c6e904f" class="outline-3">
<h3 id="h:08f27f36-0ed2-4a5e-b02b-f0075c6e904f"><span class="section-number-3">5.6.</span> Quality-of-life improvements</h3>
<div class="outline-text-3" id="text-h:08f27f36-0ed2-4a5e-b02b-f0075c6e904f">
<p>
Here I include other changes we made to existing functionality.
</p>
</div>
<div id="outline-container-h:240b80e7-242c-46fb-83d2-1ba36bdcaf66" class="outline-4">
<h4 id="h:240b80e7-242c-46fb-83d2-1ba36bdcaf66"><span class="section-number-4">5.6.1.</span> BREAKING User-defined sluggification of file name components</h4>
<div class="outline-text-4" id="text-h:240b80e7-242c-46fb-83d2-1ba36bdcaf66">
<p>
In the previous version, we introduced the user option
<code>denote-file-name-letter-casing</code>. This was used to control the letter
casing of file name components, but was ultimately not flexible enough
for our purposes. We are thus retiring it and replacing it with the
more powerful, but also more advanced, user option
<code>denote-file-name-slug-functions</code>.
</p>

<p>
For existing users of the deprecated functionality, you can still
preserve the input of a prompt verbatim with something like this:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(setq denote-file-name-slug-functions
      '((title . denote-sluggify-title)
        (keyword . identity)
        (signature . denote-sluggify-signature)))
</pre>
</div>

<p>
The manual explains the details and shows ready-to-use code samples.
</p>

<p>
Remember that deviating from the default file-naming scheme of Denote
will make things harder to use in the future, as files will have
permutations that create uncertainty. The sluggification scheme and
concomitant restrictions we impose by default are there for a very
good reason: they are the distillation of years of experience. Here we
give you what you wish, but bear in mind it may not be what you need.
You have been warned.
</p>

<p>
Thanks to Jean-Philippe Gagné Guay for introducing this variable,
among other tweaks, in pull request 217: <a href="https://github.com/protesilaos/denote/pull/217">https://github.com/protesilaos/denote/pull/217</a>.
Jean-Philippe has assigned copyright to the Free Software Foundation.
</p>
</div>
</div>
<div id="outline-container-h:3e1249f1-ac26-4187-9ddd-7391b4e5131f" class="outline-4">
<h4 id="h:3e1249f1-ac26-4187-9ddd-7391b4e5131f"><span class="section-number-4">5.6.2.</span> Option to automatically save the buffer of a new note</h4>
<div class="outline-text-4" id="text-h:3e1249f1-ac26-4187-9ddd-7391b4e5131f">
<p>
The user option <code>denote-save-buffer-after-creation</code> controls whether
commands that create new notes save their buffer right away.
</p>

<p>
The default behaviour of commands such as <code>denote</code> (or related) is to
not save the buffer they create. This gives the user the chance to
review the text before writing it to a file. The user may choose to
delete the unsaved buffer, thus not creating a new file on disk.
</p>

<p>
If <code>denote-save-buffer-after-creation</code> is set to a non-nil value, such
buffers are saved automatically and so the file is written to disk.
</p>
</div>
</div>
<div id="outline-container-h:c8336927-cf6b-4770-b041-123bf9186e57" class="outline-4">
<h4 id="h:c8336927-cf6b-4770-b041-123bf9186e57"><span class="section-number-4">5.6.3.</span> The <code>denote-menu-bar-mode</code> and the placement of the Denote submenu</h4>
<div class="outline-text-4" id="text-h:c8336927-cf6b-4770-b041-123bf9186e57">
<p>
The command <code>denote-menu-bar-mode</code> toggles the inclusion of the
submenu with the Denote entries in the Emacs menu bar (which is on
display when <code>menu-bar-mode</code> is enabled).
</p>

<p>
This submenu is now shown after the <code>Tools</code> entry.
</p>

<p>
Thanks to Joseph Turner for sending me the relevant patches. Joseph
has assigned copyright to the Free Software Foundation.
</p>
</div>
</div>
<div id="outline-container-h:1c884b19-7ab7-4eb5-a332-815d25f7373c" class="outline-4">
<h4 id="h:1c884b19-7ab7-4eb5-a332-815d25f7373c"><span class="section-number-4">5.6.4.</span> The <code>C-c C-o</code> works in <code>markdown-mode</code> for Denote links</h4>
<div class="outline-text-4" id="text-h:1c884b19-7ab7-4eb5-a332-815d25f7373c">
<p>
In files whose major mode is <code>markdown-mode</code>, the default key binding
<code>C-c C-o</code> (which calls the command <code>markdown-follow-thing-at-point</code>)
correctly resolves <code>denote:</code> links. This method works in addition to
the <code>RET</code> key, which is made available by the buttonization that we
also provide. Interested users can refer to the function
<code>denote-link-markdown-follow</code> for the implementation details.
</p>

<p>
Thanks to user pmenair for noting a case where this was breaking
general Markdown linking functionality. This was done in issue 290:
<a href="https://github.com/protesilaos/denote/issues/290">https://github.com/protesilaos/denote/issues/290</a>.
</p>
</div>
</div>
<div id="outline-container-h:c6f739ef-ea26-41b8-84e6-c87c4622cdba" class="outline-4">
<h4 id="h:c6f739ef-ea26-41b8-84e6-c87c4622cdba"><span class="section-number-4">5.6.5.</span> More fine-grained control of Denote faces for dates/identifiers</h4>
<div class="outline-text-4" id="text-h:c6f739ef-ea26-41b8-84e6-c87c4622cdba">
<p>
We now define more faces for fine-grained control of the identifier in
Dired. Thanks to mentalisttraceur for suggesting the idea in issue
276: <a href="https://github.com/protesilaos/denote/issues/276">https://github.com/protesilaos/denote/issues/276</a>.
</p>

<p>
Before you ask, no, none of my themes will cover those faces because
extra colouration is something only the user can decide if they want
or not. In the above link I provide a sample with a screenshot (apart
from the <code>modus-themes</code>, my <code>ef-themes</code> and <code>standard-themes</code> have
similar functionality):
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(defun my-modus-themes-denote-faces (&amp;rest _)
  (modus-themes-with-colors
    (custom-set-faces
     `(denote-faces-year ((,c :foreground ,cyan)))
     `(denote-faces-month ((,c :foreground ,magenta-warmer)))
     `(denote-faces-day ((,c :foreground ,cyan)))
     `(denote-faces-time-delimiter ((,c :foreground ,fg-main)))
     `(denote-faces-hour ((,c :foreground ,magenta-warmer)))
     `(denote-faces-minute ((,c :foreground ,cyan)))
     `(denote-faces-second ((,c :foreground ,magenta-warmer))))))

(add-hook 'modus-themes-post-load-hook #'my-modus-themes-denote-faces)
</pre>
</div>
</div>
</div>
<div id="outline-container-h:9e7bff88-a6ad-45e7-b802-0493153e0e20" class="outline-4">
<h4 id="h:9e7bff88-a6ad-45e7-b802-0493153e0e20"><span class="section-number-4">5.6.6.</span> New convenience command for users of the optional <code>denote-journal-extras.el</code></h4>
<div class="outline-text-4" id="text-h:9e7bff88-a6ad-45e7-b802-0493153e0e20">
<p>
The command <code>denote-journal-extras-link-or-create-entry</code> links to the
journal entry for today or creates it in the background, if missing,
and then links to it from the current file. If there are multiple
journal entries for the same day, it prompts to select one among them
and then links to it. When called with an optional prefix argument
(such as <code>C-u</code> with default key bindings), the command prompts for a
date and then performs the aforementioned. With a double prefix
argument (<code>C-u C-u</code>), it also produces a link whose description
includes just the file&rsquo;s identifier.
</p>

<p>
Thanks to Alan Schmitt for contributing this command, based on
previous discussions. It was done in pull request 243:
<a href="https://github.com/protesilaos/denote/pull/243">https://github.com/protesilaos/denote/pull/243</a>.
</p>
</div>
</div>
</div>
<div id="outline-container-h:03778c8c-60aa-449c-96df-7e41916668a6" class="outline-3">
<h3 id="h:03778c8c-60aa-449c-96df-7e41916668a6"><span class="section-number-3">5.7.</span> For developers or advanced users</h3>
<div class="outline-text-3" id="text-h:03778c8c-60aa-449c-96df-7e41916668a6">
<p>
These has new parameters or are new symbols altogether. Please read
their respective doc string for the details.
</p>

<ul class="org-ul">
<li>Function <code>denote-convert-file-name-keywords-to-crm</code>.</li>
<li>Function <code>denote-valid-date-p</code>.</li>
<li>Function <code>denote-parse-date</code>.</li>
<li>Function <code>denote-retrieve-title-or-filename</code>.</li>
<li>Function <code>denote-get-identifier</code>.</li>
<li>Function <code>denote-signature-prompt</code>.</li>
<li>Function <code>denote-file-prompt</code>.</li>
<li>Function <code>denote-keywords-prompt</code>.</li>
<li>Function <code>denote-title-prompt</code>.</li>
<li>Function <code>denote-rewrite-front-matter</code>.</li>
<li>Function <code>denote-rewrite-keywords</code>.</li>
<li>Function <code>denote-update-dired-buffers</code>.</li>
<li>Function <code>denote-format-string-for-org-front-matter</code>.</li>
<li>Function <code>denote-format-string-for-md-front-matter</code>.</li>
<li>Variable <code>denote-link-signature-format</code>.</li>
<li>Function <code>denote-link-description-with-signature-and-title</code>.</li>
<li>Variable <code>denote-link-description-function</code>.</li>
</ul>
</div>
</div>
<div id="outline-container-h:040f2678-674d-4e99-b428-659cd3a3b7c3" class="outline-3">
<h3 id="h:040f2678-674d-4e99-b428-659cd3a3b7c3"><span class="section-number-3">5.8.</span> Miscellaneous</h3>
<div class="outline-text-3" id="text-h:040f2678-674d-4e99-b428-659cd3a3b7c3">
<ul class="org-ul">
<li>The <code>denote-sort-dired</code> function no longer errors out when there is
no match for the given search terms. Thanks to Vedang Manerikar for
the initial patch! This was done in the now-defunct mailing list:
<a href="https://lists.sr.ht/~protesilaos/denote/patches/47625">https://lists.sr.ht/~protesilaos/denote/patches/47625</a>. Further
changes by me.</li>

<li>The <code>denote-keywords-sort</code> function no longer tries to sort keywords
that are not a list. Thanks to Ashton Wiersdorf for the patch. The
change is small. As such, Ashton does not need to assign copyright
to the Free Software Foundation.</li>

<li>Documented in the manual that custom convenience commands can be
accessed by the <code>denote-command-prompt</code>. Thanks to Glenna D. for
clarifying the language.</li>

<li>The <code>denote-user-enforced-denote-directory</code> is obsolete. Those who
used it in their custom code can simply <code>let</code> bind the value of the
variable <code>denote-directory</code>. Thanks to Jean-Philippe Gagné Guay for
making the relevant changes (the Git history is not direct here and
I cannot quickly find the pull request&#x2014;the commit is <code>a48a1da</code>).</li>

<li>The <code>denote-link-return-links</code> no longer keeps buffers around.
Thanks to Matteo Cavada for the patch. This was done in pull request
252: <a href="https://github.com/protesilaos/denote/pull/252">https://github.com/protesilaos/denote/pull/252</a>. The change is
small and so Matteo does not need to assign copyright to the Free
Software Foundation.</li>

<li>Thanks to user jarofromel (recorded in Git as &ldquo;random&rdquo; author) for
fixing a mismatched parenthesis in <code>denote-parse-date</code>. This was
done in pull request 258: <a href="https://github.com/protesilaos/denote/pull/258">https://github.com/protesilaos/denote/pull/258</a>.</li>

<li>The <code>denote-rename-buffer-mode</code> now works as expected with
non-editable files, like PDFs. Thanks to Alan Schmitt for bringing
this matter to my attention and then refining the implementation
details in pull request 268: <a href="https://github.com/protesilaos/denote/pull/268">https://github.com/protesilaos/denote/pull/268</a>.</li>

<li>All the Denote linking functions can be used from any file outside
the <code>denote-directory</code> (links are still resolved to files inside the
<code>denote-directory</code>). Thanks to Jean-Philippe Gagné Guay for the
contribution in pull request 236: <a href="https://github.com/protesilaos/denote/pull/236">https://github.com/protesilaos/denote/pull/236</a>.</li>

<li>We removed all glue code that integrated Denote with the built-in
<code>ffap</code>, <code>xref</code>, and <code>project</code> libraries. We may reconsider how best
to organise such features in the future. Thanks to Noboru Ota
(nobiot), who originally contributed those extensions, for
suggesting their removal from our code base. We did this by
evaluating all use-cases. The discussion with Noboru happened in
issue 264: <a href="https://github.com/protesilaos/denote/issues/264">https://github.com/protesilaos/denote/issues/264</a>. Also
thanks to Jean-Philippe Gagné Guay and Alan Schnmitt for checking
the impact of this on how we generate backlinks. The latest
iteration of this was done in pull request 294, by Jean-Philippe:
<a href="https://github.com/protesilaos/denote/pull/294">https://github.com/protesilaos/denote/pull/294</a>.</li>

<li>While renaming files, signatures no longer lose consecutive spaces.
Thanks to Wesley Harvey for the contribution in pull request 207:
<a href="https://github.com/protesilaos/denote/pull/207">https://github.com/protesilaos/denote/pull/207</a>. The change is
within the ~15 line limit and so Wesley does not need to assign
copyright to the Free Software Foundation.</li>

<li>All of the above and lots more are documented at length in the
manual. This is a big task in its own right (as are release notes,
by the way), though it ensures we keep a high standard for the
entire package and can communicate all our knowledge to the user.</li>
</ul>
</div>
</div>
<div id="outline-container-h:9a0d6afc-95e0-490e-a573-5a50fe7bdf28" class="outline-3">
<h3 id="h:9a0d6afc-95e0-490e-a573-5a50fe7bdf28"><span class="section-number-3">5.9.</span> No more SourceHut</h3>
<div class="outline-text-3" id="text-h:9a0d6afc-95e0-490e-a573-5a50fe7bdf28">
<p>
Development continues on GitHub with GitLab as a mirror. I explained
my reasons here: <a href="https://protesilaos.com/codelog/2024-01-27-sourcehut-no-more/">https://protesilaos.com/codelog/2024-01-27-sourcehut-no-more/</a>.
</p>

<p>
This is a change that affects all my Emacs packages.
</p>
</div>
</div>
<div id="outline-container-h:61fb340e-5c7c-4a4b-927c-63faf4759a09" class="outline-3">
<h3 id="h:61fb340e-5c7c-4a4b-927c-63faf4759a09"><span class="section-number-3">5.10.</span> Forward guidance for Denote version 3.0.0</h3>
<div class="outline-text-3" id="text-h:61fb340e-5c7c-4a4b-927c-63faf4759a09">
<p>
We will not any new features until mid-April or a bit later if
necessary. This gives users enough time to report any potential issues
with version <code>2.3.0</code>. If there are any bugs, they will be fixed right
away and new minor releases will be introduced (though without release
notes).
</p>

<p>
Once we are done with this release cycle, we want to prepare for the
next major version of Denote. The plan is to make the placement of
file name components entirely customisable, among many other power
user features. Though the defaults will remain intact.
</p>

<p>
For the immediate future, please prioritise bug reports/fixes. Then
see you around for another round of hacking. The Denote code base is a
pleasure to work with due to how composable everything is. I happy to
make it even better for developers and users alike.
</p>
</div>
</div>
<div id="outline-container-h:a6fd8e16-ded9-49cf-afbb-6e1373c3c43d" class="outline-3">
<h3 id="h:a6fd8e16-ded9-49cf-afbb-6e1373c3c43d"><span class="section-number-3">5.11.</span> Git commits</h3>
<div class="outline-text-3" id="text-h:a6fd8e16-ded9-49cf-afbb-6e1373c3c43d">
<p>
Just an overview of what we did. Thanks again to everyone involved.
</p>

<div class="org-src-container">
<pre class="src src-sh">~/Git/Projects/denote $ git shortlog 2.2.0..2.3.0 --summary --numbered
   246	Protesilaos Stavrou
    46	Jean-Philippe Gagné Guay
     6	Vedang Manerikar
     3	Joseph Turner
     2	Alan Schmitt
     2	Max
     2	Peter Prevos
     1	Ashton Wiersdorf
     1	Glenna D.
     1	Matteo Cavada
     1	mattyonweb
     1	random
     1	wlharvey4
</pre>
</div>
</div>
</div>
<div id="outline-container-h:967372fa-933b-40d2-b1a8-546d1a50d35d" class="outline-3">
<h3 id="h:967372fa-933b-40d2-b1a8-546d1a50d35d"><span class="section-number-3">5.12.</span> All contributions are valuable</h3>
<div class="outline-text-3" id="text-h:967372fa-933b-40d2-b1a8-546d1a50d35d">
<p>
I encourage you to provide feedback on any of the functionality of the
Denote package. You do not need to be a developer or indeed an expert
in Emacs. When you have an idea in mind on how you use Denote, or you
think something could be done differently, please speak your mind. I
do listen to feedback and am interested in further improving this
package. Everybody is welcome!
</p>
</div>
</div>
</div>
<div id="outline-container-h:8efed390-cfa0-420d-b300-0cb76bf2c9f9" class="outline-2">
<h2 id="h:8efed390-cfa0-420d-b300-0cb76bf2c9f9"><span class="section-number-2">6.</span> Version 2.2.0 on 2023-12-10</h2>
<div class="outline-text-2" id="text-h:8efed390-cfa0-420d-b300-0cb76bf2c9f9">
<p>
The present version covers four broad themes:
</p>

<ol class="org-ol">
<li>Denote rename commands are more user-friendly and featureful.</li>
<li>An optional sorting facility makes it possible to produce a
filtered and sorted Dired buffer with Denote files.</li>
<li>The optional Denote Org dynamic blocks have received a lot of attention.</li>
<li>Bug fixes and internal refinements.</li>
</ol>

<p>
[ Remember that you do not need to be a programmer to contribute to
  Denote. Report a bug, make a suggestion, or just describe how you
  want to use this package. Every idea counts and we may implement it
  if we can. ]
</p>
</div>
<div id="outline-container-h:54d803d8-4863-4160-bb2f-3302fb8bff23" class="outline-3">
<h3 id="h:54d803d8-4863-4160-bb2f-3302fb8bff23"><span class="section-number-3">6.1.</span> The rename commands can remove a Denote file name component</h3>
<div class="outline-text-3" id="text-h:54d803d8-4863-4160-bb2f-3302fb8bff23">
<p>
The commands we provide to rename files using the Denote file-naming
scheme---<code>denote-rename-file</code>, <code>denote-dired-rename-files</code>, and
<code>denote-dired-rename-marked-files-with-keywords</code>&#x2014;can now remove
Denote file name components. This is done by providing an empty string
at the relevant prompt.
</p>

<p>
For example, to remove the <code>TITLE</code> component from a file called
<code>20231209T110322==sig--title__keywords.ext</code> we provide an empty string
at the title prompt. The end result will look something like this:
<code>20231209T110322==sig__keywords.ext</code>.
</p>

<p>
All prompts now include a hint that leaving them empty will ignore the
given field if it does not exist or remove it if it does exist.
</p>

<p>
Note that you must <b>check how to input an empty string</b> with your
minibuffer user interface of choice. For instance, with the <code>vertico</code>
package you can do that with the <code>M-RET</code> key binding or by selecting
the prompt line directly (notice the counter showing something like
<code>*/5</code> instead of <code>1/5</code>). Please make sure to consult the documentation
of the package you are using as this behaviour is not controlled by
Denote. Vertico, and others like it, selects the first candidate if
you type <code>RET</code> without any input, which is not the same as an empty
string&#x2014;it is the first candidate.
</p>

<p>
Also read the Denote manual on the matter of <a href="https://protesilaos.com/emacs/denote#h:532e8e2a-9b7d-41c0-8f4b-3c5cbb7d4dca">Renaming files</a>. In short,
we use this facility to name all our files, regardless of file type,
in a consistent way that makes them easier to find (I do this with my
videos, for example, and I do it across my filesystem for all personal
files).
</p>
</div>
</div>
<div id="outline-container-h:69d85d3b-0200-4cc1-baff-9d59aa0ff57b" class="outline-3">
<h3 id="h:69d85d3b-0200-4cc1-baff-9d59aa0ff57b"><span class="section-number-3">6.2.</span> The file-to-be-renamed is easier to read in the minibuffer</h3>
<div class="outline-text-3" id="text-h:69d85d3b-0200-4cc1-baff-9d59aa0ff57b">
<p>
The commands <code>denote-rename-file</code> and <code>denote-dired-rename-files</code> 
show the name of the file they are operating on in the minibuffer
prompt. This is now produced relative to the current directory,
meaning that instead of <code>/some/rather/long/path/to/file-name.txt</code>
Denote only displays <code>file-name.txt</code>.
</p>

<p>
Our rename commands never move files to another directory, anyway, so
we do not need to remind the user of the entire file system path.
</p>

<p>
To make things easier for users/themes, file names highlighted in
Denote prompts are fontified with either of following faces,
depending on the specifics of the case:
</p>

<ul class="org-ul">
<li><code>denote-faces-prompt-old-name</code></li>
<li><code>denote-faces-prompt-new-name</code></li>
<li><code>denote-faces-prompt-current-name</code></li>
</ul>

<p>
These faces inherit the attributes of basic faces, so they should look
decent without further tweaks across all themes.
</p>
</div>
</div>
<div id="outline-container-h:5897bcc1-4637-4268-8518-8404d939b4b9" class="outline-3">
<h3 id="h:5897bcc1-4637-4268-8518-8404d939b4b9"><span class="section-number-3">6.3.</span> Prompts for title, keywords, and signature accept an empty string</h3>
<div class="outline-text-3" id="text-h:5897bcc1-4637-4268-8518-8404d939b4b9">
<p>
The prompts defined by Denote that apply to file name components all
accept an empty string. This has the effect of skipping the given
component. For example, we can create a file without a title and
keywords, with the following sequence of actions (I assume you are
using <code>vertico</code> for the minibuffer user interface):
</p>

<ul class="org-ul">
<li>Type <code>M-x denote</code>.</li>
<li>Type <code>M-RET</code> at the title prompt to input an empty string.</li>
<li>Now type <code>M-RET</code> at the keywords prompt for another empty string.</li>
</ul>

<p>
The resulting file name is something like <code>20231209T110950.org</code>.
</p>
</div>
</div>
<div id="outline-container-h:05aa437b-2fc8-4e01-ac38-ab77baad83af" class="outline-3">
<h3 id="h:05aa437b-2fc8-4e01-ac38-ab77baad83af"><span class="section-number-3">6.4.</span> Dired with sorting and filtering</h3>
<div class="outline-text-3" id="text-h:05aa437b-2fc8-4e01-ac38-ab77baad83af">
<p>
The new optional <code>denote-sort.el</code> library provides facilities to sort
Denote files by any of their file name components. Users can benefit
from this facility to produce a filtered and sorted listing of Denote
files with the command <code>denote-sort-dired</code>.
</p>

<p>
<code>denote-sort-dired</code> produces a fully fledged Dired buffer. It asks for a
regular expression that matches file names in the <code>denote-directory</code>.
It then prompts for a sort key and finally checks with the user
whether to reverse the order or not.
</p>

<p>
[ Do not be discouraged by the term &ldquo;regular expression&rdquo;. Ordinary
  words work fine. Plus, with Denote&rsquo;s file-naming scheme we have
  semantics such as <code>_keyword</code>, <code>-title</code>, <code>=signature</code>, as explained
  in the manual. This is the whole point of using a thoughtful naming
  scheme. ]
</p>

<p>
The resulting Dired listing is flat, meaning that files inside of
subdirectories are bundled together with those present at the root of
the <code>denote-directory</code>. In this case, files inside of a subdirectory
include the directory component as a prefix. So we have something like
this:
</p>

<pre class="example" id="orgd2aa6d4">
test-subdir/20230320T105950--a-new-note__testing.txt
20231202T095629--rename-works-as-intended__one_test_two.org
</pre>

<p>
I think this is a killer feature, as the fully fledged Dired buffer
allows us to perform all supported operations on our Denote
sorted+filtered files (e.g. change file permissions, move files to
another directory, or open them in an external application).
</p>

<p>
I recorded a video to show how this works:
<a href="https://protesilaos.com/codelog/2023-12-04-emacs-denote-sort-mechanism/">https://protesilaos.com/codelog/2023-12-04-emacs-denote-sort-mechanism/</a>.
</p>

<p>
[ Remember that we can rename any file using the Denote file-naming
  scheme, meaning that our files can include stuff like PDFs and
  videos. Combine this with the concept of &ldquo;silos&rdquo;, which is covered
  in the Denote manual, to organise your long-term storage and
  retrieve it efficiently. ]
</p>
</div>
</div>
<div id="outline-container-h:d41009c1-9833-4b28-8240-9666bfd26559" class="outline-3">
<h3 id="h:d41009c1-9833-4b28-8240-9666bfd26559"><span class="section-number-3">6.5.</span> Combine contents of files with an Org dynamic block</h3>
<div class="outline-text-3" id="text-h:d41009c1-9833-4b28-8240-9666bfd26559">
<p>
The new <code>denote-files</code> Org dynamic block produces a continuous stream
of file contents. It joins together the contents of files inside the
<code>denote-directory</code> whose name matches the given regular expression.
Optional parameters control whether to include links to those files,
omit their front matter, sort by a given file name component, or tweak
the separator between each file&rsquo;s contents.
</p>

<p>
I produced a video to demonstrate the functionality:
<a href="https://protesilaos.com/codelog/2023-11-25-emacs-denote-org-dynamic-blocks/">https://protesilaos.com/codelog/2023-11-25-emacs-denote-org-dynamic-blocks/</a>.
</p>

<p>
Use the command <code>denote-org-dblock-insert-files</code> to insert such a
block directly at point. Read the Denote manual for the
technicalities: <a href="https://protesilaos.com/emacs/denote#h:f15fa143-5036-416f-9bff-1bcabbb03456">Org dynamic block to insert file contents</a>.
</p>

<p>
[ Videos I do will eventually be out-of-date. The manual is the source
  of truth. ]
</p>

<p>
Bear in mind that this feature is not &ldquo;transclusion&rdquo;. We are simply
printing a copy of the contents of the files in the current buffer.
Changes made to this copy are not reflected in the original files.
</p>

<p>
The <code>denote-files</code> Org dynamic block is an excellent way to quickly
collect your thoughts on a given topic. Although dynamic blocks are a
feature of Org, the contents of the files do not need to be in Org
syntax (I write most of my notes in plain text (<code>.txt</code>)).
</p>

<p>
Thanks to Claudiu Tănăselia for proposing this idea and discussing it
with me. This was done via a private channel and the information is
shared with permission.
</p>
</div>
</div>
<div id="outline-container-h:7b51fe38-302e-488d-9816-7015a8071ddb" class="outline-3">
<h3 id="h:7b51fe38-302e-488d-9816-7015a8071ddb"><span class="section-number-3">6.6.</span> Sort parameters are used in all Denote Org dynamic blocks</h3>
<div class="outline-text-3" id="text-h:7b51fe38-302e-488d-9816-7015a8071ddb">
<p>
All Denote Org dynamic blocks make use of <code>denote-sort.el</code> (described
further above). It powers the <code>:sort-by-component</code> and <code>:reverse-sort</code>
parameters.
</p>

<p>
Thanks to Glenna D. for suggesting this feature and discussing it with
me. This was done via a private channel and the information is shared
with permission. It is what inspired me to start work on
<code>denote-sort.el</code>, which I then extended to cover Dired, as noted
above.
</p>
</div>
</div>
<div id="outline-container-h:2bd26aef-70ad-4d83-a4ab-c75a893a733a" class="outline-3">
<h3 id="h:2bd26aef-70ad-4d83-a4ab-c75a893a733a"><span class="section-number-3">6.7.</span> The <code>:missing-only</code> parameter is removed from Org dynamic blocks</h3>
<div class="outline-text-3" id="text-h:2bd26aef-70ad-4d83-a4ab-c75a893a733a">
<p>
I am removing it because the underlying functionality of
<code>denote-add-missing-links</code> was not always reliable.
</p>
</div>
</div>
<div id="outline-container-h:144436eb-e674-4052-ac0a-d582b6aa2f53" class="outline-3">
<h3 id="h:144436eb-e674-4052-ac0a-d582b6aa2f53"><span class="section-number-3">6.8.</span> Files with signature are linked appropriately in Org dynamic blocks</h3>
<div class="outline-text-3" id="text-h:144436eb-e674-4052-ac0a-d582b6aa2f53">
<p>
In general, we provide the command <code>denote-link-with-signature</code> to let
the user pick a file that has a signature and link to it. The
description of such a link contains the signature text as well as the
file title. The <code>denote-link-with-signature</code> is distinct from the
standard <code>denote-link</code>, as it allows the user to express intent about
the inclusion of the signature.
</p>

<p>
In Org dynamic blocks for links/backlinks, we make this happen
automatically since there can be no manual intervention to express
intent on a link-by-link basis.
</p>
</div>
</div>
<div id="outline-container-h:46e08576-4c17-4b1e-a268-e0223250e7c1" class="outline-3">
<h3 id="h:46e08576-4c17-4b1e-a268-e0223250e7c1"><span class="section-number-3">6.9.</span> Fontification in Dired can now extend to subdirectories</h3>
<div class="outline-text-3" id="text-h:46e08576-4c17-4b1e-a268-e0223250e7c1">
<p>
The user option <code>denote-dired-directories</code> activates the
<code>denote-dired-mode</code> in the specified list of directories when the user
sets this in their init file:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(add-hook 'dired-mode-hook #'denote-dired-mode-in-directories)
</pre>
</div>

<p>
The new user option <code>denote-dired-directories-include-subdirectories</code>
extends the reach of this feature to all subdirectories thereof.
</p>

<p>
Thanks to Henrik Hörmann for discussing this with me and contributing
a patch. This was originally done in pull request 191 on the GitHub
mirror: <a href="https://github.com/protesilaos/denote/pull/191">https://github.com/protesilaos/denote/pull/191</a>. Subsequent
refinements by me.
</p>
</div>
</div>
<div id="outline-container-h:73e1efaa-2c22-48ee-be46-072b55177c99" class="outline-3">
<h3 id="h:73e1efaa-2c22-48ee-be46-072b55177c99"><span class="section-number-3">6.10.</span> Signatures are sluggified as intended</h3>
<div class="outline-text-3" id="text-h:73e1efaa-2c22-48ee-be46-072b55177c99">
<p>
The file name signature component is now sluggified properly. This
means that multiple words are separated by the equals sign, in
accordance with the Denote file-naming scheme where a word separator
is the same as the given field separator (this is the low-tech feature
that makes Denote files so easy to retrieve without fancy extras).
</p>

<p>
Vedang Manerikar fixed two relevant bugs in the &ldquo;rename&rdquo; commands,
while I rewrote internal functions and tests in the interest of consistency. Vedang&rsquo;s patches: <a href="https://lists.sr.ht/~protesilaos/denote/patches/46790">https://lists.sr.ht/~protesilaos/denote/patches/46790</a>.
</p>

<p>
[ The &ldquo;signature&rdquo; is a free form component of the file name. Users can
  add anything they want there, such as to use it as a &ldquo;category&rdquo; that
  is different from &ldquo;tags/keywords&rdquo;, or to introduce sequences in
  their notes, or to just have an extra marker for files they need to
  spot quickly. ]
</p>
</div>
</div>
<div id="outline-container-h:79f2fd7e-d5a7-4c78-bce7-f8d21e86e32c" class="outline-3">
<h3 id="h:79f2fd7e-d5a7-4c78-bce7-f8d21e86e32c"><span class="section-number-3">6.11.</span> For developers</h3>
<div class="outline-text-3" id="text-h:79f2fd7e-d5a7-4c78-bce7-f8d21e86e32c">
<p>
There is a section in the manual titled &ldquo;For developers or advanced
users&rdquo;. There we document functions or variables that are
public-facing, meaning that we test and document their behaviour and
encourage others to use them for code they write on top of Denote.
Refer to this section if you are looking to extend Denote. Though you
can also just check the source code, which is designed to be readable
and hackable.
</p>

<ul class="org-ul">
<li>The <code>denote-directory-files</code> function gains new functionality that
subsumes that of the now-deprecated functions
<code>denote-directory-files-matching-regexp</code>, <code>denote-all-files</code>,
<code>denote-directory-text-only-files</code>. Thanks to Jean-Philippe Gagné
Guay for the contribution, which was done in pull request 195 on the
GitHub mirror: <a href="https://github.com/protesilaos/denote/pull/195">https://github.com/protesilaos/denote/pull/195</a>.</li>

<li>The font-lock keywords we define are consolidated into a single
variable: <code>denote-faces-file-name-keywords</code> instead of being split
into two variables. This means that we cover all our fontification
needs in the backlinks buffer as well as the <code>denote-dired-mode</code>
with this one point of entry. It also works for <code>denote-sort-dired</code>,
which can include files with their subdirectory component in the
same flat listing.</li>

<li>Use the function <code>denote-retrieve-filename-keywords</code> to extract
keywords from the file name alone, without going into the file
contents.</li>

<li>The <code>denote-retrieve-filename-title</code> function now returns an empty
string if no title is present. Its behaviour is thus consistent with
<code>denote-retrieve-filename-keywords</code> and <code>denote-retrieve-filename-signature</code>.</li>

<li>The <code>denote-retrieve-filename-title</code> will now use the
<code>file-name-base</code> function as a fallback subject to a non-nil
optional argument. This case come into effect when the file does not
have a title component. The new optional argument allows the caller
to handle such cases as they see fit.</li>

<li>The <code>denote-signature-prompt</code> and <code>denote-title-prompt</code> functions
accept an optional <code>DEFAULT-SIGNATURE</code> or <code>DEFAULT-TITLE</code> argument.
Internally, this is used as the <code>INITIAL-INPUT</code> of <code>completing-read</code>
instead of the <code>DEF</code> argument. This matters because we want the
prompt to return an empty string if there is no input, whereas the
presence of <code>DEF</code> means that <code>DEF</code> is returned when the prompt is
empty.</li>

<li>All our functions that interactively match file names with a regular
expression now use the <code>denote-files-matching-regexp-prompt</code>
function. When called from Lisp, it takes a <code>REGEXP</code> argument as
well as an optional <code>PROMPT-TEXT</code>.</li>
</ul>

<p>
For the purposes of this release cycle, I am not documenting the
points of entry provided by <code>denote-sort.el</code>. It is a new feature that
I may eventually incorporate in <code>denote.el</code>. If you are interested in
the functionality (e.g. to have more elaborate sorting algorithms),
please take a look at the source code and then let us discuss the
implementation details.
</p>
</div>
</div>
<div id="outline-container-h:ce5c7865-9ec1-49ba-9388-5a251ab56735" class="outline-3">
<h3 id="h:ce5c7865-9ec1-49ba-9388-5a251ab56735"><span class="section-number-3">6.12.</span> Miscellaneous</h3>
<div class="outline-text-3" id="text-h:ce5c7865-9ec1-49ba-9388-5a251ab56735">
<ul class="org-ul">
<li>Rewrote the manual on the topic of Org dynamic blocks. Same idea for
practically the entirety of <code>denote-org-dblock.el</code>.</li>

<li>Marked the interactive specification of a few commands with the
major mode they belong to. This means that <code>M-X</code> (note the capital
X), which calls <code>execute-extended-command-for-buffer</code> by default,
will only show those commands in the relevant context.</li>

<li>Made internal refinements and simplified the implementation of a few
functions. This is important work to keep the code base clean and
easy to read/maintain. Thanks to Jean-Philippe Gagné Guay for the
contribution. It was done in pull request 193 on the GitHub mirror:
<a href="https://github.com/protesilaos/denote/pull/193">https://github.com/protesilaos/denote/pull/193</a>.</li>

<li>Improved the doc string of the <code>denote-format-file-name</code> function.
Also introduced a unit test for it to be sure it does what we expect
(I eventually want to have tests for everything we do, but this is a
long-term project).</li>
</ul>
</div>
</div>
<div id="outline-container-h:6830d3f3-130c-4346-b3ca-a3d4b0e9f974" class="outline-3">
<h3 id="h:6830d3f3-130c-4346-b3ca-a3d4b0e9f974"><span class="section-number-3">6.13.</span> Git commits</h3>
<div class="outline-text-3" id="text-h:6830d3f3-130c-4346-b3ca-a3d4b0e9f974">
<p>
Just an overview of what we did. Thanks again to everyone involved.
</p>

<div class="org-src-container">
<pre class="src src-sh">~/Git/Projects/denote $ git shortlog 2.1.0..2.2.0 --summary --numbered
   125	Protesilaos Stavrou
    17	Jean-Philippe Gagné Guay
     2	Vedang Manerikar
     1	Henrik Hörmann
</pre>
</div>
</div>
</div>
<div id="outline-container-h:cb0cae4f-c9a1-40b3-98ae-781a57270d4e" class="outline-3">
<h3 id="h:cb0cae4f-c9a1-40b3-98ae-781a57270d4e"><span class="section-number-3">6.14.</span> Policy for the next development cycle</h3>
<div class="outline-text-3" id="text-h:cb0cae4f-c9a1-40b3-98ae-781a57270d4e">
<p>
I will give a ~1 week pause on Denote development before making any
feature changes. This is to ensure that we catch possible bugs and
push fixes right away. If there are other changes in place, it is not
possible to make point updates of this sort, as we must first wait for
the new features to be tested in real-world scenaria.
</p>
</div>
</div>
</div>
<div id="outline-container-h:167beb8f-14be-40de-a1f2-d13910924c00" class="outline-2">
<h2 id="h:167beb8f-14be-40de-a1f2-d13910924c00"><span class="section-number-2">7.</span> Version 2.1.0 on 2023-11-12</h2>
<div class="outline-text-2" id="text-h:167beb8f-14be-40de-a1f2-d13910924c00">
<p>
The general theme of this release is improvements to the quality of
life with Denote. While these release notes and the overall
documentation are comprehensive, make no mistake: Denote can be used
with <code>M-x denote</code>, <code>M-x denote-link</code>, <code>M-x denote-backlinks</code>, <code>M-x
denote-rename-file</code>. These have been rock solid from the beginning.
Everything else is for more specialised workflows.
</p>

<p>
I hope to produce a companion video to this changelog in the coming
days. Though I am still reeling from the injury to my left hand (I
wrote all this to not delay the package any longer). Please check back
in my website&rsquo;s coding blog section to find the follow-up video:
<a href="https://protesilaos.com/codelog">https://protesilaos.com/codelog</a>.
</p>

<p>
[ Remember to consult the manual whenever you have a question about
  Denote. It is comprehensive and, in my opinion, a paradigm of how
  free software should be done for the benefit of users. I document
  everything in detail and am eager to continue this way. If something
  is unclear, contact me in person, use the mailing list, or open an
  issue on the GitHub/GitLab mirror. I do not check other fora or
  media and will thus not help you there. If you are writing custom
  code, remember to read the doc strings. I write them for you too. ]
</p>
</div>
<div id="outline-container-h:a086d1d2-adb3-4151-a7af-813d79b4b3dc" class="outline-3">
<h3 id="h:a086d1d2-adb3-4151-a7af-813d79b4b3dc"><span class="section-number-3">7.1.</span> Deprecated the <code>denote-allow-multi-word-keywords</code></h3>
<div class="outline-text-3" id="text-h:a086d1d2-adb3-4151-a7af-813d79b4b3dc">
<p>
This user option enabled the use of keywords that consisted of
multiple words. Those would be separated by hyphens. Such keywords do
not work as Org <code>#+filetags</code> and also mess up with the neat search
semantics of Denote&rsquo;s file-naming scheme where a hyphen prefix
anchors the query to the <code>TITLE</code> component of the name.
</p>

<p>
Users who absolutely need multi-word keywords are encouraged to use
the new <code>denote-file-name-letter-casing</code> option. More below.
</p>
</div>
</div>
<div id="outline-container-h:29319b8a-698b-4a1c-bab4-7b106a623de8" class="outline-3">
<h3 id="h:29319b8a-698b-4a1c-bab4-7b106a623de8"><span class="section-number-3">7.2.</span> Control the letter casing of file name components</h3>
<div class="outline-text-3" id="text-h:29319b8a-698b-4a1c-bab4-7b106a623de8">
<p>
By default, Denote downcases all components of the file name. The user
option <code>denote-file-name-letter-casing</code> provides granular control over
this behaviour.
</p>

<p>
The value it accepts is an alist where each element is a cons cell of
the form <code>(COMPONENT . METHOD)</code>. The manual, or the variable&rsquo;s doc
string, cover the details. The gist is that we can now instruct Denote
to accept input verbatim, such as because we want to apply a
<code>camelCase</code> convention or variants thereof.
</p>

<p>
Here is an example, where we downcase the title, but preserve the
letter casing of the signature and keyword components with this:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(setq denote-file-name-letter-casing
      '((title . downcase)
        (signature . verbatim)
        (keywords . verbatim)
        (t . downcase)))
</pre>
</div>

<p>
Users of the now-deprecated <code>denote-allow-multi-word-keywords</code> are
encouraged to implement a letter casing convention with the help of
this new user option.
</p>

<p>
Relevant sections in the manual:
</p>

<ul class="org-ul">
<li>The file-naming scheme:
<a href="https://protesilaos.com/emacs/denote#h:4e9c7512-84dc-4dfb-9fa9-e15d51178e5d">https://protesilaos.com/emacs/denote#h:4e9c7512-84dc-4dfb-9fa9-e15d51178e5d</a>.</li>
<li>Contol the letter casing of file names:
<a href="https://protesilaos.com/emacs/denote#h:6ae1ab8c-5e36-4216-8e93-f37f4447582c">https://protesilaos.com/emacs/denote#h:6ae1ab8c-5e36-4216-8e93-f37f4447582c</a></li>
</ul>
</div>
</div>
<div id="outline-container-h:18a3b515-9306-4911-ba2d-73e36efbdd32" class="outline-3">
<h3 id="h:18a3b515-9306-4911-ba2d-73e36efbdd32"><span class="section-number-3">7.3.</span> The <code>denote-dired-mode</code> should now work while toggling <code>wdired</code></h3>
<div class="outline-text-3" id="text-h:18a3b515-9306-4911-ba2d-73e36efbdd32">
<p>
The writable version of Dired would break the colouration applied by
<code>denote-dired-mode</code>. I have arranged for this to not happen anymore,
although it means that I had to add an advice to relevant wdired
symbols because no proper hook is on offer.
</p>
</div>
</div>
<div id="outline-container-h:5bcdc4b8-ecba-44d7-accc-0b26657aa29b" class="outline-3">
<h3 id="h:5bcdc4b8-ecba-44d7-accc-0b26657aa29b"><span class="section-number-3">7.4.</span> The &ldquo;do or create&rdquo; commands are more intuitive to use</h3>
<div class="outline-text-3" id="text-h:5bcdc4b8-ecba-44d7-accc-0b26657aa29b">
<p>
Denote provides several commands with a &ldquo;do or create&rdquo; logic. For
example, the <code>denote-open-or-create</code> prompts for a file to visit: if
something matches the user&rsquo;s input, it is visited in a buffer,
otherwise a new note is created with the given input. Same for
<code>denote-link-or-create</code>, mutatis mutandis.
</p>

<p>
Before, the &ldquo;&#x2026; or create&rdquo; step did not make it obvious how the
previous search terms could be reused. Whereas now those are set as
the default minibuffer value at the title prompt, meaning that typing
<code>RET</code> at the empty prompt will use that value, while <code>M-n</code>
(<code>next-history-element</code> with default settings) will put the text into
the prompt for further editing.
</p>

<p>
I will answer this because I get asked about it: we still refrain from
creating the new note outright because the search terms are not
necessarily suitable for a new title. Remember that Denote&rsquo;s file name
is optimised for searching: <code>-word</code> is specific to the title, <code>_word</code>
to the keywords, and <code>=word</code> to the signature. Combine this with the
<code>orderless</code> package and you frequently type something like <code>_jou -he</code>
to match a file with the <code>journal</code> keyword and the word <code>hesitation</code>
in its title.
</p>

<p>
<b>IMPORTANT NOTE:</b> some minibuffer completion User Interfaces preselect
the first completion candidate, which is not always the same as the
default value. Check with your UI of choice how to pass a default
value and/or provide an empty input. For example, with the <code>vertico</code>
package one can move up from the first candidate to select the prompt
itself (the counter switches from <code>1/N</code> to <code>*/N</code>).
</p>

<p>
Relevant sections in the manual:
</p>

<ul class="org-ul">
<li>Open an existing note or create it if missing:
<a href="https://protesilaos.com/emacs/denote#h:ad91ca39-cf10-4e16-b224-fdf78f093883">https://protesilaos.com/emacs/denote#h:ad91ca39-cf10-4e16-b224-fdf78f093883</a>.</li>
<li>Link to a note or create it if missing:
<a href="https://protesilaos.com/emacs/denote#h:9e41e7df-2aac-4835-94c5-659b6111e6de">https://protesilaos.com/emacs/denote#h:9e41e7df-2aac-4835-94c5-659b6111e6de</a>.</li>
</ul>
</div>
<div id="outline-container-h:6f475151-9d64-4dfb-8c59-694c93d56ce8" class="outline-4">
<h4 id="h:6f475151-9d64-4dfb-8c59-694c93d56ce8"><span class="section-number-4">7.4.1.</span> New &ldquo;&#x2026; or create with command&rdquo; features for more flexibility</h4>
<div class="outline-text-4" id="text-h:6f475151-9d64-4dfb-8c59-694c93d56ce8">
<p>
As part of the wider &ldquo;do or create&rdquo; feature set, Denote provides the
option to run a specific note-creating command instead of just using
the standard <code>denote</code> one. For example, it is possible to call the
<code>denote-subdirectory</code> command to pick a subdirectory of the
<code>denote-directory</code> for the new note. Commands providing this facility
are <code>denote-open-or-create-with-command</code> and <code>denote-link-after-creating-with-command</code>.
</p>

<p>
Thanks to Vedang Manerikar for fixing a broken <code>if</code> clause during
development: <a href="https://lists.sr.ht/~protesilaos/denote/patches/46087">https://lists.sr.ht/~protesilaos/denote/patches/46087</a>.
</p>
</div>
</div>
</div>
<div id="outline-container-h:429847c8-ebf4-4b23-a597-5276309ef61a" class="outline-3">
<h3 id="h:429847c8-ebf4-4b23-a597-5276309ef61a"><span class="section-number-3">7.5.</span> The title and signature prompts use minibuffer completion</h3>
<div class="outline-text-3" id="text-h:429847c8-ebf4-4b23-a597-5276309ef61a">
<p>
All Denote minibuffer prompts come with their own history. This means
that <code>M-p</code> (<code>previous-history-element</code>) and <code>M-n</code>
(<code>next-history-element</code>) always return relevant input.
</p>

<p>
The title and signature prompts now reuse their input history to
provide completion. This means that the user can quickly access
previous inputs, either to pass them directly or edit them further
before inputting them.
</p>

<p>
[ Use the built-in <code>savehist-mode</code> to persist histories across sessions. ]
</p>

<p>
Remember to check with your minibuffer UI on how to input empty
values at the prompt, should you ever need to do so.
</p>

<p>
For posterity, I first implemented this in commit <code>0d855bb</code>. However,
it did not work with the default minibuffer because the <code>SPC</code> key
performs completion (popping up the Completions buffer). So users
could not easily input an arbitrary string for the title/signature. I
thus reverted that commit in <code>9f692cb</code>.
</p>

<p>
[ The bug was reported by Suhail Singh on the mailing list:
  <a href="https://lists.sr.ht/~protesilaos/denote/%3C652d82c0.c80a0220.e6282.dc47%40mx.google.com%3E#%3C65392fa6.050a0220.da61c.0ac8@mx.google.com%3E">https://lists.sr.ht/~protesilaos/denote/%3C652d82c0.c80a0220.e6282.dc47%40mx.google.com%3E#%3C65392fa6.050a0220.da61c.0ac8@mx.google.com%3E</a>. ]
</p>

<p>
Stefan Monnier suggested the use of the <code>minibuffer-with-setup-hook</code>,
which lets us disable <code>SPC</code> completion for the purposes of these
functions. This is most welcome as the functionality is nice to have.
Stefan&rsquo;s feedback was provided on the emacs-devel mailing list:
<a href="https://lists.gnu.org/archive/html/emacs-devel/2023-10/msg00631.html">https://lists.gnu.org/archive/html/emacs-devel/2023-10/msg00631.html</a>.
</p>
</div>
</div>
<div id="outline-container-h:ae798d1f-6fa2-4d99-91c9-0d5eb18b1bb0" class="outline-3">
<h3 id="h:ae798d1f-6fa2-4d99-91c9-0d5eb18b1bb0"><span class="section-number-3">7.6.</span> Create a note with the region&rsquo;s contents</h3>
<div class="outline-text-3" id="text-h:ae798d1f-6fa2-4d99-91c9-0d5eb18b1bb0">
<p>
The command <code>denote-region</code> takes the contents of the active region
and then prompts for a title and keywords.  Once a new note is
created, it inserts the contents of the region therein.  This is
useful to quickly elaborate on some snippet of text or capture it for
future reference.
</p>

<p>
It also provides the <code>denote-region-after-new-note-functions</code> abnormal
hook. Read the manual for more:
<a href="https://protesilaos.com/emacs/denote#h:2f8090f1-50af-4965-9771-d5a91a0a87bd">https://protesilaos.com/emacs/denote#h:2f8090f1-50af-4965-9771-d5a91a0a87bd</a>.
</p>
</div>
</div>
<div id="outline-container-h:91b3ba9f-8b10-4f1c-a08b-70f5e7140923" class="outline-3">
<h3 id="h:91b3ba9f-8b10-4f1c-a08b-70f5e7140923"><span class="section-number-3">7.7.</span> Comprehensive refinements to the <code>denote-rename-buffer-mode</code></h3>
<div class="outline-text-3" id="text-h:91b3ba9f-8b10-4f1c-a08b-70f5e7140923">
<p>
This is an opt-in feature that automatically renames the buffer of
newly visited Denote files according to the user&rsquo;s preferences. Not to
be confused with renaming files: buffers are internal to Emacs. Enable
it at startup by adding this to your configuration file:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(denote-rename-buffer-mode 1)
</pre>
</div>

<p>
Relevant entries in the manual:
</p>

<ul class="org-ul">
<li>Automatically rename Denote buffers:
<a href="https://protesilaos.com/emacs/denote#h:3ca4db16-8f26-4d7d-b748-bac48ae32d69">https://protesilaos.com/emacs/denote#h:3ca4db16-8f26-4d7d-b748-bac48ae32d69</a>.</li>
<li>The <code>denote-rename-buffer-format</code> option:
<a href="https://protesilaos.com/emacs/denote#h:35507c18-35b1-41b9-9d80-52f54fcef3cb">https://protesilaos.com/emacs/denote#h:35507c18-35b1-41b9-9d80-52f54fcef3cb</a>.</li>
</ul>
</div>
<div id="outline-container-h:beeafe57-f110-4c11-87e7-10f682ca2386" class="outline-4">
<h4 id="h:beeafe57-f110-4c11-87e7-10f682ca2386"><span class="section-number-4">7.7.1.</span> The <code>denote-rename-buffer-format</code> option</h4>
<div class="outline-text-4" id="text-h:beeafe57-f110-4c11-87e7-10f682ca2386">
<p>
The user option <code>denote-rename-buffer-format</code> controls how the
function <code>denote-rename-buffer</code> chooses the name of the
buffer-to-be-renamed. This function is the one used by the
<code>denote-rename-buffer-mode</code>.
</p>

<p>
Users may want, for example, to include some text that makes Denote
buffers stand out, such as a <code>[D]</code> prefix. Examples:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">;; Use the title (default)
(setq denote-rename-buffer-format "%t")

;; Use the title and keywords with some emoji in between.
(setq denote-rename-buffer-format "%t 🤨 %k")

;; Use the title with a literal "[D]" before it
(setq denote-rename-buffer-format "[D] %t")
</pre>
</div>

<p>
Users who need yet more flexibility are best served by writing their
own function and assigning it to the <code>denote-rename-buffer-function</code>
(in such a case, please contact me as I am curious to know what the
underlying need is).
</p>

<p>
The manual or doc string of <code>denote-rename-buffer-format</code> cover the
technicalities of the available format specifiers.
</p>

<p>
Thanks to Jean-Philippe Gagné Guay for intermediately refining parts
of the code. This was done in pull request 177 on the GitHub mirror:
<a href="https://github.com/protesilaos/denote/pull/177">https://github.com/protesilaos/denote/pull/177</a>.
</p>

<p>
Thanks to Vedang Manerikar for ensuring that the string of the buffer
is trimmed so that it never starts with an empty space (those buffers
count as &ldquo;internal&rdquo; to Emacs and are not shown to the user):
<a href="https://lists.sr.ht/~protesilaos/denote/patches/46243">https://lists.sr.ht/~protesilaos/denote/patches/46243</a>.
</p>
</div>
</div>
<div id="outline-container-h:e65bb546-af22-45fb-a918-d0e621b0e415" class="outline-4">
<h4 id="h:e65bb546-af22-45fb-a918-d0e621b0e415"><span class="section-number-4">7.7.2.</span> The <code>denote-rename-buffer-mode</code> also works with unsaved buffers</h4>
<div class="outline-text-4" id="text-h:e65bb546-af22-45fb-a918-d0e621b0e415">
<p>
Internal refinements to a Denote Lisp macro make this minor mode also
work with new and unsaved Denote buffers. Whereas before only the
buffers of existing files would be renamed.
</p>
</div>
</div>
</div>
<div id="outline-container-h:703b9021-f917-4b3f-9406-14992b2a4fe8" class="outline-3">
<h3 id="h:703b9021-f917-4b3f-9406-14992b2a4fe8"><span class="section-number-3">7.8.</span> Denote&rsquo;s renaming facilities are better than ever</h3>
<div class="outline-text-3" id="text-h:703b9021-f917-4b3f-9406-14992b2a4fe8">
<p>
Denote&rsquo;s value proposition is its efficient file-naming scheme that
makes it easier to retrieve files even with rudimentary search tools.
We provide several commands to rename existing files according to this
scheme. The underlying file type does not matter (e.g. I use Denote to
name my video files).
</p>

<p>
Relevant sections in the manual:
</p>

<ul class="org-ul">
<li>Renaming files:
<a href="https://protesilaos.com/emacs/denote#h:532e8e2a-9b7d-41c0-8f4b-3c5cbb7d4dca">https://protesilaos.com/emacs/denote#h:532e8e2a-9b7d-41c0-8f4b-3c5cbb7d4dca</a>.</li>
<li>Front matter:
<a href="https://protesilaos.com/emacs/denote#h:13218826-56a5-482a-9b91-5b6de4f14261">https://protesilaos.com/emacs/denote#h:13218826-56a5-482a-9b91-5b6de4f14261</a>.</li>
</ul>
</div>
<div id="outline-container-h:8798dd8c-819d-4fda-9865-77d9734da28c" class="outline-4">
<h4 id="h:8798dd8c-819d-4fda-9865-77d9734da28c"><span class="section-number-4">7.8.1.</span> Rename like an expert with <code>denote-rename-no-confirm</code></h4>
<div class="outline-text-4" id="text-h:8798dd8c-819d-4fda-9865-77d9734da28c">
<p>
By default, the <code>denote-rename-file</code> command asks for a final
confirmation before carrying out its function. The new user option
<code>denote-rename-no-confirm</code> can be bound to a non-nil value to skip
that step.
</p>

<p>
This only applies to <code>denote-rename-file</code>. Other commands that rename
files in bulk never prompt for such confirmation (it would make them
cumbersome to use, plus it is assumed that the user who performs a
batch operation understands the implications).
</p>
</div>
</div>
<div id="outline-container-h:e4e7e3d8-40e3-4f58-a19f-df34ccbfdbbd" class="outline-4">
<h4 id="h:e4e7e3d8-40e3-4f58-a19f-df34ccbfdbbd"><span class="section-number-4">7.8.2.</span> The <code>denote-rename-file</code> command prompts for a signature</h4>
<div class="outline-text-4" id="text-h:e4e7e3d8-40e3-4f58-a19f-df34ccbfdbbd">
<p>
This command used to only ask for a title and keywords. Now it allows
to use a signature as well. An empty input means that the signature is
ignored. AGAIN, please check with your minibuffer completion UI on how
to input an empty value, otherwise you will not get what you expect.
</p>
</div>
</div>
<div id="outline-container-h:dcb623aa-fc4d-4d84-80e4-a540b6dbb144" class="outline-4">
<h4 id="h:dcb623aa-fc4d-4d84-80e4-a540b6dbb144"><span class="section-number-4">7.8.3.</span> Rename mutliple files sequentially with <code>denote-dired-rename-files</code></h4>
<div class="outline-text-4" id="text-h:dcb623aa-fc4d-4d84-80e4-a540b6dbb144">
<p>
This provides the same interface as <code>denote-rename-file</code>, only it
works over a list of marked Dired files.
</p>

<p>
Internally, the prompts for title, keywords, and signature are
improved to display the underlying file that is affected by the
current operation. As the user renames files, the prompts reflect
which one is current.
</p>
</div>
</div>
<div id="outline-container-h:f9a16fc1-840d-400f-a5ae-a7791fac441f" class="outline-4">
<h4 id="h:f9a16fc1-840d-400f-a5ae-a7791fac441f"><span class="section-number-4">7.8.4.</span> The name of <code>denote-dired-rename-marked-files</code> has changed</h4>
<div class="outline-text-4" id="text-h:f9a16fc1-840d-400f-a5ae-a7791fac441f">
<p>
It is now called <code>denote-dired-rename-marked-files-with-keywords</code> to
better communicate what it does. In short, this is a quick way to add
the given keywords to a list of files, converting them to the Denote
file-naming scheme in case they are not already using it. For the full
interactive power, use the aforementioned <code>denote-dired-rename-files</code>.
</p>
</div>
</div>
<div id="outline-container-h:bfc194c2-5980-482a-aa1c-feb4ced992d1" class="outline-4">
<h4 id="h:bfc194c2-5980-482a-aa1c-feb4ced992d1"><span class="section-number-4">7.8.5.</span> The <code>denote-rename-file-using-front-matter</code> can be used without saving its buffer</h4>
<div class="outline-text-4" id="text-h:bfc194c2-5980-482a-aa1c-feb4ced992d1">
<p>
This is now possible because of changes to underlying functions (a
Denote Lisp macro&#x2014;not to bother you with technicalities).
</p>

<p>
Same principle for <code>denote-rename-file-using-front-matter</code>.
</p>
</div>
</div>
<div id="outline-container-h:3bf4b6c4-8399-4d5d-8df1-6495f5bfc579" class="outline-4">
<h4 id="h:3bf4b6c4-8399-4d5d-8df1-6495f5bfc579"><span class="section-number-4">7.8.6.</span> The name of <code>denote-change-file-type</code> has changed</h4>
<div class="outline-text-4" id="text-h:3bf4b6c4-8399-4d5d-8df1-6495f5bfc579">
<p>
It is now called <code>denote-change-file-type-and-front-matter</code> to avoid
confusion as to whether Denote converts files from one format to
another (there are specialised tools for that).
</p>
</div>
</div>
<div id="outline-container-h:1d7bffd1-e422-420d-b453-9a36dd8508f7" class="outline-4">
<h4 id="h:1d7bffd1-e422-420d-b453-9a36dd8508f7"><span class="section-number-4">7.8.7.</span> Renaming a file returns the new file path for programmatic use</h4>
<div class="outline-text-4" id="text-h:1d7bffd1-e422-420d-b453-9a36dd8508f7">
<p>
Thanks to mentalisttraceur for requesting this feature in issue 183 on
the GitHub mirror: <a href="https://github.com/protesilaos/denote/issues/183">https://github.com/protesilaos/denote/issues/183</a>.
</p>
</div>
</div>
</div>
<div id="outline-container-h:b154ef64-c3b4-4e15-b533-c59d5b2ebf6b" class="outline-3">
<h3 id="h:b154ef64-c3b4-4e15-b533-c59d5b2ebf6b"><span class="section-number-3">7.9.</span> Link to a file with a signature</h3>
<div class="outline-text-3" id="text-h:b154ef64-c3b4-4e15-b533-c59d5b2ebf6b">
<p>
The <code>denote-link-with-signature</code> command prompts for a file that has a
<code>SIGNATURE</code> component and links to it. The link&rsquo;s description includes
the text of the signature as well as the title.
</p>

<p>
Thanks to Mark Olson for mentioning this idea. It was done in issue
167 on the GitHub mirror: <a href="https://github.com/protesilaos/denote/issues/167">https://github.com/protesilaos/denote/issues/167</a>.
</p>

<p>
I implemented it live, while also refactoring relevant parts of the
code to be more abstract/reusable:
<a href="https://protesilaos.com/codelog/2023-09-25-emacs-live-mostly-denote/">https://protesilaos.com/codelog/2023-09-25-emacs-live-mostly-denote/</a>.
</p>

<p>
Thanks to Alan Schmitt for spotting and fixing a regression caused by
the above:
<a href="https://lists.sr.ht/~protesilaos/denote/%3Cm2cyy5rt68.fsf%40mac-03220211.irisa.fr%3E">https://lists.sr.ht/~protesilaos/denote/%3Cm2cyy5rt68.fsf%40mac-03220211.irisa.fr%3E</a>.
</p>
</div>
</div>
<div id="outline-container-h:9ceaf432-797c-46e5-aaf8-d7180ad66689" class="outline-3">
<h3 id="h:9ceaf432-797c-46e5-aaf8-d7180ad66689"><span class="section-number-3">7.10.</span> Renaming GPG or Age encrypted file works as expected</h3>
<div class="outline-text-3" id="text-h:9ceaf432-797c-46e5-aaf8-d7180ad66689">
<p>
Emacs can seamlessly visit a <code>.gpg</code> or <code>.age</code> file. Denote has nothing
to do with encryption, though it takes care to recognise the
underlying file type and to perform its work accordingly. However,
prior versions of Denote contained a bug in how file extensions were
handled: it would keep the encryption extension but remove the file
type extension before it (so &ldquo;.org.gpg&rdquo; would wrongly become &ldquo;.gpg&rdquo;).
</p>

<p>
Thanks to Jens Östlund for reporting a bug with <code>denote-keywords-add</code>
on an encrypted file, which prompted me to investigate this further
and fix the issue holistically. This was done in issue 172 on the
GitHub mirror: <a href="https://github.com/protesilaos/denote/issues/172">https://github.com/protesilaos/denote/issues/172</a>.
</p>

<p>
Interested parties are advised to check the two new public functions,
<code>denote-get-file-extension</code> and <code>denote-get-file-extension-sans-encryption</code>,
for the implementation details. In short, we had a problem with all
operations that needed to retrieve the file extension when that
included an encryption component.
</p>
</div>
</div>
<div id="outline-container-h:54723661-31f8-4cab-9be5-4cab19e44dc7" class="outline-3">
<h3 id="h:54723661-31f8-4cab-9be5-4cab19e44dc7"><span class="section-number-3">7.11.</span> The optional <code>denote-journal-extras</code></h3>
<div class="outline-text-3" id="text-h:54723661-31f8-4cab-9be5-4cab19e44dc7">
<p>
The manual of Denote has long provided code samples to achieve
particularised results. Among those were snippets to streamline the
use of Denote for journaling.
</p>

<p>
To make things even easier for users, we now have the
<code>denote-journal-extras.el</code>. It consolidates the rich corpus of
documented snippets into an easy-to-use and formally maintained
package. Thanks to Vedang Manerikar for providing the impetus for this
process. This was done on the mailing list:
<a href="https://lists.sr.ht/~protesilaos/denote/patches/43255#%3C20230803170935.60833-2-ved.manerikar@gmail.com%3E">https://lists.sr.ht/~protesilaos/denote/patches/43255#%3C20230803170935.60833-2-ved.manerikar@gmail.com%3E</a>.
</p>

<p>
The new file is optional. It can be loaded thus:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(require 'denote-journal-extras)
</pre>
</div>

<p>
The main idea is to quickly create journal entries. Check the manual
for the details, including the commands to use and the variables to
configure: <a href="https://protesilaos.com/emacs/denote#h:4a6d92dd-19eb-4fcc-a7b5-05ce04da3a92">https://protesilaos.com/emacs/denote#h:4a6d92dd-19eb-4fcc-a7b5-05ce04da3a92</a>.
</p>

<p>
Thanks to Kostas Andreadis for working on a comment I had included in
a working state of the code about the inclusion of templates. Kostas
made it possible to use the Denote template prompt (per the
<code>denote-templates</code> user option) as part of the creation of a new
journal entry. This was done in pull request 173 on the GitHub mirror:
<a href="https://github.com/protesilaos/denote/pull/173">https://github.com/protesilaos/denote/pull/173</a>. The change is less
than 15 lines and thus Kostas does not need to assign copyright to the
Free Software Foundation.
</p>

<p>
Also thanks to TJ Stankus for reporting a case where
<code>denote-journal-extras-title-format</code> did not accept a <code>nil</code> value (as
it should). This was done in issue 176 on the GitHub mirror:
<a href="https://github.com/protesilaos/denote/issues/176">https://github.com/protesilaos/denote/issues/176</a>.
</p>
</div>
</div>
<div id="outline-container-h:618495d2-0c5b-48b4-af88-56f3d969697c" class="outline-3">
<h3 id="h:618495d2-0c5b-48b4-af88-56f3d969697c"><span class="section-number-3">7.12.</span> The optional <code>denote-silo-extras</code></h3>
<div class="outline-text-3" id="text-h:618495d2-0c5b-48b4-af88-56f3d969697c">
<p>
This is the same idea as with the <code>denote-journal-extras.el</code>: we had
the code in the manual and are now formally distributing it. Thanks
again to Vedang Manerikar for initiating this process. It was done on
the mailing list:
<a href="https://lists.sr.ht/~protesilaos/denote/patches/43255">https://lists.sr.ht/~protesilaos/denote/patches/43255</a>.
</p>

<p>
Use this optional feature with:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(require 'denote-silo-extras)
</pre>
</div>

<p>
Consult the manual for the details:
<a href="https://protesilaos.com/emacs/denote#h:e43baf95-f201-4fec-8620-c0eb5eaa1c85">https://protesilaos.com/emacs/denote#h:e43baf95-f201-4fec-8620-c0eb5eaa1c85</a>.
</p>
</div>
</div>
<div id="outline-container-h:1d538d7f-52e6-4653-b057-c62606752934" class="outline-3">
<h3 id="h:1d538d7f-52e6-4653-b057-c62606752934"><span class="section-number-3">7.13.</span> The infrastructure for unique identifiers is more robust</h3>
<div class="outline-text-3" id="text-h:1d538d7f-52e6-4653-b057-c62606752934">
<p>
For Denote version <code>2.0.0</code> I introduced a general scheme intended to
avoid scenaria where duplicate identifiers could be created (thus
breaking a premise of Denote). Jean-Philippe Gagné Guay iterated over
the code to make it more robust and to fix some of the cases I had not
accounted for. This was done in pull request 159 on the GitHub mirror:
<a href="https://github.com/protesilaos/denote/pull/159">https://github.com/protesilaos/denote/pull/159</a>. Same idea in pull
request 187: <a href="https://github.com/protesilaos/denote/pull/187">https://github.com/protesilaos/denote/pull/187</a>.
</p>
</div>
</div>
<div id="outline-container-h:9031dc82-ab75-438c-a2c8-a1250ae48671" class="outline-3">
<h3 id="h:9031dc82-ab75-438c-a2c8-a1250ae48671"><span class="section-number-3">7.14.</span> For developers or advanced users</h3>
<div class="outline-text-3" id="text-h:9031dc82-ab75-438c-a2c8-a1250ae48671">
<p>
Denote has a clean code base with small and composable functions. This
encourages hackability. Each definition in the source is documented,
while the manual provides an overview of every public symbol.
</p>

<dl class="org-dl">
<dt>Added</dt><dd><code>denote-get-file-extension</code>,
<code>denote-get-file-extension-sans-encryption</code>,
<code>denote-keywords-combine</code>,
<code>denote-retrieve-keywords-value-as-string</code>,
<code>denote-title-prompt-current-default</code>, <code>denote-command-prompt</code>.</dd>

<dt>Refactored</dt><dd><code>denote-all-files</code>, <code>denote-signature-prompt</code>,
<code>denote-file-prompt</code>, <code>denote-title-prompt</code>,
<code>denote-rewrite-front-matter</code>.</dd>
</dl>

<p>
Please read their documentation strings for the details. Or check the
manual: <a href="https://protesilaos.com/emacs/denote#h:c916d8c5-540a-409f-b780-6ccbd90e088e">https://protesilaos.com/emacs/denote#h:c916d8c5-540a-409f-b780-6ccbd90e088e</a>.
</p>
</div>
</div>
<div id="outline-container-h:759d0276-17e8-4461-9ee4-b4d07840dd7a" class="outline-3">
<h3 id="h:759d0276-17e8-4461-9ee4-b4d07840dd7a"><span class="section-number-3">7.15.</span> Check out the <code>denote-explore</code> package by Peter Prevos</h3>
<div class="outline-text-3" id="text-h:759d0276-17e8-4461-9ee4-b4d07840dd7a">
<p>
Peter posted this on the mailing list and I asked if it was okay to
mention it in the release notes of Denote. If you have a relevant
announcement to make, consider sending it to our mailing list.
</p>

<blockquote>
<p>
Hi folks,
</p>

<p>
I have just updated the denote-explore package:
<a href="https://github.com/pprevos/denote-explore">https://github.com/pprevos/denote-explore</a>
</p>

<p>
It does three things:
</p>

<ol class="org-ol">
<li>Summary statistics: Count and visualise keywords and note types</li>
<li>Random walks: Generate new ideas using serendipity</li>
<li>Network visualisation: Visualise your Denote network of links</li>
</ol>

<p>
It contains a rudimentary network visualisation function, relying
on the R language. I will need some D3.js expertise to improve the
visualisation.
</p>

<p>
There should be a way to generate the basic network structure just
using Elisp and feeding a JSON to D3.js.
</p>

<p>
Regards
</p>

<p>
P:)
</p>
</blockquote>
</div>
</div>
<div id="outline-container-h:01dc6bb0-53ac-43e1-b12e-484c99a6c2a7" class="outline-3">
<h3 id="h:01dc6bb0-53ac-43e1-b12e-484c99a6c2a7"><span class="section-number-3">7.16.</span> Miscellaneous</h3>
<div class="outline-text-3" id="text-h:01dc6bb0-53ac-43e1-b12e-484c99a6c2a7">
<ul class="org-ul">
<li>During this release cycle, I made lots of changes that in one way or
another related to the <code>denote-file-prompt</code>. It was relying on a
<code>project.el</code> mechanism that did not allow us to do everything we
needed. I have thus arranged for it to use the standard
<code>completing-read</code> mechanism. There are subtle differences in
behaviour, though the core idea is the same. This change fixes a few
not-so-obvious bugs. Interested parties are advised to refer to the
message in commit <code>50d1bbdf1e8ffe0f449f2f5da02f9b70322fff7d</code>.</li>

<li>All commands that use the <code>denote</code> function internally (i.e.
anything that creates a new note) call the
<code>denote-after-new-note-hook</code> as part of their work. This hook is
mostly intended for advanced users who want to do something after a
new note is produced.</li>

<li>The <code>menu-bar-mode</code> submenu of Denote is now positioned where it
should be after the &ldquo;Tools&rdquo;. Thanks to Noboru Ota for the patch:
<a href="https://lists.sr.ht/~protesilaos/denote/patches/44738">https://lists.sr.ht/~protesilaos/denote/patches/44738</a>.</li>

<li>The <code>menu-bar-mode</code> entry of Denote includes the new commands. This
is a nice way to discover more of what Denote can do.</li>

<li>The commands <code>denote-backlinks-prev</code> and <code>denote-backlinks-next</code> are
only meant to be used inside the Denote backlinks buffer. As such,
they now produce an error when called elsewhere (I wish I could hide
them from <code>M-x</code> altogether).</li>

<li>The <code>denote-extract-keywords-from-front-matter</code> always returns a
list, thus avoiding an erroneous case. Thanks to Vedang Manerikar
for fixing the bug: <a href="https://lists.sr.ht/~protesilaos/denote/patches/46420">https://lists.sr.ht/~protesilaos/denote/patches/46420</a>.</li>

<li><p>
The <code>T</code> in the Denote identifier component now has its own face:
<code>denote-faces-time-delimiter</code>. This is used by the backlinks buffer
and the <code>denote-dired-mode</code>. The idea is to introduce a subtle
distinction between the date and time constituents of the
identifier. Those who want the <code>T</code> to be the same colour as the rest
of the identifier, can make the <code>denote-faces-time-delimiter</code>
inherit the <code>denote-faces-date</code>. For example:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (set-face-attribute 'denote-faces-time-delimiter nil :inherit 'denote-faces-date)
</pre>
</div>

<p>
Thanks to Jean-Charles Bagneris for sending this patch:
<a href="https://lists.sr.ht/~protesilaos/denote/patches/43072">https://lists.sr.ht/~protesilaos/denote/patches/43072</a>.
</p></li>

<li>Fixed a <code>nil</code> file expansion in the function
<code>denote--extract-title-from-file-history</code>. Thanks to ezchi for
bringing this matter to my attention. It was done in issue 166 on
the GitHub mirror:
<a href="https://github.com/protesilaos/denote/issues/166">https://github.com/protesilaos/denote/issues/166</a>.</li>

<li>A link can be created from inside an <code>org-capture</code> buffer. This
means that we can call <code>denote-link</code> (and related) while capturing a
new note with <code>org-capture</code>. Thanks to Peter Smith for reporting the
bug in issue 186 on the GitHub mirror:
<a href="https://github.com/protesilaos/denote/issues/186">https://github.com/protesilaos/denote/issues/186</a>.</li>

<li>We stopped using <code>vc-rename-file</code> to rename files. The reason is
that it requires the buffer to be saved, but we do not want that
after modifying the front matter because we want to give the user a
chance to confirm what happened. Thanks to Frédéric Willem for
reporting the problem in issue 185 on the GitHub mirror:
<a href="https://github.com/protesilaos/denote/issues/185">https://github.com/protesilaos/denote/issues/185</a>.</li>

<li>Thanks to Ivan Sokolov for removing a double negative logic in a
snippet. This was done in pull request 162 on the GitHub mirror:
<a href="https://github.com/protesilaos/denote/pull/162">https://github.com/protesilaos/denote/pull/162</a>.</li>
</ul>
</div>
</div>
<div id="outline-container-h:d8f30943-70dd-45fe-8cf1-4c3918152aeb" class="outline-3">
<h3 id="h:d8f30943-70dd-45fe-8cf1-4c3918152aeb"><span class="section-number-3">7.17.</span> Git commits</h3>
<div class="outline-text-3" id="text-h:d8f30943-70dd-45fe-8cf1-4c3918152aeb">
<p>
Just an overview of what we did. Every contribution matters.
</p>

<div class="org-src-container">
<pre class="src src-nil">~/Git/Projects/denote $ git shortlog 2.0.0..2.1.0 --summary --numbered
   153	Protesilaos Stavrou
    15	Jean-Philippe Gagné Guay
     5	Vedang Manerikar
     1	Alan Schmitt
     1	Ivan Sokolov
     1	Jean-Charles Bagneris
     1	Kostas Andreadis
     1	Noboru Ota
     1	Peter Prevos
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:3f17bf03-4c47-4410-abf8-1db4a0ac7775" class="outline-2">
<h2 id="h:3f17bf03-4c47-4410-abf8-1db4a0ac7775"><span class="section-number-2">8.</span> Version 2.0.0 on 2023-07-21</h2>
<div class="outline-text-2" id="text-h:3f17bf03-4c47-4410-abf8-1db4a0ac7775">
<p>
This is the second major version of Denote, close to one year after
its initial release.  The video demo I did back then remains relevant,
even though lots of details have changed.
</p>
</div>
<div id="outline-container-h:a3a9e14d-4132-47c0-a23c-cb008a141668" class="outline-3">
<h3 id="h:a3a9e14d-4132-47c0-a23c-cb008a141668"><span class="section-number-3">8.1.</span> Notes have a new optional SIGNATURE field</h3>
<div class="outline-text-3" id="text-h:a3a9e14d-4132-47c0-a23c-cb008a141668">
<p>
It is now possible to create notes that include a <code>SIGNATURE</code> field in
their file name.  Either use the convenience command <code>denote-signature</code>
or configure the user option <code>denote-prompts</code> to affect what the <code>denote</code>
command should prompt for.
</p>

<p>
Signatures are arbitrary strings of characters that enable the user to
further qualify their documents.  One possible workflow is to write
relational notes, such that <code>1a1</code> is the first extension of another
note with a <code>1a</code> signature.
</p>

<p>
The design of the <code>SIGNATURE</code> field is consistent with the Denote
file-naming scheme.  The field separator is the double equals sign
(<code>==</code>), while words that comprise the signature are joined together by
a single equals sign.  As such, the user can prefix a search with an
equals sign to match words in the <code>SIGNATURE</code>, just as they would use
dashes for the <code>TITLE</code> and underscores for the <code>KEYWORDS</code>.
</p>

<p>
[ Read the manual for the technicalities of the Denote file-naming
  scheme.  This is not limited to &ldquo;notes&rdquo;: any file can be named
  accordingly (I do it with my videos, for example). ]
</p>

<p>
Signatures are not included in a file&rsquo;s front matter.  This is a
strategic decision to preserve backward compatibility, while not
introducing a feature that has not enjoyed widespread usage.  I want
to make signatures behave the same as the rest of the file name
fields, though I am interested to learn how users employ them in their
workflow.
</p>

<p>
The signature extension was discussed at length on the GitHub mirror
in issue 115: <a href="https://github.com/protesilaos/denote/issues/115">https://github.com/protesilaos/denote/issues/115</a>.
Thanks to Stefan Thesing, Mirko Hernandez, Noboru Ota (nobiot),
Xiaoxing Hu, nbehrnd, Elias Storms, and 101scholar for helping me
reason about this feature, understand its scope, and prototype its
implementation.
</p>

<p>
Also thanks to Alfredo Borrás and Jeremy Friesen for discussing with
me the field delimiter of signatures on the mailing list:
<a href="https://lists.sr.ht/~protesilaos/denote/%3C2A597B4E-5F18-4D97-9457-B3C859DAA020%40zoho.eu%3E">https://lists.sr.ht/~protesilaos/denote/%3C2A597B4E-5F18-4D97-9457-B3C859DAA020%40zoho.eu%3E</a>.
Thanks to Kai von Fintel for doing the same on the GitHub mirror in
issue 147: <a href="https://github.com/protesilaos/denote/issues/147">https://github.com/protesilaos/denote/issues/147</a>.
</p>

<p>
Read the original announcement:
<a href="https://protesilaos.com/codelog/2023-03-20-emacs-denote-signature-feature/">https://protesilaos.com/codelog/2023-03-20-emacs-denote-signature-feature/</a>.
</p>

<p>
As part of the development, I fixed a case where
<code>denote-rename-file-using-front-matter</code> would fail if it could not
find a signature
</p>

<p>
The idea is that we want the command to behave the way it always did
when the file has no signature and to preserve the signature when it
is present.
</p>

<p>
Thanks to relict for reporting the issue on the mailing list:
<a href="https://lists.sr.ht/~protesilaos/denote/%3C87zg86lru9.fsf%40kotlak.com%3E">https://lists.sr.ht/~protesilaos/denote/%3C87zg86lru9.fsf%40kotlak.com%3E</a>.
</p>
</div>
</div>
<div id="outline-container-h:d24645a3-ad02-450c-b3d7-af7802aa0b26" class="outline-3">
<h3 id="h:d24645a3-ad02-450c-b3d7-af7802aa0b26"><span class="section-number-3">8.2.</span> The rename commands avoid creating duplicate identifiers</h3>
<div class="outline-text-3" id="text-h:d24645a3-ad02-450c-b3d7-af7802aa0b26">
<p>
Denote provides commands to rename an existing file to one that
follows the Denote file-naming scheme (videos, PDFs, other text
documents, &#x2026;).  Check, for example, the <code>denote-rename-file</code> and
<code>denote-dired-rename-marked-files</code>.  The idea is to make everything
easier to search.
</p>

<p>
In prior versions, these commands could produce duplicate identifiers
if the modification date of the underlying files was the same.  Such a
scenario occurs when the files are modified programmatically, as with
the <code>touch</code> command or the various <code>git</code> operations.
</p>

<p>
Denote will now take care to increment the identifier until it becomes
unique within the current scope.
</p>

<p>
Thanks to Felipe Balbi for reporting this bug in issue 105 on the
GitHub mirror: <a href="https://github.com/protesilaos/denote/issues/105">https://github.com/protesilaos/denote/issues/105</a>.
</p>

<p>
Thanks to Vedang Manerikar and Jean-Charles Bagneris for commenting on
this feature on the mailing list:
<a href="https://lists.sr.ht/~protesilaos/denote/%3C87v8emeus0.fsf%40protesilaos.com%3E">https://lists.sr.ht/~protesilaos/denote/%3C87v8emeus0.fsf%40protesilaos.com%3E</a>.
</p>

<p>
Thanks to Ashton Wiersdorf for noticing a mistake I made that caused a
regression in <code>denote-rename-file</code>:
<a href="https://lists.sr.ht/~protesilaos/denote/%3Cm2lefbbzl1.fsf%40wiersdorfmail.net%3E">https://lists.sr.ht/~protesilaos/denote/%3Cm2lefbbzl1.fsf%40wiersdorfmail.net%3E</a>.
</p>
</div>
<div id="outline-container-h:6ea998be-83dd-4c67-945c-11011372818f" class="outline-4">
<h4 id="h:6ea998be-83dd-4c67-945c-11011372818f"><span class="section-number-4">8.2.1.</span> Optional arguments affect <code>denote-dired-rename-marked-files</code></h4>
<div class="outline-text-4" id="text-h:6ea998be-83dd-4c67-945c-11011372818f">
<p>
The <code>denote-dired-rename-marked-files</code> now accepts two optional
arguments.  When called interactively, these are interpreted as a
single or double universal prefix argument (<code>C-u</code> by default, though
do <code>M-x where-is</code> and search for <code>universal-argument</code>).
</p>

<p>
The first argument, named <code>SKIP-FRONT-MATTER-PROMPT</code>, skips the &ldquo;yes
or no&rdquo; prompt requested at the outset of the operation, passing to it
an affirmative response.  Thanks to Jay Rajput for asking the question
that inspired me to implement this.  It was done in issue 155 on the
GitHub mirror: <a href="https://github.com/protesilaos/denote/issues/155">https://github.com/protesilaos/denote/issues/155</a>.
</p>

<p>
The second argument, named <code>NO-UNIQUE-ID-CHECK</code>, will not perform any
checks for potential duplicate identifiers.  The default is to check
for duplicates and increment them such that they become unique.  The
reason this optional argument exists is for those who want to speed up
the process, perhaps because they know ahead of time all identifiers
will be unique or do not care about them.
</p>

<p>
Thanks to Bruno Boal for refining how the prefix argument is
processed.  The patch was sent via a private channel.  The change is
small and thus does not require copyright assignment to the Free
Software Foundation.
</p>
</div>
</div>
</div>
<div id="outline-container-h:651e5561-f9ce-41f6-bad3-d54ce2dcff04" class="outline-3">
<h3 id="h:651e5561-f9ce-41f6-bad3-d54ce2dcff04"><span class="section-number-3">8.3.</span> Menu entries help users discover Denote</h3>
<div class="outline-text-3" id="text-h:651e5561-f9ce-41f6-bad3-d54ce2dcff04">
<p>
Users of <code>menu-bar-mode</code> and/or <code>context-menu-mode</code> will now find a
submenu with points of entry to Denote.  Refer to the publication I
made on my website, as it includes a picture:
<a href="https://protesilaos.com/codelog/2023-03-31-emacs-denote-menu/">https://protesilaos.com/codelog/2023-03-31-emacs-denote-menu/</a>.  I
will save the thousand words for the following sections. 🙃
</p>

<p>
There is a known issue where the <code>menu-bar-mode</code> entry is positioned
before the <code>File</code> submenu.  Apparently, there exists an inelegant way
to place the menu elsewhere, but I am not willing to maintain hacks
for missing functionality.  If someone knows a clear way to put the
submenu elsewhere, please contact me: I want it to be after <code>Tools</code>.
</p>

<p>
Thanks to Kai von Fintel and Noboru Ota (nobiot) for discussing the
placement of the submenu:
<a href="https://lists.sr.ht/~protesilaos/denote/%3C2B60992C-0FC9-42CC-B669-69A544450FEF%40mit.edu%3E">https://lists.sr.ht/~protesilaos/denote/%3C2B60992C-0FC9-42CC-B669-69A544450FEF%40mit.edu%3E</a>.
</p>
</div>
</div>
<div id="outline-container-h:acf95a79-3c45-423d-a88f-d6eed7fa5387" class="outline-3">
<h3 id="h:acf95a79-3c45-423d-a88f-d6eed7fa5387"><span class="section-number-3">8.4.</span> &ldquo;Link&rdquo; commands have simpler names</h3>
<div class="outline-text-3" id="text-h:acf95a79-3c45-423d-a88f-d6eed7fa5387">
<p>
Originally, Denote was organised as a collection of several files,
each of which had its own prefix like <code>denote-dired.el</code>, and
<code>denote-link.el</code>.  This arrangement was deemed surplus to requirements
and all core code was consolidated in <code>denote.el</code>.  An artefact of
that design was the presence of symbols that retained their admittedly
awkward names, like the command <code>denote-link-backlinks</code> or
<code>denote-link-add-missing-links</code>.
</p>

<p>
All such commands are deprecated.  They are replaced with more
discoverable names.  The deprecation is done in such a way that the
old names are aliases for the new ones, but the user is warned not to
rely on them.
</p>

<p>
The new names in detail:
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Old name 🤨</th>
<th scope="col" class="org-left">New name 🤩</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left"><code>denote-link-add-links</code></td>
<td class="org-left"><code>denote-add-links</code></td>
</tr>

<tr>
<td class="org-left"><code>denote-link-add-missing-links</code></td>
<td class="org-left"><code>denote-add-missing-links</code></td>
</tr>

<tr>
<td class="org-left"><code>denote-link-backlinks</code></td>
<td class="org-left"><code>denote-backlinks</code></td>
</tr>

<tr>
<td class="org-left"><code>denote-link-find-file</code></td>
<td class="org-left"><code>denote-find-link</code></td>
</tr>

<tr>
<td class="org-left"><code>denote-link-insert-link</code></td>
<td class="org-left"><code>denote-insert-link</code> (alias for <code>denote-link</code>)</td>
</tr>

<tr>
<td class="org-left"><code>denote-link-show-backlinks-buffer</code></td>
<td class="org-left"><code>denote-show-backlinks-buffer</code> (alias for <code>denote-backlinks</code>)</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="outline-container-h:98f6b10a-ea29-49d1-8d3f-e2f0409f4c8f" class="outline-3">
<h3 id="h:98f6b10a-ea29-49d1-8d3f-e2f0409f4c8f"><span class="section-number-3">8.5.</span> Denote buffers can have shorter names</h3>
<div class="outline-text-3" id="text-h:98f6b10a-ea29-49d1-8d3f-e2f0409f4c8f">
<p>
The Denote file-naming scheme is designed to be a low-tech way of
embedding information in files, making them easier to find.  A
downside is that the names are longer than <code>blah.txt</code> and so the
default Emacs behaviour is to derive a buffer name from the file name.
</p>

<p>
The new optional <code>denote-rename-buffer.el</code> provides a minor mode to
automatically rename the buffer of an existing file, such that it
reflects the file&rsquo;s <code>TITLE</code> field.  Users must enable
<code>denote-rename-buffer-mode</code>.
</p>

<p>
The renaming procedure is controlled by the user option
<code>denote-rename-buffer-function</code>.  By default, it provides the means to
rename using (i) the title, (ii) the identifier, or (iii) a custom
function that returns a string.  Experienced users can refer to
<code>denote-rename-buffer-with-title</code> to draw inspiration on the design of
such a function.
</p>

<p>
Thanks to Morgan Davidson for asking a question that inspired me to
implement this feature.  The discussion took place in issue 151 on the
GitHub mirror <a href="https://github.com/protesilaos/denote/issues/151">https://github.com/protesilaos/denote/issues/151</a>.
</p>
</div>
</div>
<div id="outline-container-h:113820c4-7a6f-4126-9a44-92bfa59744e2" class="outline-3">
<h3 id="h:113820c4-7a6f-4126-9a44-92bfa59744e2"><span class="section-number-3">8.6.</span> Silos work as directory trees</h3>
<div class="outline-text-3" id="text-h:113820c4-7a6f-4126-9a44-92bfa59744e2">
<p>
Denote provides a feature to isolate files in to their own silos, each
of which functions as its own <code>denote-directory</code> variable.  The
technicalities are explained in the manual.  Silos have proven to be a
valuable aspect of file management and I have thus expanded their
scope to work as fully fledged directory trees.  This means that we no
longer assume a silo to be a flat directory listing, but instead
recognise any subdirectories inside of it.
</p>

<p>
Thanks to relict007, Hilde Rhyne, Mirko Hernández, Noboru Ota
(nobiot), Alan Schmitt, hapst3r, and Hilde Rhyne for their
participation in the relevant discussions:
</p>

<ul class="org-ul">
<li><a href="https://lists.sr.ht/~protesilaos/denote/%3C87fsb72nge.fsf%40protesilaos.com%3E">https://lists.sr.ht/~protesilaos/denote/%3C87fsb72nge.fsf%40protesilaos.com%3E</a></li>
<li><a href="https://lists.sr.ht/~protesilaos/denote/%3C80CBB671-D812-4EA8-8C80-85F9F4144051%40disroot.org%3E">https://lists.sr.ht/~protesilaos/denote/%3C80CBB671-D812-4EA8-8C80-85F9F4144051%40disroot.org%3E</a></li>
<li><a href="https://lists.sr.ht/~protesilaos/denote/%3C87pma6t59i.fsf%40kotlak.com%3E">https://lists.sr.ht/~protesilaos/denote/%3C87pma6t59i.fsf%40kotlak.com%3E</a></li>
<li><a href="https://github.com/protesilaos/denote/issues/129">https://github.com/protesilaos/denote/issues/129</a> (GitHub mirror)</li>
<li><a href="https://lists.sr.ht/~protesilaos/denote/%3CB124A5AF-9968-4F7E-9F4B-2BC763E0BFCF@disroot.org%3E#%3Cm0sff0nnhb.fsf@disroot.org%3E">https://lists.sr.ht/~protesilaos/denote/%3CB124A5AF-9968-4F7E-9F4B-2BC763E0BFCF@disroot.org%3E#%3Cm0sff0nnhb.fsf@disroot.org%3E</a>.</li>
</ul>
</div>
</div>
<div id="outline-container-h:08f23806-9570-4031-86e4-810b3e93be81" class="outline-3">
<h3 id="h:08f23806-9570-4031-86e4-810b3e93be81"><span class="section-number-3">8.7.</span> Keywords do not accept multiple words by default</h3>
<div class="outline-text-3" id="text-h:08f23806-9570-4031-86e4-810b3e93be81">
<p>
The idea is to have short keywords and then use more than one, if
necessary.  We do not want to encourage the habit of long keywords
that become overly specific, while we want to avoid the use of
dashes as delimited in the file name&rsquo;s <code>KEYWORDS</code> field.
</p>

<p>
Technically, this changes the default value of the user option
<code>denote-allow-multi-word-keywords</code>.  Users who preferred the old
behaviour can simply toggle it on.
</p>
</div>
</div>
<div id="outline-container-h:58ff6dd3-693a-4437-9217-8e876d92c975" class="outline-3">
<h3 id="h:58ff6dd3-693a-4437-9217-8e876d92c975"><span class="section-number-3">8.8.</span> Pass arguments to Org capture</h3>
<div class="outline-text-3" id="text-h:58ff6dd3-693a-4437-9217-8e876d92c975">
<p>
Denote is not an extension of Org mode, though it can integrate with
<code>org-capture</code>.  I now make it possible to design a capture template
that uses specific prompts.  Consult the section in the manual titled
&ldquo;Create note with specific prompts using Org capture&rdquo;.
</p>

<p>
Thanks to Aditya Yadav for asking about this in issue 132 on the
GitHub mirror: <a href="https://github.com/protesilaos/denote/issues/132">https://github.com/protesilaos/denote/issues/132</a>.
</p>
</div>
</div>
<div id="outline-container-h:e1e874e3-d8ad-4685-aa62-59ad07078db2" class="outline-3">
<h3 id="h:e1e874e3-d8ad-4685-aa62-59ad07078db2"><span class="section-number-3">8.9.</span> Change an existing note&rsquo;s file type</h3>
<div class="outline-text-3" id="text-h:e1e874e3-d8ad-4685-aa62-59ad07078db2">
<p>
The command <code>denote-change-file-type</code> changes the file type of an
existing note.  The available options are those among
<code>denote-file-type</code>.  Thanks to Jean-Philippe Gagné Guay for the
contribution, which was done in pull request 137 on the GitHub mirror:
<a href="https://github.com/protesilaos/denote/pull/137">https://github.com/protesilaos/denote/pull/137</a>.
</p>
</div>
</div>
<div id="outline-container-h:fe595ee7-8ba6-4ca3-aa66-35aa4e5ca0f5" class="outline-3">
<h3 id="h:fe595ee7-8ba6-4ca3-aa66-35aa4e5ca0f5"><span class="section-number-3">8.10.</span> Denote dynamic blocks can now parse <code>rx</code> notation</h3>
<div class="outline-text-3" id="text-h:fe595ee7-8ba6-4ca3-aa66-35aa4e5ca0f5">
<p>
Denote can leverage the Org feature of &ldquo;dynamic blocks&rdquo; to produce
lists of links/backlinks.  This is especially useful for metanotes
(read the Denote manual&#x2014;I document everything for a reason).
</p>

<p>
Before, regular expressions were implemented only as strings while now
they can also be written using the <code>rx</code> notation.  Thanks to Mirko
Hernandez for proposing this feature and discussing it with me in
issue 122 on the GitHub mirror:
<a href="https://github.com/protesilaos/denote/issues/122">https://github.com/protesilaos/denote/issues/122</a>.
</p>

<p>
Thanks to Elias Storms, the author of <code>denote-org-dblock.el</code>, for
iterating on this functionality.  This was done in pull request 130 on
the GitHub mirror: <a href="https://github.com/protesilaos/denote/pull/130">https://github.com/protesilaos/denote/pull/130</a>.
</p>
</div>
</div>
<div id="outline-container-h:431a8952-0d71-4ba6-b6ae-85e5f7d520b9" class="outline-3">
<h3 id="h:431a8952-0d71-4ba6-b6ae-85e5f7d520b9"><span class="section-number-3">8.11.</span> Made links to non-note files works as intended</h3>
<div class="outline-text-3" id="text-h:431a8952-0d71-4ba6-b6ae-85e5f7d520b9">
<p>
The function <code>denote-get-path-by-id</code> is refactored to accept any file
with an identifier.  This always was its intended purpose.  The user
was always able to create <code>denote:</code> Org link types to, for example,
<code>jpg</code> files but <code>denote-get-path-by-id</code> was refusing to resolve the
otherwise valid path.  Thanks to user relict007 for reporting the
problem and discussing it with me in issue 135 on the GitHub mirror:
<a href="https://github.com/protesilaos/denote/issues/135">https://github.com/protesilaos/denote/issues/135</a>.
</p>

<p>
The change was not trivial.  It was followed up by a patch from Noboru
Ota (nobiot) which elaborated on the conditionality.  Quoting from
commit <code>9ce9a24</code>:
</p>

<blockquote>
<p>
fix(denote-get-path-by-id): #135
</p>

<p>
Reference: <a href="https://github.com/protesilaos/denote/issues/135">https://github.com/protesilaos/denote/issues/135</a>
</p>

<p>
This patch change function &rsquo;denote-get-path-by-id&rsquo; to allow for the following:
</p>

<ul class="org-ul">
<li>A single ID points to multiple files with different extensions</li>
<li>Denote needs to find a single file out of the multiple files</li>
<li>This is not necessarily a user error (export an Org file to an HTML)</li>
<li>Denote should let user decide their &ldquo;primary&rdquo; file extension</li>
</ul>

<p>
The case the patch is intended to fix goes something like this:
</p>

<ul class="org-ul">
<li>You have 20230216_<sub>mynotes</sub>&#x2013;tag.org.</li>
<li>You export it to 20230216_<sub>mynotes</sub>&#x2013;tag.html.</li>
<li>Both files are in denote-directory</li>
<li>This means you have two files with the same ID with different
extensions denote-link-find-file, denote-link-find-backlink, and xref
integration might find the html file INSTEAD OF the .org file</li>
</ul>

<p>
This is because html is earlier in the alphabetical order than
org. Because the function uses seq-find, it will find the .html file
first and returns it.
</p>
</blockquote>
</div>
</div>
<div id="outline-container-h:b00f228d-7f84-4d84-8d5f-ac90ea6b1065" class="outline-3">
<h3 id="h:b00f228d-7f84-4d84-8d5f-ac90ea6b1065"><span class="section-number-3">8.12.</span> The <code>denote-rename-file-using-front-matter</code> works with empty keywords</h3>
<div class="outline-text-3" id="text-h:b00f228d-7f84-4d84-8d5f-ac90ea6b1065">
<p>
Keywords are an optional field in the Denote file-naming scheme.
However, an earlier version of the command mentioned in this heading
was considering them mandatory and would refuse to proceed if the
keywords were nil.  Thanks to Eduardo Grajeda for fixing this:
<a href="https://lists.sr.ht/~protesilaos/denote/patches/39896">https://lists.sr.ht/~protesilaos/denote/patches/39896</a>.
</p>

<p>
The change is within the ~15 line limit and does not require copyright
assignment to the Free Software Foundation.
</p>
</div>
</div>
<div id="outline-container-h:91f370f4-9fd1-461b-8ba4-fd9ba2d9c7a8" class="outline-3">
<h3 id="h:91f370f4-9fd1-461b-8ba4-fd9ba2d9c7a8"><span class="section-number-3">8.13.</span> The <code>denote-title-prompt</code> has its own history</h3>
<div class="outline-text-3" id="text-h:91f370f4-9fd1-461b-8ba4-fd9ba2d9c7a8">
<p>
Denote implements minibuffer histories for all its relevant functions.
This makes it easier for users to retrieve their previous inputs and
to not get irrelevant ones.
</p>

<p>
Before, the <code>denote-title-prompt</code> was not using its own history but
was instead relying on another one that was intended only for file
paths, thus mixing unrelated inputs.
</p>

<p>
Thanks to Jonathan Sahar for bringing this matter to my attention.
This was done in issue 144 on the GitHub mirror:
<a href="https://github.com/protesilaos/denote/issues/144">https://github.com/protesilaos/denote/issues/144</a>.
</p>
</div>
</div>
<div id="outline-container-h:dcc52671-2127-47e0-9167-003f40ca3a54" class="outline-3">
<h3 id="h:dcc52671-2127-47e0-9167-003f40ca3a54"><span class="section-number-3">8.14.</span> For developers or advanced users</h3>
<div class="outline-text-3" id="text-h:dcc52671-2127-47e0-9167-003f40ca3a54">
</div>
<div id="outline-container-h:62546ec1-6ec8-41c7-9a18-10a531b534ce" class="outline-4">
<h4 id="h:62546ec1-6ec8-41c7-9a18-10a531b534ce"><span class="section-number-4">8.14.1.</span> Made it possible to add predicates for recursive file listing</h4>
<div class="outline-text-4" id="text-h:62546ec1-6ec8-41c7-9a18-10a531b534ce">
<p>
The helper function <code>denote--directory-all-files-recursively</code> accepts
predicates to help speed up its work.
</p>

<p>
Thanks to Wade Mealing for reporting the issue about the performance
of the built-in function <code>directory-files-recursively</code> in large,
nested directories.  And thanks to Graham Marlow for the patch, which
was prepared as part of an extended discussion with me:
</p>

<ul class="org-ul">
<li><a href="https://lists.sr.ht/~protesilaos/denote/patches/40370">https://lists.sr.ht/~protesilaos/denote/patches/40370</a></li>
<li><a href="https://lists.sr.ht/~protesilaos/denote/%3C20230414000311.1981-1-graham%40mgmarlow.com%3E#%3C76ed9fe2-d597-f7b9-5e59-717aeb77c3c3@mgmarlow.com%3E">https://lists.sr.ht/~protesilaos/denote/%3C20230414000311.1981-1-graham%40mgmarlow.com%3E#%3C76ed9fe2-d597-f7b9-5e59-717aeb77c3c3@mgmarlow.com%3E</a></li>
<li><a href="https://lists.sr.ht/~protesilaos/denote/patches/40384">https://lists.sr.ht/~protesilaos/denote/patches/40384</a></li>
<li><a href="https://lists.sr.ht/~protesilaos/denote/%3C87edonhvy0.fsf%40protesilaos.com%3E">https://lists.sr.ht/~protesilaos/denote/%3C87edonhvy0.fsf%40protesilaos.com%3E</a></li>
<li><a href="https://lists.sr.ht/~protesilaos/denote/%3C76ed9fe2-d597-f7b9-5e59-717aeb77c3c3%40mgmarlow.com%3E">https://lists.sr.ht/~protesilaos/denote/%3C76ed9fe2-d597-f7b9-5e59-717aeb77c3c3%40mgmarlow.com%3E</a></li>
<li><a href="https://lists.sr.ht/~protesilaos/denote/%3C87zg75q4er.fsf%40protesilaos.com%3E">https://lists.sr.ht/~protesilaos/denote/%3C87zg75q4er.fsf%40protesilaos.com%3E</a></li>
<li><a href="https://lists.sr.ht/~protesilaos/denote/%3CCAO4UgPQtxhhqW0tB7eZnVh4nF9vLvnVGx+5oB_78_dg32URSLA%40mail.gmail.com%3E">https://lists.sr.ht/~protesilaos/denote/%3CCAO4UgPQtxhhqW0tB7eZnVh4nF9vLvnVGx+5oB_78_dg32URSLA%40mail.gmail.com%3E</a></li>
</ul>
</div>
</div>
<div id="outline-container-h:ed723274-a78e-4cfd-9655-c3bfe0fb1e68" class="outline-4">
<h4 id="h:ed723274-a78e-4cfd-9655-c3bfe0fb1e68"><span class="section-number-4">8.14.2.</span> New public symbols</h4>
<div class="outline-text-4" id="text-h:ed723274-a78e-4cfd-9655-c3bfe0fb1e68">
<p>
The following are now public symbols that we commit to support and
document henceforth:
</p>

<dl class="org-dl">
<dt>Function <code>denote-file-type-extensions</code></dt><dd>Return all file type
extensions in <code>denote-file-types</code>.</dd>

<dt>Variable <code>denote-encryption-file-extensions</code></dt><dd>List of strings
specifying file extensions for encryption.</dd>

<dt>Function <code>denote-file-type-extensions-with-encryption</code></dt><dd>Derive
<code>denote-file-type-extensions</code> plus <code>denote-encryption-file-extensions</code>.</dd>

<dt>Function <code>denote-link-return-links</code></dt><dd>Return list of links in
current or optional <code>FILE</code>.  Also see <code>denote-link-return-backlinks</code>.</dd>

<dt>Function <code>denote-link-return-backlinks</code></dt><dd>Return list of links in
current or optional <code>FILE</code>.  Also see <code>denote-link-return-links</code>.</dd>

<dt>Function <code>denote-rewrite-front-matter</code></dt><dd>Rewrite front matter of
note after <code>denote-rename-file</code> (or related) The <code>FILE</code>, <code>TITLE</code>,
<code>KEYWORDS</code>, and <code>FILE-TYPE</code> arguments are given by the renaming
command and are used to construct new front matter values if
appropriate.</dd>

<dt>Function <code>denote-rewrite-keywords</code></dt><dd>Rewrite <code>KEYWORDS</code> in <code>FILE</code>
outright according to <code>FILE-TYPE</code>.  Do the same as
<code>denote-rewrite-front-matter</code> for keywords, but do not ask for
confirmation.  This is for use in <code>denote-keywords-add</code>,
<code>denote-keywords-remove</code>, <code>denote-dired-rename-marked-files</code>, or
related.</dd>
</dl>

<p>
I am publicising the <code>denote-link-return-links</code> and its counterpart in
response to the mailing list thread started by relict007:
<a href="https://lists.sr.ht/~protesilaos/denote/%3C87a5ygk6yi.fsf@kotlak.com%3E">https://lists.sr.ht/~protesilaos/denote/%3C87a5ygk6yi.fsf@kotlak.com%3E</a>.
relict007 is the developer of the <code>denote-cache</code> package (in
progress): <a href="https://git.sr.ht/~relict007/denote-cache">https://git.sr.ht/~relict007/denote-cache</a>.
</p>

<p>
Similarly, the <code>denote-rewrite-keywords</code> is made public upon the
request of Alan Schmitt:
<a href="https://lists.sr.ht/~protesilaos/denote/%3Cm2ttzgn2wu.fsf%40m4x.org%3E">https://lists.sr.ht/~protesilaos/denote/%3Cm2ttzgn2wu.fsf%40m4x.org%3E</a>.
</p>
</div>
</div>
</div>
<div id="outline-container-h:918087e6-8cd5-4d4f-a11a-b465dcbd9fe3" class="outline-3">
<h3 id="h:918087e6-8cd5-4d4f-a11a-b465dcbd9fe3"><span class="section-number-3">8.15.</span> Miscellaneous</h3>
<div class="outline-text-3" id="text-h:918087e6-8cd5-4d4f-a11a-b465dcbd9fe3">
<ul class="org-ul">
<li>Revised <code>denote-link-return-{links,backlinks}</code> to not produce a
<code>user-error</code>.  The errors are reserved for the interactive
functions. The others are for developers. Thanks to Elias Storms for
bringing this matter to my attention:
<a href="https://github.com/protesilaos/denote/commit/694c1517be73949edbc3993c105c764da8e2571f#commitcomment-112677876">https://github.com/protesilaos/denote/commit/694c1517be73949edbc3993c105c764da8e2571f#commitcomment-112677876</a>.</li>

<li>Refrained from trying to find forward links in non-text-files.  If a
file extension is not in <code>denote-file-types</code>, we have no way of
parsing or finding outgoing links in it. This change checks for the
file extension early on in &rsquo;when-let*&rsquo; block and avoids opening the
file which is a relatively costly operation (and would fail finding
links anyway).  Thanks to relict007 for the patch.  This was done on
the mailing list:
<a href="https://lists.sr.ht/~protesilaos/denote/%3C87r0riffdx.fsf%40kotlak.com%3E">https://lists.sr.ht/~protesilaos/denote/%3C87r0riffdx.fsf%40kotlak.com%3E</a>
The change is small and thus does not require copyright assignment
to the Free Software Foundation.</li>

<li>Explained how to troubleshoot Denote.  Refer to the section in the
manual titled &ldquo;Troubleshoot Denote in a pristine environment.&rdquo;
While this is about Denote, the skills apply to all Emacs packages.</li>

<li>Ensured backlinks get correct <code>denote-directory</code> path.  The
backlinks buffer will now get the correct path when it is generated
inside a silo.  This is related to issue 129 reported by hapst3r on
the GitHub mirror: <a href="https://github.com/protesilaos/denote/issues/129">https://github.com/protesilaos/denote/issues/129</a>.
The change is necessary because <code>.dir-locals.el</code> do not work for
buffers, so we must get the value from the file that calls
<code>denote-link-backlinks</code>.</li>

<li>Added missing underscore from examples in exporting section.  Thanks
to Peter Prevos for bringing this matter to my attention:
<a href="https://lists.sr.ht/~protesilaos/denote/%3C87fs8b85tq.fsf%40prevos.net%3E#%3C87lehiuxfo.fsf@protesilaos.com%3E">https://lists.sr.ht/~protesilaos/denote/%3C87fs8b85tq.fsf%40prevos.net%3E#%3C87lehiuxfo.fsf@protesilaos.com%3E</a>.</li>

<li>Made the command <code>denote-open-or-create</code> work with an empty
<code>denote-directory</code>.  The <code>denote-file-prompt</code> would throw an error
before.  The correct behaviour is to proceed to the &ldquo;Create&rdquo; phase
if the <code>denote-directory</code> is empty.  Thanks to user drcxd for
reporting the bug in issue 131 on the GitHub mirror and for testing
my sample code: <a href="https://github.com/protesilaos/denote/issues/131">https://github.com/protesilaos/denote/issues/131</a>.</li>

<li>Documented how to use tree-based file prompt on demand.  This is my
solution to a request made by Mirko Hernandez on the possible use of
the old Denote file prompt.  It is better not to introduce a user
option for this case, nor to keep multiple variants of the
<code>denote-file-prompt</code> in denote.el, as we want to keep things simple.
Mirko&rsquo;s feedback was provided in issue 121 on the GitHub mirror:
<a href="https://github.com/protesilaos/denote/issues/121">https://github.com/protesilaos/denote/issues/121</a>.</li>

<li>Added the variable <code>denote-user-enforced-denote-directory</code>.  This is
intended for users who write custom code to extend Denote.  The
value of this variable should be <code>let</code> bound around calls to the
function <code>denote-directory</code>, thus overriding its return value.  This
was discussed on the mailing list and then introduced by Vedang
Manerikar in commit <code>977c757</code>, with further changes by me in
<code>20ddc97</code>: <a href="https://lists.sr.ht/~protesilaos/denote/patches/41776">https://lists.sr.ht/~protesilaos/denote/patches/41776</a>.
Vedang has assigned copyright to the Free Software Foundation.</li>

<li><p>
Fixed <code>my-denote-org-extract-subtree</code> section of the documentation.
This is part of some sample code that is not part of <code>denote.el</code>,
but we provide as a convenience/inspiration for interested parties.
</p>

<p>
The provided function did not work correctly.
</p>

<ol class="org-ol">
<li>Tags are extracted before deleting the region from the source file.</li>
<li>The function <code>org-end-of-subtree</code> is called to calculate the
point we should delete up to.  The previously used function
<code>org-entry-end-position</code> ends at the first sub-heading under the
tree, which is not what we want.  Instead, we want to cut the
whole subtree.</li>
<li>The date information available in the subtree is retained.  We
look for three common places for this information: the <code>CREATED</code>
or <code>DATE</code> properties in the <code>PROPERTIES</code> drawer, and the <code>CLOSED</code>
cookie at the element level itself.</li>
</ol>

<p>
Thanks to Vedang Manerikar for the contribution:
<a href="https://lists.sr.ht/~protesilaos/denote/%3CCABzEscbPx24LCUCc7JsMmQtVGwhou5fUH_5h+%3Dt%3Dqi4396NqNQ%40mail.gmail.com%3E">https://lists.sr.ht/~protesilaos/denote/%3CCABzEscbPx24LCUCc7JsMmQtVGwhou5fUH_5h+%3Dt%3Dqi4396NqNQ%40mail.gmail.com%3E</a>
</p></li>

<li>Removed the dependency on the built-in <code>xdg</code> library and updated the
default value of the user option <code>denote-directory</code>.  The reason is
that XDG is a Linux standard that does not work on other operating
systems, according to private feedback I received.</li>

<li><p>
Fixed a regression for <code>M-p</code> (<code>previous-history-element</code>) in &ldquo;do or
create&rdquo; commands.  Read the doc string of the commands
<code>denote-open-or-create</code> or <code>denote-link-or-create</code> for how this is
supposed to work.  In short:
</p>

<ul class="org-ul">
<li>Invoke the &ldquo;do or create&rdquo; command.</li>
<li>Type something that does not match a file.</li>
<li>In the following title prompt, hit <code>M-p</code> to bring back the last input.</li>
</ul>

<p>
I realised there was a regression when I read issue 152 on the
GitHub mirror, which was created by user &ldquo;ustcpxy&rdquo;:
<a href="https://github.com/protesilaos/denote/issues/152">https://github.com/protesilaos/denote/issues/152</a>.  The issue is
about skipping the file title prompt.
</p></li>

<li>Simplified the internal <code>denote--buffer-file-names</code>.  Thanks to Adam
Růžička for noting that my change was not compatible with older
Emacs versions, and for preparing the change.  This was discussed in
pull request 158 on the GitHub mirror, with my suggestion to not use
<code>seq-filter</code> as it affected the return value:
<a href="https://github.com/protesilaos/denote/pull/158">https://github.com/protesilaos/denote/pull/158</a>. The change is
below the 15 line limit, meaning that Adam does have to assign
copyright to the Free Software Foundation.</li>

<li>Documented custom code in the manual on how to interactively select
a silo.  I am providing this in response to a request from GitHub
user rbenit68.  The discussion took place in issue 127 on the GitHub
mirror, with the participation of Mirko Hernandez:
<a href="https://github.com/protesilaos/denote/issues/127">https://github.com/protesilaos/denote/issues/127</a>. The custom code
I provide is the expanded version of an idea put forth by Mirko, to
whom I am thankful.</li>

<li>Fixed an outdated reference in the <code>denote-file-types</code> doc string.
Thanks to user doolio for spotting the error and reporting it in
issue 139 on the GitHub mirror:
<a href="https://github.com/protesilaos/denote/issues/139">https://github.com/protesilaos/denote/issues/139</a>.</li>

<li>Cited in the manual&rsquo;s section &ldquo;Publications about Denote&rdquo; an article
by Mohamed Suliman titled <i>Managing a bibliography of BiBTeX entries
with Denote</i> (2022-12-20):
<a href="https://www.scss.tcd.ie/~sulimanm/posts/denote-bibliography.html">https://www.scss.tcd.ie/~sulimanm/posts/denote-bibliography.html</a>.
If you have published something related to Denote, please let me
know and I will add to the list.</li>

<li>Cited the essay by Summer Emacs titled <i>An explanation of how I use
Emacs</i> (2023-05-04):
<a href="https://github.com/summeremacs/howiuseemacs/blob/main/full-explanation-of-how-i-use-emacs.org">https://github.com/summeremacs/howiuseemacs/blob/main/full-explanation-of-how-i-use-emacs.org</a></li>

<li>Cited the video series by Stefan Thesing titled <i>Denote as a
Zettelkasten</i>: <a href="https://www.thesing-online.de/blog/denote-as-a-zettelkasten/">https://www.thesing-online.de/blog/denote-as-a-zettelkasten/</a>.</li>

<li>Added link to Karl Voit&rsquo;s work in the manual&rsquo;s section &ldquo;Alternative
implementations and further reading.&rdquo;  Thanks to Norwid Behrnd for
the contribution in pull request 123 on the GitHub mirror:
<a href="https://github.com/protesilaos/denote/pull/123">https://github.com/protesilaos/denote/pull/123</a>.</li>

<li>Fixed the broken link to jao&rsquo;s blog.  Thanks to Tomasz Hołubowicz
for the contribution, which was done in pull request 145 on the
GitHub mirror: <a href="https://github.com/protesilaos/denote/pull/145">https://github.com/protesilaos/denote/pull/145</a>.</li>

<li>Authored lots of other ancillary changes/features to the code base
or the manual (yes, this change log is how I &ldquo;cut the long story
short&rdquo;).</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-h:92478a05-4a69-413c-8d95-1dacbcf6af2c" class="outline-2">
<h2 id="h:92478a05-4a69-413c-8d95-1dacbcf6af2c"><span class="section-number-2">9.</span> Version 1.2.0 on 2022-12-12</h2>
<div class="outline-text-2" id="text-h:92478a05-4a69-413c-8d95-1dacbcf6af2c">
</div>
<div id="outline-container-h:bc0e173a-3b9f-427c-9fb0-d435a5ef127e" class="outline-3">
<h3 id="h:bc0e173a-3b9f-427c-9fb0-d435a5ef127e"><span class="section-number-3">9.1.</span> Denote now requires Emacs version 28.1 or higher</h3>
<div class="outline-text-3" id="text-h:bc0e173a-3b9f-427c-9fb0-d435a5ef127e">
<p>
With the help of Noboru Ota (nobiot), we realised that Denote was
broken on Emacs 27 for quite a while.  The fact that we received no
feedback about it suggests that this change is the best course of
action going forward.  Discussion:
<a href="https://lists.sr.ht/~protesilaos/denote/%3C86r0yvzm12.fsf%40nobiot.com%3E#%3C86sfja78ik.fsf@nobiot.com%3E">https://lists.sr.ht/~protesilaos/denote/%3C86r0yvzm12.fsf%40nobiot.com%3E#%3C86sfja78ik.fsf@nobiot.com%3E</a>
</p>

<p>
Emacs 27 lacks certain Xref facilities that we need for the
backlinking facility.  It was holding us back for no good reason,
while also adding to the maintenance burden.
</p>

<p>
If you are using Denote on Emacs 27 and things are working for you,
there is no need to update the package.  Do it when you also upgrade
Emacs to a newer version.
</p>
</div>
</div>
<div id="outline-container-h:dafbdbae-36f1-487a-94c8-2762568a766e" class="outline-3">
<h3 id="h:dafbdbae-36f1-487a-94c8-2762568a766e"><span class="section-number-3">9.2.</span> Display context in backlinks&rsquo; buffer</h3>
<div class="outline-text-3" id="text-h:dafbdbae-36f1-487a-94c8-2762568a766e">
<p>
By default, the generic backlinks&rsquo; buffer, which can be displayed with
the command <code>denote-link-backlinks</code> (alias <code>denote-link-show-backlinks-buffer</code>),
only shows the file names of the linked notes.
</p>

<p>
We have made it possible to produce a more informative view by showing
the context of the link and also listing all links per file.  This is
done by setting the user option <code>denote-backlinks-show-context</code> to a
non-nil value.
</p>

<p>
To illustrate the difference, this is the default backlinks&rsquo; buffer:
</p>

<pre class="example" id="org9c005e1">
Backlinks to "On being honest" (20220614T130812)
------------------------------------------------

20220614T145606--let-this-glance-become-a-stare__journal.txt
20220616T182958--feeling-butterflies-in-your-stomach__journal.txt
</pre>

<p>
And this is the one with <code>denote-backlinks-show-context</code> enabled:
</p>

<pre class="example" id="org97f9e42">
Backlinks to "On being honest" (20220614T130812)
------------------------------------------------

20220614T145606--let-this-glance-become-a-stare__journal.txt
37: growing into it: [[denote:20220614T130812][On being honest]].
64: As I said in [[denote:20220614T130812][On being honest]] I have never
20220616T182958--feeling-butterflies-in-your-stomach__journal.txt
62: indifference.  In [[denote:20220614T130812][On being honest]] I alluded
</pre>

<p>
Granted, here we show plain text though in Emacs the results have the
appropriate colours of the active theme and are easier to read.
</p>

<p>
Thanks to Noboru Ota (nobiot) for implementing this feature.  We
discussed it at length on the mailing list:
<a href="https://lists.sr.ht/~protesilaos/denote/%3C86r0yvzm12.fsf%40nobiot.com%3E">https://lists.sr.ht/~protesilaos/denote/%3C86r0yvzm12.fsf%40nobiot.com%3E</a>.
</p>

<p>
Noboru has assigned copyright to the Free Software Foundation.
</p>
</div>
</div>
<div id="outline-container-h:f7904a57-22c0-446f-b7e3-7a736332002c" class="outline-3">
<h3 id="h:f7904a57-22c0-446f-b7e3-7a736332002c"><span class="section-number-3">9.3.</span> Dynamic Org blocks for lists of Denote links</h3>
<div class="outline-text-3" id="text-h:f7904a57-22c0-446f-b7e3-7a736332002c">
<p>
Denote now includes the <code>denote-org-dblock</code> library.  Activate it
thus:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">;; Register Denote's Org dynamic blocks
(require 'denote-org-dblock)
</pre>
</div>

<p>
A dynamic block gets its contents by evaluating a given function,
depending on the type of block.  The type of block and its parameters
are stated in the opening <code>#+BEGIN</code> line of the block.  Typing <code>C-c
C-c</code> with point on that line runs the function, with the given
arguments, and populates the block&rsquo;s contents accordingly.
</p>

<p>
What Denote has is ways to write blocks that produce a list of links
matching a given regular expression while conforming with some other
parameters.  The manual explains how to use this powerful feature
(which is necessarily specific to the Org file type):
<a href="https://protesilaos.com/emacs/denote#h:8b542c50-dcc9-4bca-8037-a36599b22779">https://protesilaos.com/emacs/denote#h:8b542c50-dcc9-4bca-8037-a36599b22779</a>.
</p>

<p>
Thanks to Elias Storms for authoring <code>denote-org-dblock</code> and for
discussing this issue at length with me on the mailing list:
<a href="https://lists.sr.ht/~protesilaos/denote/%3Cm2sfisexx7.fsf%40MBA21.fritz.box%3E">https://lists.sr.ht/~protesilaos/denote/%3Cm2sfisexx7.fsf%40MBA21.fritz.box%3E</a>.
</p>

<p>
Elias has assigned copyright to the Free Software Foundation.
</p>
</div>
</div>
<div id="outline-container-h:e8a7d08c-cdf0-4207-92c1-391415b8371f" class="outline-3">
<h3 id="h:e8a7d08c-cdf0-4207-92c1-391415b8371f"><span class="section-number-3">9.4.</span> Integration with the built-in project.el and xref.el libraries</h3>
<div class="outline-text-3" id="text-h:e8a7d08c-cdf0-4207-92c1-391415b8371f">
<p>
Denote was already using Xref internally but has now gained more
capabilities which help it find files more effectively.  With the help
of Emacs&rsquo; standard project library, all file-related prompts (e.g. to
add a link) search all items in the <code>denote-directory</code> regardless of
whether the user is in a subdirectory or not.
</p>

<p>
All Denote commands benefit from this refactoring.  One such request
to &ldquo;Make <code>denote-open-or-create</code> work better across subfolders&rdquo; was
made in issue 114 on the GitHub mirror:
<a href="https://github.com/protesilaos/denote/issues/114">https://github.com/protesilaos/denote/issues/114</a>.
</p>

<p>
Thanks to Noboru Ota (nobiot) for introducing this feature together
with a new system of &ldquo;modules&rdquo; for incorporating additional built-in
functionality:
</p>

<ul class="org-ul">
<li><a href="https://lists.sr.ht/~protesilaos/denote/%3C86a64ooxyi.fsf%40nobiot.com%3E">https://lists.sr.ht/~protesilaos/denote/%3C86a64ooxyi.fsf%40nobiot.com%3E</a></li>
<li><a href="https://lists.sr.ht/~protesilaos/denote/%3C86k03f4iq6.fsf%40nobiot.com%3E">https://lists.sr.ht/~protesilaos/denote/%3C86k03f4iq6.fsf%40nobiot.com%3E</a></li>
</ul>

<p>
I will not document the new user option <code>denote-modules</code> right now as
my ongoing job search prevented me from exploring the full potential
of this feature.  I promise to do it for the next version of Denote
and update the manual accordingly.  Nevertheless, the doc string of
<code>denote-modules</code> already provides all one needs to get started.
</p>
</div>
</div>
<div id="outline-container-h:5a003d44-7ad0-4c92-b908-ec7cf016b2dd" class="outline-3">
<h3 id="h:5a003d44-7ad0-4c92-b908-ec7cf016b2dd"><span class="section-number-3">9.5.</span> Re-use last input in &ldquo;do or create&rdquo; commands</h3>
<div class="outline-text-3" id="text-h:5a003d44-7ad0-4c92-b908-ec7cf016b2dd">
<p>
The commands <code>denote-open-or-create</code>, <code>denote-link-or-create</code> first
prompt for an existing note.  If they find it, they act on it,
otherwise they prompt for the creation of a new note to operate on.
</p>

<p>
At the first prompt, it is common to use regular expressions and
out-of-order pattern matching (such as with the <code>orderless</code> package),
so the input can be something like <code>_test ^2022 some title</code>, which we
obviously don&rsquo;t want to automatically reuse as the new note&rsquo;s actual
title.
</p>

<p>
To this end, and to accommodate all workflows, we leverage Emacs&rsquo;
minibuffer history to make the last input accessible with <code>M-p</code> at the
minibuffer prompt (<code>M-x previous-history-element</code>).  The text is
available for further editing before it is submitted as the new note&rsquo;s
title.  Simple, effective, and flexible!
</p>

<p>
Thanks to Guo Yong for starting the discussion that led me to this
improvement:
<a href="https://lists.sr.ht/~protesilaos/denote/%3CNF6pFBq--3-9%40tutanota.com%3E">https://lists.sr.ht/~protesilaos/denote/%3CNF6pFBq--3-9%40tutanota.com%3E</a>.
</p>
</div>
</div>
<div id="outline-container-h:e73a4e76-6c00-4691-8893-8f885c26f306" class="outline-3">
<h3 id="h:e73a4e76-6c00-4691-8893-8f885c26f306"><span class="section-number-3">9.6.</span> Add support for any file type</h3>
<div class="outline-text-3" id="text-h:e73a4e76-6c00-4691-8893-8f885c26f306">
<p>
Denote provides the user option <code>denote-file-type</code> which specifies the
file type to use for new notes.  Options include Org mode (the
default), Markdown+YAML, Markdown+TOML, and plain text.  Furthermore,
there exists the convenience command <code>denote-type</code> (alias
<code>denote-create-note-using-type</code>) which prompts for a file type to use
when creating a new note (I normally write in plain text, but
sometimes switch to Org or Markdown).
</p>

<p>
The variable <code>denote-file-types</code> (which is NOT a user option)
specifies all the parameters of what a &ldquo;file type&rdquo; means, such as how
to format its front matter, what style of date+time to use, which file
type extension to write, how to rename the file, what style of link to
apply, and so on.  Advanced users can now edit this variable to either
register new file types or redefine the behaviour of existing ones.
Read this comprehensive guide on how to do it:
<a href="https://protesilaos.com/codelog/2022-10-30-demo-denote-custom-file-type/">https://protesilaos.com/codelog/2022-10-30-demo-denote-custom-file-type/</a>.
</p>

<p>
I repeat: this is for advanced users or, anyhow, for those who are
prepared to maintain some custom code in their setup.  The guide is
accessible though and I am always willing to help anyone in need of
assistance.
</p>

<p>
A relevant request for such a feature can be found in issue 86 on the
GitHub mirror: <a href="https://github.com/protesilaos/denote/issues/86">https://github.com/protesilaos/denote/issues/86</a>.
</p>

<p>
The <code>denote-file-types</code> were introduced by Jean-Philippe Gagné Guay in
pull request 89 at the GitHub mirror and were part of Denote version
0.6.0: <a href="https://github.com/protesilaos/denote/pull/89">https://github.com/protesilaos/denote/pull/89</a>.  I have made
lots of changes since then to make all parts of Denote work with it
and to parameterise its various facets.
</p>
</div>
</div>
<div id="outline-container-h:04f42aab-d8fe-4c4a-b865-3bb0655e2631" class="outline-3">
<h3 id="h:04f42aab-d8fe-4c4a-b865-3bb0655e2631"><span class="section-number-3">9.7.</span> Exclude certain directories from all operations</h3>
<div class="outline-text-3" id="text-h:04f42aab-d8fe-4c4a-b865-3bb0655e2631">
<p>
The user option <code>denote-excluded-directories-regexp</code> instructs all
Denote functions that read or check file/directory names to omit
directories that match the given regular expression.  The regexp needs
to match only the name of the directory, not its full path.
</p>

<p>
Affected operations include file prompts and functions that return the
available files in the <code>denote-directory</code>.  File prompts are used by
several commands, such as <code>denote-link</code> and <code>denote-subdirectory</code>.
Functions that check for files include <code>denote-directory-files</code> and
<code>denote-directory-subdirectories</code>.
</p>

<p>
Thanks to Graham Marlow for the contribution which was done in pull
request 112 on the GitHub mirror:
<a href="https://github.com/protesilaos/denote/pull/112">https://github.com/protesilaos/denote/pull/112</a>.
</p>

<p>
The original contribution, with the subsequent tweaks I made to it, is
within the eligible line count and thus does not require copyright
assignment to the Free Software Foundation.
</p>
</div>
</div>
<div id="outline-container-h:226ba85e-1f5e-45f5-956a-f5e8a95c397e" class="outline-3">
<h3 id="h:226ba85e-1f5e-45f5-956a-f5e8a95c397e"><span class="section-number-3">9.8.</span> Exclude certain keywords from being inferred</h3>
<div class="outline-text-3" id="text-h:226ba85e-1f5e-45f5-956a-f5e8a95c397e">
<p>
The user option <code>denote-excluded-keywords-regexp</code> omits keywords that
match a regular expression from the list of inferred keywords.
</p>

<p>
Keywords are inferred from file names and provided at relevant prompts
as completion candidates when the user option <code>denote-infer-keywords</code>
is non-nil.
</p>

<p>
Thanks to Stefan Thesing for proposing this idea in issue 115 on the
GitHub mirror: <a href="https://github.com/protesilaos/denote/issues/115">https://github.com/protesilaos/denote/issues/115</a>.
</p>

<p>
[ Other people participate in that thread and there may be something
  more coming out of it. ]
</p>
</div>
</div>
<div id="outline-container-h:ff16633f-5fb8-4935-9e2f-044ec998d3f7" class="outline-3">
<h3 id="h:ff16633f-5fb8-4935-9e2f-044ec998d3f7"><span class="section-number-3">9.9.</span> Use the <code>citar-denote</code> package for bibliography notes</h3>
<div class="outline-text-3" id="text-h:ff16633f-5fb8-4935-9e2f-044ec998d3f7">
<p>
Peter Prevos has produced the <code>citar-denote</code> package which makes it
possible to write notes on BibTeX entries with the help of the <code>citar</code>
package.  These notes have the citation&rsquo;s unique key associated with
them in the file&rsquo;s front matter.  They also get a configurable keyword
in their file name, making it easy to find them in Dired and/or
retrieve them with the various Denote methods.
</p>

<p>
With <code>citar-denote</code>, the user leverages standard minibuffer completion
mechanisms (e.g. with the help of the <code>vertico</code> and <code>embark</code> packages)
to manage bibliographic notes and access those notes with ease.  The
package&rsquo;s documentation covers the details: <a href="https://github.com/pprevos/citar-denote/">https://github.com/pprevos/citar-denote/</a>.
</p>

<p>
Thanks to Peter Prevos for developing this package and for mentioning
it on the Denote mailing list:
<a href="https://lists.sr.ht/~protesilaos/denote/%3C877cz0e96r.fsf%40prevos.net%3E">https://lists.sr.ht/~protesilaos/denote/%3C877cz0e96r.fsf%40prevos.net%3E</a>.
</p>
</div>
</div>
<div id="outline-container-h:5cc2076d-d4d2-45be-b28e-9ec67eca82b4" class="outline-3">
<h3 id="h:5cc2076d-d4d2-45be-b28e-9ec67eca82b4"><span class="section-number-3">9.10.</span> New functions and variables for developers</h3>
<div class="outline-text-3" id="text-h:5cc2076d-d4d2-45be-b28e-9ec67eca82b4">
<p>
Developers or users who maintain custom code now have access to:
</p>

<ul class="org-ul">
<li>Function <code>denote-keywords-sort</code></li>
<li>Function <code>denote-keywords-prompt</code></li>
</ul>

<p>
Plus all the following which are related to the aforementioned <code>denote-file-types</code>:
</p>

<ul class="org-ul">
<li>Variable <code>denote-org-link-format</code></li>
<li>Variable <code>denote-md-link-format</code></li>
<li>Variable <code>denote-id-only-link-format</code></li>
<li>Variable <code>denote-org-link-in-context-regexp</code></li>
<li>Variable <code>denote-md-link-in-context-regexp</code></li>
<li>Variable <code>denote-id-only-link-in-context-regexp</code></li>
<li>Function <code>denote-date-org-timestamp</code></li>
<li>Function <code>denote-date-rfc3339</code></li>
<li>Function <code>denote-date-iso-8601</code></li>
</ul>

<p>
Again, users can implement support for ANY FILE TYPE and use it to
write notes in, either as their default choice or on-demand.  If
anything, this highlights the flexibility of Denote.
</p>
</div>
</div>
<div id="outline-container-h:acbb0cf7-ad17-495e-85d2-821cbbfc3158" class="outline-3">
<h3 id="h:acbb0cf7-ad17-495e-85d2-821cbbfc3158"><span class="section-number-3">9.11.</span> Miscellaneous</h3>
<div class="outline-text-3" id="text-h:acbb0cf7-ad17-495e-85d2-821cbbfc3158">
<ul class="org-ul">
<li>Added the <code>denote-keywords-sort</code> function.  The intent is to
abstract the task of sorting the keywords.  Before, it was handled
by the <code>denote-keywords-prompt</code>, which meant that keywords were not
sorted when the <code>denote</code> function was called from Lisp.  Thanks to
Florian for bringing this matter to my attention, providing relevant
feedback, and fixing an omission of mine in <code>denote-rename-file</code>:
<a href="https://lists.sr.ht/~protesilaos/denote/%3C166689879712.8.6808878344988686135.71824507%40aboulafia.org%3E">https://lists.sr.ht/~protesilaos/denote/%3C166689879712.8.6808878344988686135.71824507%40aboulafia.org%3E</a>.</li>

<li>Expanded the manual&rsquo;s entry on directory &ldquo;silos&rdquo; to include more
code examples.  Thanks to Viktor Haag for asking a question on the
mailing list that inspired me to produce this entry:
<a href="https://lists.sr.ht/~protesilaos/denote/%3CCANnkwC6NLd0VneUEqFrjh7TCUBLBgEtLCcPwM37JDvJXJCShVQ%40mail.gmail.com%3E">https://lists.sr.ht/~protesilaos/denote/%3CCANnkwC6NLd0VneUEqFrjh7TCUBLBgEtLCcPwM37JDvJXJCShVQ%40mail.gmail.com%3E</a>.</li>

<li>Included a section in the manual with a non-exhaustive list of
references to publications about Denote.  As of this writing, it
includes entries from David Wilson (SystemCrafters), Jack Baty,
Jeremy Friesen, and Peter Prevos.  If you have an article about
Denote, please contact me about it directly or on the Denote mailing
list and I will add it to the manual.</li>

<li><p>
Tweaked how Org&rsquo;s HTML export produces links in order to avoid
broken subdirectory paths.  Thanks to Thibaut Benjamin for the
contribution, which was done in pull request 116 on the GitHub
mirror: <a href="https://github.com/protesilaos/denote/pull/116">https://github.com/protesilaos/denote/pull/116</a>.
</p>

<p>
The change concerns a single line and thus Thibaut requires no
copyright assignment to the Free Software Foundation.
</p></li>

<li>Expanded the manual where necessary.</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-h:8e0f536a-ab3b-4cab-82f7-529bc0e40dbd" class="outline-2">
<h2 id="h:8e0f536a-ab3b-4cab-82f7-529bc0e40dbd"><span class="section-number-2">10.</span> Version 1.1.0 on 2022-10-20</h2>
<div class="outline-text-2" id="text-h:8e0f536a-ab3b-4cab-82f7-529bc0e40dbd">
</div>
<div id="outline-container-h:5665e7ec-4f3a-4de3-8cb0-63d25a0db8c1" class="outline-3">
<h3 id="h:5665e7ec-4f3a-4de3-8cb0-63d25a0db8c1"><span class="section-number-3">10.1.</span> New commands or refinements to common use-cases</h3>
<div class="outline-text-3" id="text-h:5665e7ec-4f3a-4de3-8cb0-63d25a0db8c1">
<ul class="org-ul">
<li><p>
The <code>denote-link-add-missing-links</code> is a companion to what we
already provide to produce a list of links to Denote files matching
a regular expression (the <code>denote-link-add-links</code>).  This new
command adds links that are not already present in the current file.
So if you have a metanote that references, say, your journal entries
but have not updated it in a month, you can revisit the metanote,
invoke <code>denote-link-add-missing-links</code>, and then type the search
terms (e.g. <code>_journal</code>) to include what remains.
</p>

<p>
Thanks to Elias Storms for the initial contribution, which was done
in pull request 108 on the GitHub mirror:
<a href="https://github.com/protesilaos/denote/pull/108">https://github.com/protesilaos/denote/pull/108</a>.
</p>

<p>
Elias has assigned copyright to the Free Software Foundation.  It is
required for changes that exceed 15 lines in total.
</p></li>

<li><p>
The <code>denote-link-find-backlink</code> provides a minibuffer interface that
shows all backlinks to the current note.  It complements the
existing <code>denote-link-backlinks</code> command (which also has the alias
<code>denote-link-show-backlinks-buffer</code>).  Each command has its own
niche: the minibuffer lets the user leverage powerful pattern
matching styles, such as those provided by the <code>orderless</code> package,
while the bespoke buffer provides an easy overview of what links to
the current note.
</p>

<p>
Thanks to Elias Storms for the original patch:
<a href="https://lists.sr.ht/~protesilaos/denote/%3Cm2fsg6o2t6.fsf%40MBA21.fritz.box%3E#%3Cm2pmfam7yi.fsf@MBA21.fritz.box%3E">https://lists.sr.ht/~protesilaos/denote/%3Cm2fsg6o2t6.fsf%40MBA21.fritz.box%3E#%3Cm2pmfam7yi.fsf@MBA21.fritz.box%3E</a>.
</p></li>

<li><p>
The <code>denote-keywords-add</code> and <code>denote-keywords-remove</code> are two
commands that interactively operate on the current note&rsquo;s front
matter to add or remove keywords.  They use the familiar keywords&rsquo;
prompt which means, among others, that they can read more than one
keyword at a time.  To specify multiple keywords, separate each
input with a comma (or whatever the value of <code>crm-separator</code> is,
which should be a comma unless something out-of-the-ordinary is in
force).
</p>

<p>
Thanks to Elias Storms for the original patch, which was done as
part of a discussion on the mailing list and then iterated on:
<a href="https://lists.sr.ht/~protesilaos/denote/%3Cm24jwvpbt2.fsf%40MBA21.fritz.box%3E#%3Cm28rlik0tc.fsf@MBA21.fritz.box%3E">https://lists.sr.ht/~protesilaos/denote/%3Cm24jwvpbt2.fsf%40MBA21.fritz.box%3E#%3Cm28rlik0tc.fsf@MBA21.fritz.box%3E</a>.
</p></li>

<li><p>
The <code>denote-link</code> command will now recognise an active region and
use its text as the description of the inserted link.  The default
behaviour is to use the file&rsquo;s title from its front matter or file
name.  Thanks to Charanjit Singh for the original contribution,
which was done as part of pull request 109 on the GitHub mirror:
<a href="https://github.com/protesilaos/denote/pull/109">https://github.com/protesilaos/denote/pull/109</a>.  A subsequent
tweak was implemented in pull request 110, following a discussion
with me: <a href="https://github.com/protesilaos/denote/pull/110">https://github.com/protesilaos/denote/pull/110</a>.
</p>

<p>
Charanjit&rsquo;s contribution is below the ~15 line threshold and thus
does not require copyright assignment to the Free Software
Foundation.
</p></li>

<li><p>
The renaming operations are now aware of the underlying version
control system and will use the appropriate command when a VCS is
available.  In practice, renaming a file under, say, Git will
register it as a &ldquo;rename&rdquo; instead of two separate actions of
deletion and addition.
</p>

<p>
Thanks to Florian for the patch.  It was discussed on the mailing
list and then underwent some changes:
<a href="https://lists.sr.ht/~protesilaos/denote/%3C166547153518.8.941129310186454444.68125516@aboulafia.org%3E">https://lists.sr.ht/~protesilaos/denote/%3C166547153518.8.941129310186454444.68125516@aboulafia.org%3E</a>.
</p></li>

<li>The <code>denote-rename-file-using-front-matter</code> no longer fails to carry
out its intended task when the front matter has no keywords.  If no
keywords are available, this is interpreted as a request to remove
the KEYWORDS component of the file name.  This was always
technically possible and could be achieved with various permutations
of the user option <code>denote-prompts</code> (as explained in its doc string
or the manual).  Denote only needs an identifier in the file name to
establish unique links (although I strongly encourage you to stick
to the standard file-naming scheme as it is informative, reliable,
and can work even if you access your data without Emacs).</li>
</ul>
</div>
</div>
<div id="outline-container-h:505c84dd-2959-4bd4-8af4-78d75592a6d5" class="outline-3">
<h3 id="h:505c84dd-2959-4bd4-8af4-78d75592a6d5"><span class="section-number-3">10.2.</span> For more advanced use-cases</h3>
<div class="outline-text-3" id="text-h:505c84dd-2959-4bd4-8af4-78d75592a6d5">
<ul class="org-ul">
<li><p>
The variable <code>denote-file-types</code> has been tweaked to respond
directly to changes in its value done with <code>setq</code>.  Thanks to Noboru
Ota for the patch: <a href="https://lists.sr.ht/~protesilaos/denote/%3C86k05gsqsg.fsf%40nobiot.com%3E">https://lists.sr.ht/~protesilaos/denote/%3C86k05gsqsg.fsf%40nobiot.com%3E</a>.
</p>

<p>
Noboru has assigned copyright to the Free Software Foundation.
</p></li>

<li>The <code>:front-matter</code> property of the <code>denote-file-types</code> now accepts
a nil value.  Denote could always work without front matter, but
this was not implemented flexibly in the <code>denote-file-types</code>.
Thanks to Noboru Ota (nobiot) for pointing this out on the mailing
list: <a href="https://lists.sr.ht/~protesilaos/denote/%3C86k05gsqsg.fsf%40nobiot.com%3E">https://lists.sr.ht/~protesilaos/denote/%3C86k05gsqsg.fsf%40nobiot.com%3E</a>.</li>

<li>The <code>denote-file-prompt</code> function now reads an optional
<code>INITIAL-TEXT</code> argument.  This is a string that prepopulates the
minibuffer.  It is useful for custom commands the user may have
where, for example, there is a need to automatically filter to
entries matching <code>_journal</code>.  Thanks to Alan Schmitt for suggesting
the idea: <a href="https://lists.sr.ht/~protesilaos/denote/%3C87pmf676n1.fsf@m4x.org%3E">https://lists.sr.ht/~protesilaos/denote/%3C87pmf676n1.fsf@m4x.org%3E</a>.</li>

<li>The <code>denote-rename-file-using-front-matter</code> accepts an optional
<code>AUTO-CONFIRM</code> argument.  It can either be passed interactively or
via Lisp.  The doc string (or the manual) explains the details.
Thanks to Elias Storms for the initial patch:
<a href="https://lists.sr.ht/~protesilaos/denote/%3Cm2a667aeku.fsf%40gmail.com%3E">https://lists.sr.ht/~protesilaos/denote/%3Cm2a667aeku.fsf%40gmail.com%3E</a>.</li>

<li>The <code>denote-prompt-for-date-return-id</code> function uses the familiar
<code>denote-date-prompt</code> and returns the appropriate identifier.  It is
used internally by some of our function, but we also provide it for
anyone who wants to write their own custom code.</li>

<li>The <code>denote-retrieve-or-create-file-identifier</code> function reads and
option <code>DATE</code> argument to its mandatory <code>FILE</code> argument.  If <code>FILE</code>
does not have an identifier and optional <code>DATE</code> is non-nil, the
function invokes the <code>denote-prompt-for-date-return-id</code>, as
mentioned above.</li>

<li><p>
The <code>denote-rename-file</code> command accepts an optional <code>DATE</code>
argument.  It functionally does what is described right above, with
the exception that this is for an interactive function (a
&ldquo;command&rdquo;).  Read the detailed doc string or the manual for
everything that pertains to this powerful command.
</p>

<p>
Thanks to Florian for suggesting the idea on the mailing list:
<a href="https://lists.sr.ht/~protesilaos/denote/%3C166521684647.7.5483179875879361874.67576870%40aboulafia.org%3E">https://lists.sr.ht/~protesilaos/denote/%3C166521684647.7.5483179875879361874.67576870%40aboulafia.org%3E</a>.
</p></li>

<li>The <code>denote-directory-text-only-files</code> function filters the
<code>denote-directory-files</code> to only return a list of text files.  This
leaves out, say, mp3 files.  The function is used internally, though
it may also prove useful in custom user code.</li>
</ul>
</div>
</div>
<div id="outline-container-h:0531047f-ef15-412e-b265-886c55526d57" class="outline-3">
<h3 id="h:0531047f-ef15-412e-b265-886c55526d57"><span class="section-number-3">10.3.</span> Miscellaneous refinements</h3>
<div class="outline-text-3" id="text-h:0531047f-ef15-412e-b265-886c55526d57">
<ul class="org-ul">
<li>Implemented a <code>revert-buffer-function</code> for the backlinks&rsquo; buffer,
which is produced by the command <code>denote-link-backlinks</code>.  This
revert function is what the <code>g</code> key invokes with the default key
bindings (the command is <code>revert-buffer</code>).  It produces the buffer
anew, updating the list of backlinks accordingly.</li>

<li><p>
Documented how to speed up the creation of the backlinks&rsquo; buffer.
As this depends on the built-in <code>xref</code> library, the change is done
by specifying the value of the user option <code>xref-search-program</code> in
Emacs 28 or higher.  For example:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (setq xref-search-program 'ripgrep)
</pre>
</div>

<p>
For something more elaborate:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  ;; Prefer ripgrep, then ugrep, and fall back to regular grep.
  (setq xref-search-program
        (cond
         ((or (executable-find "ripgrep")
              (executable-find "rg"))
          'ripgrep)
         ((executable-find "ugrep")
          'ugrep)
         (t
          'grep)))
</pre>
</div></li>

<li>Removed some minor duplication of effort in how the buttonisation of
links is done (what makes them clickable).</li>

<li>Made refinements to the definition of functions such as
<code>denote-link-add-links</code>.  There should be no noticeable change for
users, though this shows we care about code quality.</li>

<li>With Eshel Yaron, we tried to remove the empty indices for functions
and variables from the HTML version of the manual.  These indices
are useful in the Info version, which can be accessed directly from
Emacs when the <code>denote</code> package is installed (for example, evaluate
<code>(info "(denote) Top")</code>), but they do not work with HTML.  Alas,
what we tried to do did not work.  Maybe Org has a way to control
what is exported where.  We shall see.  At any rate, thanks to Eshel
for the effort: <a href="https://lists.sr.ht/~protesilaos/denote/patches/36028">https://lists.sr.ht/~protesilaos/denote/patches/36028</a>.</li>

<li>All code that integrates the <code>denote:</code> custom hyperlink type with
Org&rsquo;s link facility is now assigned <code>autoload</code> cookies.  These are
done to ensure that <code>denote</code> is loaded and is available in cases
where Org needs to access a <code>denote:</code> link at some early stage
(e.g. at startup before using Denote).  Thanks to Sven Seebeck for
reporting the problem: <a href="https://lists.sr.ht/~protesilaos/denote/%3C87r0zovwix.fsf%40svenseebeck.me%3E">https://lists.sr.ht/~protesilaos/denote/%3C87r0zovwix.fsf%40svenseebeck.me%3E</a>.
Although Sven could not reproduce a bug reliably, I believe this
prevents such an eventuality.</li>

<li>Expanded or otherwise updated the manual to account for all of the
above, where appropriate.</li>
</ul>
</div>
</div>
</div>
<div id="outline-container-h:053975d7-3fe2-49e5-96a0-336483e5861c" class="outline-2">
<h2 id="h:053975d7-3fe2-49e5-96a0-336483e5861c"><span class="section-number-2">11.</span> Version 1.0.0 on 2022-09-30</h2>
<div class="outline-text-2" id="text-h:053975d7-3fe2-49e5-96a0-336483e5861c">
<p>
This is the first major release of Denote.  A part of the changes
documented herein is for advanced users or developers who wish to
extend Denote with their custom code.  Though we first cover what
applies to everyone.
</p>
</div>
<div id="outline-container-h:25692d4f-08da-4938-a81e-54070d91f51a" class="outline-3">
<h3 id="h:25692d4f-08da-4938-a81e-54070d91f51a"><span class="section-number-3">11.1.</span> Changes for all users</h3>
<div class="outline-text-3" id="text-h:25692d4f-08da-4938-a81e-54070d91f51a">
<ul class="org-ul">
<li><p>
The custom Org hyperlink type of <code>denote:</code> can be visited from
outside the <code>denote-directory</code>.  We now provide the necessary glue
code that Org needs to store these <code>denote:</code> links.  Storing them
can be done with an <code>org-capture</code> template or via the command
<code>org-store-link</code>.  Use this to, for example, capture a TODO that
references one of your notes.
</p>

<p>
<code>denote:</code> links work for as long as the referenced file is somewhere
in the <code>denote-directory</code> or one of its subdirectories.
</p>

<p>
Thanks to Marc Fargas for the contribution.  Marc did not need to
assign copyright to the Free Software Foundation, as the patch was
within the ~15 line limit that is permissible.
</p>

<p>
The contribution was discussed on the mailing list:
<a href="https://lists.sr.ht/~protesilaos/denote/patches/35137">https://lists.sr.ht/~protesilaos/denote/patches/35137</a>.  A prior
exchange took place in issue 104 over at the GitHub mirror:
<a href="https://github.com/protesilaos/denote/issues/104">https://github.com/protesilaos/denote/issues/104</a>.
</p>

<p>
Some further tweaks were made to the relevant function.  Thanks to
Elias Storms for reporting on the mailing list a bug which revealed
a regression I introduced to the Org link storing mechanism:
<a href="https://lists.sr.ht/~protesilaos/denote/%3C15D55F4B-64D1-4083-AD5E-B5BACA8F1909%40ap.be%3E">https://lists.sr.ht/~protesilaos/denote/%3C15D55F4B-64D1-4083-AD5E-B5BACA8F1909%40ap.be%3E</a>.
</p></li>

<li><p>
Following from above, the command <code>denote-link-find-file</code> finds
files reliably, regardless of where the link is stored.  All it
needs is for the target file to be inside the <code>denote-directory</code>.
</p>

<p>
I discovered this while exchanging views with Marc Fargas regarding
the aforementioned patch: <a href="https://lists.sr.ht/~protesilaos/denote/patches/35137">https://lists.sr.ht/~protesilaos/denote/patches/35137</a>.
</p></li>

<li>The command <code>denote-link-buttonize-buffer</code>, which &ldquo;buttonizes&rdquo;
<code>denote:</code> links in plain text and Markdown files, now performs its
task regardless of where the current file is stored.  Those links
work for as long as the file they reference is somewhere inside the
<code>denote-directory</code>.</li>

<li><p>
The commands <code>denote-link-after-creating</code>, <code>denote-link-or-create</code>
provide a convenience for users who need to create link to notes
that may not exist yet.  The idea is that one is expounding on a
given topic and wants to create a link to a relevant issue.  They
are not sure if they have written anything about it yet, so they
invoke the relevant command.  Consult their doc strings or read the
manual: <a href="https://protesilaos.com/emacs/denote#h:9e41e7df-2aac-4835-94c5-659b6111e6de">https://protesilaos.com/emacs/denote#h:9e41e7df-2aac-4835-94c5-659b6111e6de</a>.
</p>

<p>
Thanks to user sienic for suggesting the idea and for testing the
prototypes.  And thanks to Juanjo Presa for participating in the
discussion to share the view that this functionality should be part of
denote.el.  This happened in issue 96 over at the GitHub mirror:
<a href="https://github.com/protesilaos/denote/issues/96">https://github.com/protesilaos/denote/issues/96</a>.
</p></li>

<li>The command <code>denote-open-or-create</code> offers the convenience of
visiting a file, if it exists, else prompting for its creation.
Thanks to Alan Schmitt for the contribution.  The patch was sent on
the mailing list: <a href="https://lists.sr.ht/~protesilaos/denote/%3C87fsgvddny.fsf%40protesilaos.com%3E">https://lists.sr.ht/~protesilaos/denote/%3C87fsgvddny.fsf%40protesilaos.com%3E</a>.
It is within the limit of what is allowed without assigning
copyright to the Free Software Foundation, though Alan has done the
relevant paperwork.</li>

<li>The manual expands on two sections: (1) Variants of
<code>denote-open-or-create</code>, (2) Variants of <code>denote-link-or-create</code>.
They show how one can use the above &ldquo;do or create&rdquo; commands with
different permutations of the Denote prompts for new note creation.</li>

<li><p>
The manual includes a section titled &ldquo;Create a note with the
region&rsquo;s contents&rdquo;.  Quote:
</p>

<blockquote>
<p>
Sometimes it makes sense to gather notes in a single file and later
review it to make multiple notes out of it.  With the following
code, the user marks a region and then invokes the command
<code>my-denote-create-new-note-from-region</code>: it prompts for a title and
keywords and then uses the region&rsquo;s contents to fill in the newly
created note.
</p>
</blockquote>

<p>
This is not part of denote.el, though we provide it in the manual
for users that may need it.  Thanks to sundar bp for suggesting the
idea.  This was done via a private channel and the information is
shared with permission.
</p></li>

<li><p>
The manual has another entry titled &ldquo;Split an Org subtree into its
own note&rdquo;, which is similar to the above idea of using the region&rsquo;s
contents but has some extra niceties provided by Org.  Quote:
</p>

<blockquote>
<p>
With Org files in particular, it is common to have nested headings which
could be split off into their own standalone notes.  In Org parlance an
entry with all its subheadings is a &ldquo;subtree&rdquo;.  With the following code,
the user places the point inside the heading they want to split off and
invokes the command <code>my-denote-split-org-subtree</code>.  It will create a
note using the heading&rsquo;s text and tags for the new file.  The contents
of the subtree become the contents of the new note and are removed from
the old one.
</p>
</blockquote>

<p>
Thanks to Sven Seebeck for suggesting the idea and for testing my
prototypes.  This information is shared with permission, as it was
provided via a private channel.
</p></li>

<li>The manual describes how a user can leverage the built-in
<code>dired-virtual-mode</code> to perform arbitrary sorting of their list of
notes.  It also includes code for Eshell to quickly &ldquo;export&rdquo; a
command&rsquo;s output into a dedicated buffer (which can then be used to
derive a &ldquo;virtual&rdquo; Dired).  Thanks to Yi Liu for asking the question
that inspired this entry:
<a href="https://lists.sr.ht/~protesilaos/denote/%3C1C75FF01-EC76-49DF-9AEB-ED718A2795FF@gmail.com%3E">https://lists.sr.ht/~protesilaos/denote/%3C1C75FF01-EC76-49DF-9AEB-ED718A2795FF@gmail.com%3E</a>.</li>

<li>The <code>denote-faces-broken-link</code> has been removed.  It was used for
Org links.  The idea was to apply a different style if the link was
broken.  However, the way fontification works means that there may
be a performance penalty as Org tries to check again and again if
the link is broken or note.  As <code>denote:</code> links are robust (unless
the user tries to break them), this penalty is unacceptable.  Thanks
to Peter Prevos for reporting the issue and discussing it with me on
the mailing list:
<a href="https://lists.sr.ht/~protesilaos/denote/%3C87k05umyyo.fsf%40prevos.net%3E">https://lists.sr.ht/~protesilaos/denote/%3C87k05umyyo.fsf%40prevos.net%3E</a>.</li>

<li>The &ldquo;denote&rdquo; group in Custom UI buffers now provides a link to the
Info manual that is shipped with the package.  To read the manual,
evaluate <code>(info "(denote) Top")</code>.  Else visit the official web page:
<a href="https://protesilaos.com/emacs/denote">https://protesilaos.com/emacs/denote</a>.</li>

<li>Fixed a case where an internal check for a note would throw an error
if the buffer was not visiting a file.  Thanks to Hilde Rhyne was
the patch: it is below the ~15 line threshold and thus does not
require copyright assignment to the Free Software Foundation.  The
issue was discussed on the mailing list and was pushed to users as
version <code>0.6.1</code>:
<a href="https://lists.sr.ht/~protesilaos/denote/%3Cm035d7nq22.fsf%40disroot.org%3E">https://lists.sr.ht/~protesilaos/denote/%3Cm035d7nq22.fsf%40disroot.org%3E</a>.</li>

<li>When linking to a file that has no front matter, Denote tries to use
the TITLE component of the file name (per our file-naming scheme) as
the link&rsquo;s descriptive text.  We now make this look a bit better, by
capitalising only the first letter while dehyphenating the text,
converting <code>this-is-a-test</code> to <code>This is a test</code>.  Before, we would
capitalise all words.  Thanks to Clemens Radermacher for the patch.
It was sent via a private channel.  Clemens has assigned copyright
to the Free Software Foundation.</li>
</ul>
</div>
</div>
<div id="outline-container-h:165cd056-5e27-4536-b8ac-57f88c927a43" class="outline-3">
<h3 id="h:165cd056-5e27-4536-b8ac-57f88c927a43"><span class="section-number-3">11.2.</span> Changes for developers or advanced users</h3>
<div class="outline-text-3" id="text-h:165cd056-5e27-4536-b8ac-57f88c927a43">
<p>
Lots of functions and variables which once were for &ldquo;private&rdquo; use (the
presence of double hyphens in the symbol) are now made public.
Concretely this means that they no longer have double hyphens in their
name and we pledge to support them henceforth.  &ldquo;Support&rdquo; means that
we (i) consider them stable, (ii) document them properly, (iii) will
record any changes made to them such as in a change log, a blog post
on my website, and via <code>make-obsolete</code>.
</p>

<p>
The manual provides a complete reference of what is on offer.  The
section is titled &ldquo;For developers or advanced users&rdquo;:
<a href="https://protesilaos.com/emacs/denote#h:c916d8c5-540a-409f-b780-6ccbd90e088e">https://protesilaos.com/emacs/denote#h:c916d8c5-540a-409f-b780-6ccbd90e088e</a>.
</p>

<p>
Normally, we do not support private forms and can delete/modify them
without notice.  However, I decided to write obsoletion aliases for
all forms I made public or otherwise revised, in an effort not to
break any existing custom code.  The following table covers all
obsolete symbols and their new counterparts.  PLEASE UPDATE YOUR CODE
as those aliases will be removed in the near future.
</p>

<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">


<colgroup>
<col  class="org-right" />

<col  class="org-left" />

<col  class="org-left" />
</colgroup>
<thead>
<tr>
<th scope="col" class="org-right">Index</th>
<th scope="col" class="org-left">Old symbol</th>
<th scope="col" class="org-left">New symbol</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-right">1</td>
<td class="org-left">denote&#x2013;id-format</td>
<td class="org-left">denote-id-format</td>
</tr>

<tr>
<td class="org-right">2</td>
<td class="org-left">denote&#x2013;id-regexp</td>
<td class="org-left">denote-id-regexp</td>
</tr>

<tr>
<td class="org-right">3</td>
<td class="org-left">denote&#x2013;title-regexp</td>
<td class="org-left">denote-title-regexp</td>
</tr>

<tr>
<td class="org-right">4</td>
<td class="org-left">denote&#x2013;keywords-regexp</td>
<td class="org-left">denote-keywords-regexp</td>
</tr>

<tr>
<td class="org-right">5</td>
<td class="org-left">denote&#x2013;punctuation-regexp</td>
<td class="org-left">denote-excluded-punctuation-regexp</td>
</tr>

<tr>
<td class="org-right">6</td>
<td class="org-left">denote-punctuation-excluded-extra-regexp</td>
<td class="org-left">denote-excluded-punctuation-extra-regexp</td>
</tr>

<tr>
<td class="org-right">7</td>
<td class="org-left">denote&#x2013;sluggify</td>
<td class="org-left">denote-sluggify</td>
</tr>

<tr>
<td class="org-right">8</td>
<td class="org-left">denote&#x2013;sluggify-and-join</td>
<td class="org-left">denote-sluggify-and-join</td>
</tr>

<tr>
<td class="org-right">9</td>
<td class="org-left">denote&#x2013;sluggify-keywords</td>
<td class="org-left">denote-sluggify-keywords</td>
</tr>

<tr>
<td class="org-right">10</td>
<td class="org-left">denote&#x2013;desluggify</td>
<td class="org-left">denote-desluggify</td>
</tr>

<tr>
<td class="org-right">11</td>
<td class="org-left">denote&#x2013;only-note-p</td>
<td class="org-left">denote-file-is-note-p</td>
</tr>

<tr>
<td class="org-right">12</td>
<td class="org-left">denote&#x2013;file-has-identifier-p</td>
<td class="org-left">denote-file-has-identifier-p</td>
</tr>

<tr>
<td class="org-right">13</td>
<td class="org-left">denote&#x2013;file-supported-extension-p</td>
<td class="org-left">denote-file-has-supported-extension-p</td>
</tr>

<tr>
<td class="org-right">14</td>
<td class="org-left">denote&#x2013;writable-and-supported-p</td>
<td class="org-left">denote-file-is-writable-and-supported-p</td>
</tr>

<tr>
<td class="org-right">15</td>
<td class="org-left">denote&#x2013;file-name-relative-to-denote-directory</td>
<td class="org-left">denote-get-file-name-relative-to-denote-directory</td>
</tr>

<tr>
<td class="org-right">16</td>
<td class="org-left">denote-link&#x2013;id-from-string</td>
<td class="org-left">denote-extract-id-from-string</td>
</tr>

<tr>
<td class="org-right">17</td>
<td class="org-left">denote&#x2013;directory-files</td>
<td class="org-left">denote-directory-files</td>
</tr>

<tr>
<td class="org-right">18</td>
<td class="org-left">denote&#x2013;subdirs</td>
<td class="org-left">denote-directory-subdirectories</td>
</tr>

<tr>
<td class="org-right">19</td>
<td class="org-left">denote&#x2013;get-note-path-by-id</td>
<td class="org-left">denote-get-path-by-id</td>
</tr>

<tr>
<td class="org-right">20</td>
<td class="org-left">denote&#x2013;directory-files-matching-regexp</td>
<td class="org-left">denote-directory-files-matching-regexp</td>
</tr>

<tr>
<td class="org-right">21</td>
<td class="org-left">denote&#x2013;retrieve-read-file-prompt</td>
<td class="org-left">denote-file-prompt</td>
</tr>

<tr>
<td class="org-right">22</td>
<td class="org-left">denote&#x2013;extract-keywords-from-path</td>
<td class="org-left">denote-extract-keywords-from-path</td>
</tr>

<tr>
<td class="org-right">23</td>
<td class="org-left">denote&#x2013;keywords-prompt</td>
<td class="org-left">denote-keywords-prompt</td>
</tr>

<tr>
<td class="org-right">24</td>
<td class="org-left">denote&#x2013;retrieve-filename-identifier</td>
<td class="org-left">denote-retrieve-filename-identifier</td>
</tr>

<tr>
<td class="org-right">25</td>
<td class="org-left">denote&#x2013;file-name-id</td>
<td class="org-left">denote-retrieve-or-create-file-identifier</td>
</tr>

<tr>
<td class="org-right">26</td>
<td class="org-left">denote&#x2013;retrieve-filename-title</td>
<td class="org-left">denote-retrieve-filename-title</td>
</tr>

<tr>
<td class="org-right">27</td>
<td class="org-left">denote&#x2013;retrieve-title-value</td>
<td class="org-left">denote-retrieve-title-value</td>
</tr>

<tr>
<td class="org-right">28</td>
<td class="org-left">denote&#x2013;retrieve-title-line</td>
<td class="org-left">denote-retrieve-title-line</td>
</tr>

<tr>
<td class="org-right">29</td>
<td class="org-left">denote&#x2013;retrieve-keywords-value</td>
<td class="org-left">denote-retrieve-keywords-value</td>
</tr>

<tr>
<td class="org-right">30</td>
<td class="org-left">denote&#x2013;retrieve-keywords-line</td>
<td class="org-left">denote-retrieve-keywords-line</td>
</tr>

<tr>
<td class="org-right">31</td>
<td class="org-left">denote&#x2013;format-file</td>
<td class="org-left">denote-format-file-name</td>
</tr>

<tr>
<td class="org-right">32</td>
<td class="org-left">denote&#x2013;barf-duplicate-id</td>
<td class="org-left">denote-barf-duplicate-id</td>
</tr>

<tr>
<td class="org-right">33</td>
<td class="org-left">denote&#x2013;title-prompt</td>
<td class="org-left">denote-title-prompt</td>
</tr>

<tr>
<td class="org-right">34</td>
<td class="org-left">denote&#x2013;file-type-prompt</td>
<td class="org-left">denote-file-type-prompt</td>
</tr>

<tr>
<td class="org-right">35</td>
<td class="org-left">denote&#x2013;date-prompt</td>
<td class="org-left">denote-date-prompt</td>
</tr>

<tr>
<td class="org-right">36</td>
<td class="org-left">denote&#x2013;subdirs-prompt</td>
<td class="org-left">denote-subdirectory-prompt</td>
</tr>

<tr>
<td class="org-right">37</td>
<td class="org-left">denote&#x2013;template-prompt</td>
<td class="org-left">denote-template-prompt</td>
</tr>

<tr>
<td class="org-right">38</td>
<td class="org-left">denote&#x2013;filetype-heuristics</td>
<td class="org-left">denote-filetype-heuristics</td>
</tr>

<tr>
<td class="org-right">39</td>
<td class="org-left">denote&#x2013;rename-file</td>
<td class="org-left">denote-rename-file-and-buffer</td>
</tr>

<tr>
<td class="org-right">40</td>
<td class="org-left">denote&#x2013;rename-file-prompt</td>
<td class="org-left">denote-rename-file-prompt</td>
</tr>
</tbody>
</table>

<p>
If you are writing code that extends Denote and feel that something is
either missing or has remained private, please contact us on the
mailing list, the GitHub/GitLab mirror, or send me an email directly.
I always respond in a timely fashion.
</p>
</div>
</div>
<div id="outline-container-h:27a391cf-8d5e-4d19-942f-46fc52dea80c" class="outline-3">
<h3 id="h:27a391cf-8d5e-4d19-942f-46fc52dea80c"><span class="section-number-3">11.3.</span> Open to everyone</h3>
<div class="outline-text-3" id="text-h:27a391cf-8d5e-4d19-942f-46fc52dea80c">
<p>
The most common feedback I get about Denote is that its documentation
is good.  As you can tell from these change logs, the plan is to
continue on this path.
</p>

<p>
Please note that the communication channels for Denote (mailing list,
mirrors, my personal email) are open to users of all levels.  Do not
hesitate to contact us/me.
</p>

<p>
Thanks again to everyone for their contributions, direct or indirect,
either in the form of code or the discussion of ideas.  Quoting from
the &ldquo;Acknowledgements&rdquo; section of the manual (all my packages have
such a section):
</p>

<blockquote>
<p>
Denote is meant to be a collective effort.  Every bit of help matters.
</p>

<dl class="org-dl">
<dt>Author/maintainer</dt><dd>Protesilaos Stavrou.</dd>

<dt>Contributions to code or the manual</dt><dd>Abin Simon, Alan Schmitt,
Benjamin Kästner, Clemens Radermacher, Colin McLear, Damien Cassou,
Eshel Yaron, Hilde Rhyne, Jack Baty, Jean-Philippe Gagné Guay, Jürgen
Hötzel, Kaushal Modi, Kyle Meyer, Marc Fargas, Peter Prevos, Philip
Kaludercic, Quiliro Ordóñez, Stefan Monnier.</dd>

<dt>Ideas and/or user feedback</dt><dd>Abin Simon, Alan Schmitt, Alfredo
Borrás, Benjamin Kästner, Colin McLear, Damien Cassou, Elias Storms,
Frank Ehmsen, Hanspeter Gisler, Jack Baty, Juanjo Presa, Kaushal
Modi, M. Hadi Timachi, Paul van Gelder, Peter Prevos, Shreyas
Ragavan, Summer Emacs, Sven Seebeck, Taoufik, Yi Liu, Ypot, atanasj,
hpgisler, pRot0ta1p, sienic, sundar bp.</dd>
</dl>

<p>
Special thanks to Peter Povinec who helped refine the file-naming
scheme, which is the cornerstone of this project.
</p>

<p>
Special thanks to Jean-Philippe Gagné Guay for the numerous
contributions to the code base.
</p>
</blockquote>
</div>
</div>
</div>
<div id="outline-container-h:50aba79a-d702-42b4-a2a5-7fa29033f904" class="outline-2">
<h2 id="h:50aba79a-d702-42b4-a2a5-7fa29033f904"><span class="section-number-2">12.</span> Version 0.6.0 on 2022-08-31</h2>
<div class="outline-text-2" id="text-h:50aba79a-d702-42b4-a2a5-7fa29033f904">
<p>
Denote is in a stable state.  I consider it feature-complete, without
prejudice to possible refinements to its existing feature set.  The next
version shall be <code>1.0.0</code>.
</p>
</div>
<div id="outline-container-h:566a770b-399e-47a6-9aa4-326fd6ade9a7" class="outline-3">
<h3 id="h:566a770b-399e-47a6-9aa4-326fd6ade9a7"><span class="section-number-3">12.1.</span> User-facing changes</h3>
<div class="outline-text-3" id="text-h:566a770b-399e-47a6-9aa4-326fd6ade9a7">
<ul class="org-ul">
<li>The Denote linking facility can now link to any file that has the
Denote file-naming scheme.  Before, we limited this feature to what we
consider &ldquo;note&rdquo; files, else the supported plain text formats (per
<code>denote-file-type</code>).  Thanks to Peter Prevos for the discussion on the
mailing list: <a href="https://lists.sr.ht/~protesilaos/denote/%3C87fsi1m5ze.fsf%40prevos.net%3E">https://lists.sr.ht/~protesilaos/denote/%3C87fsi1m5ze.fsf%40prevos.net%3E</a>.</li>

<li>Date prompts may optionally use the familiar Org date-selection
mechanism that leverages the calendar.  This feature is subject to the
user option <code>denote-date-prompt-use-org-read-date</code>.  A date prompt is
used by the <code>denote-date</code> command or, optionally, by the <code>denote</code>
command when the user option <code>denote-prompts</code> is configured
accordingly.  The manual elaborates on the specificities.  Thanks to
Jean-Philippe Gagné Guay for the contribution in pull request 97 at
the GitHub mirror: <a href="https://github.com/protesilaos/denote/pull/97">https://github.com/protesilaos/denote/pull/97</a>.</li>

<li><p>
Leading empty spaces at the <code>denote</code> <code>TITLE</code> prompt no longer produce
hyphens: they are simply ignored to keep file names consistent.
Thanks to Peter Prevos for the contribution in pull request 99 at the
GitHub mirror: <a href="https://github.com/protesilaos/denote/pull/99">https://github.com/protesilaos/denote/pull/99</a>.
</p>

<p>
[ Peter has started the process for copyright assignment to the Free
  Software Foundation, though the total contributions are still within
  the permitted boundaries. ]
</p></li>

<li>When linking to files that have no front matter, the link&rsquo;s anchor
text (the human-readable part) is derived from the file name <code>TITLE</code>
component.  We apply a de-hyphenation and capitalisation of its
constituent words.  This is not always perfect, but it is better than
something like <code>this-is-the-title</code>.  Thanks to Peter Prevos for the
original idea in pull request 93 at the GitHub mirror:
<a href="https://github.com/protesilaos/denote/pull/93">https://github.com/protesilaos/denote/pull/93</a>.</li>

<li><p>
The active region is now used as the default value of the <code>denote</code>
command <code>TITLE</code> prompt.  The idea behind this Do-What-I-Mean-flavoured
patch is to be able to take a note about a subject that appears in a
buffer by simply marking it before invoking the <code>denote</code> command.
</p>

<p>
Thanks to Eshel Yaron for the patch: <a href="https://lists.sr.ht/~protesilaos/denote/patches/34870">https://lists.sr.ht/~protesilaos/denote/patches/34870</a>.
It is below the ~15 line threshold that thus requires no copyright
assignment to the Free Software Foundation.
</p></li>

<li>The <code>denote-rename-file-using-front-matter</code> command now offers to save
the buffer if appropriate.  In the past, it would simply produce an
error asking the user to save the buffer.  Thanks to Peter Prevos for
the contribution in pull request 103 at he GitHub mirror:
<a href="https://github.com/protesilaos/denote/pull/103">https://github.com/protesilaos/denote/pull/103</a>.</li>

<li><p>
Fixed the text of the confirmation prompt in the command
<code>denote-migrate-old-markdown-yaml-tags</code>.  Thanks to Abin Simon for the
patch: <a href="https://lists.sr.ht/~protesilaos/denote/patches/34632">https://lists.sr.ht/~protesilaos/denote/patches/34632</a>.
</p>

<p>
This patchset also fixes (i) how a tag is identified for the purposes
of migrating old to new front matter, (ii) the regular expression for
Org front matter keywords
</p>

<p>
[ The total changes are below the ~15 line threshold and thus do not
  require copyright assignment to the Free Software Foundation. ]
</p></li>

<li><p>
Fixed a bug that prevented the creation of new notes.  Thanks to
Juergen Hoetzel for the contribution in pull request 84 at the GitHub
mirror: <a href="https://github.com/protesilaos/denote/pull/84">https://github.com/protesilaos/denote/pull/84</a>.  This was
done immediately after the release of version <code>0.5.0</code> on 2022-08-10
and was provided to users as version <code>0.5.1</code>
</p>

<p>
[ The change is below the ~15 line threshold. ]
</p></li>
</ul>
</div>
</div>
<div id="outline-container-h:9374b533-faaa-4ab4-b668-f74b5eae7ab5" class="outline-3">
<h3 id="h:9374b533-faaa-4ab4-b668-f74b5eae7ab5"><span class="section-number-3">12.2.</span> Internal refinements</h3>
<div class="outline-text-3" id="text-h:9374b533-faaa-4ab4-b668-f74b5eae7ab5">
<p>
These make the code simpler and more predictable.  As the individual
changes are not user-facing, I invite interested parties to consult the
Git log.  Special thanks to Jean-Philippe Gagné Guay for the multiple
contributions (and relevant discussions) over at the GitHub mirror:
</p>

<ul class="org-ul">
<li><a href="https://github.com/protesilaos/denote/pull/88">https://github.com/protesilaos/denote/pull/88</a></li>
<li><a href="https://github.com/protesilaos/denote/pull/89">https://github.com/protesilaos/denote/pull/89</a></li>
<li><a href="https://github.com/protesilaos/denote/pull/91">https://github.com/protesilaos/denote/pull/91</a></li>
<li><a href="https://github.com/protesilaos/denote/pull/94">https://github.com/protesilaos/denote/pull/94</a></li>
<li><a href="https://github.com/protesilaos/denote/pull/101">https://github.com/protesilaos/denote/pull/101</a></li>
<li><a href="https://github.com/protesilaos/denote/pull/102">https://github.com/protesilaos/denote/pull/102</a></li>
</ul>

<p>
[ Jean-Philippe has assigned copyright to the Free Software Foundation.
  It is required for non-trivial changes. ]
</p>
</div>
</div>
<div id="outline-container-h:c6fc05a2-ff31-4a0c-91a1-f64d2cfd6a16" class="outline-3">
<h3 id="h:c6fc05a2-ff31-4a0c-91a1-f64d2cfd6a16"><span class="section-number-3">12.3.</span> For advanced users</h3>
<div class="outline-text-3" id="text-h:c6fc05a2-ff31-4a0c-91a1-f64d2cfd6a16">
<p>
The variable <code>denote-file-types</code> is an alist of plists which
substantiates the supported file types (per the user option
<code>denote-file-type</code>).  Properties pertain to the formatting of front
matter and the retrieval of relevant values.  The doc string of
<code>denote-file-types</code> explains the details, while the default value uses
the ancillary functions we define.  Thanks to Jean-Philippe Gagné Guay
for the relevant contributions in pull request 89 at the GitHub mirror:
<a href="https://github.com/protesilaos/denote/pull/89">https://github.com/protesilaos/denote/pull/89</a>.
</p>
</div>
</div>
</div>
<div id="outline-container-h:80b9daaa-c3c8-4457-b109-966bb6a99832" class="outline-2">
<h2 id="h:80b9daaa-c3c8-4457-b109-966bb6a99832"><span class="section-number-2">13.</span> Version 0.5.0 on 2022-08-10</h2>
<div class="outline-text-2" id="text-h:80b9daaa-c3c8-4457-b109-966bb6a99832">
<p>
The general theme of this release is to refine what we already offer.
As I explained in some discussions, Denote is feature-complete.  We can
always improve the code or add some ancillary function/command/variable,
though all the main ideas have already been implemented.  Additional
functionality can be provided by other packages: I remain at the
disposal of anyone willing to write such a package.
</p>

<p>
The present release covers more than 150 commits since version 0.4.0 on
2022-07-25.
</p>

<p>
All release notes: <a href="https://protesilaos.com/emacs/denote-changelog">https://protesilaos.com/emacs/denote-changelog</a>.
</p>
</div>
<div id="outline-container-h:0878125f-8392-48e6-aeff-1469eb1e18fc" class="outline-3">
<h3 id="h:0878125f-8392-48e6-aeff-1469eb1e18fc"><span class="section-number-3">13.1.</span> Templates for new notes</h3>
<div class="outline-text-3" id="text-h:0878125f-8392-48e6-aeff-1469eb1e18fc">
<p>
We now provide the <code>denote-templates</code> user option.  A &ldquo;template&rdquo; is
arbitrary text that Denote will add to a newly created note right below
the front matter.
</p>

<p>
Templates are expressed as a <code>(KEY . STRING)</code> association.
</p>

<ul class="org-ul">
<li>The <code>KEY</code> is the name which identifies the template.  It is an
arbitrary symbol, such as <code>report</code>, <code>memo</code>, <code>statement</code>.</li>

<li>The <code>STRING</code> is ordinary text that Denote will insert as-is.  It can
contain newline characters to add spacing.  The manual of Denote
contains examples on how to use the <code>concat</code> function, beside writing
a generic string:
<a href="https://protesilaos.com/emacs/denote#h:f635a490-d29e-4608-9372-7bd13b34d56c">https://protesilaos.com/emacs/denote#h:f635a490-d29e-4608-9372-7bd13b34d56c</a>.</li>
</ul>

<p>
The user can choose a template either by invoking the new command
<code>denote-template</code> or by changing the user option <code>denote-prompts</code> to
always prompt for a template when calling the <code>denote</code> command.
</p>

<p>
Thanks to Jean-Philippe Gagné Guay for refinements to this facility.
Done in pull request 77 on the GitHub mirror:
<a href="https://github.com/protesilaos/denote/pull/77">https://github.com/protesilaos/denote/pull/77</a>.
</p>

<p>
[ Jean-Philippe has assigned copyright to the Free Software Foundation. ]
</p>
</div>
</div>
<div id="outline-container-h:17688b79-cb1b-4a59-831e-fbf2a81245d3" class="outline-3">
<h3 id="h:17688b79-cb1b-4a59-831e-fbf2a81245d3"><span class="section-number-3">13.2.</span> Revised format for Org <code>#+filetags</code> entry</h3>
<div class="outline-text-3" id="text-h:17688b79-cb1b-4a59-831e-fbf2a81245d3">
<p>
Denote used to format tags in Org files by separating them with two
spaces:
</p>

<pre class="example" id="org84d691b">
#+filetags:  tag1  tag2
</pre>

<p>
While this worked for some obvious use-cases, it is not supported by
Org.  The Org documentation stipulates that tags be separated by the
colon sign.  The above would then be written thus:
</p>

<pre class="example" id="org767f650">
#+filetags:  :tag1:tag2:
</pre>

<p>
Denote now conforms with Org&rsquo;s specifications.  To help users update
their existing notes, we provide the <code>denote-migrate-old-org-filetags</code>
command.  It will perform the conversion in all Org files that had the
old notation.  As with all Denote operations that rewrite file contents,
it DOES NOT SAVE BUFFERS.  The user is expected to review the changes,
such as by using <code>diff-buffer-with-file</code>.  Multiple buffers can be saved
with <code>save-some-buffers</code> (check its doc string).
</p>

<p>
This command is provided for the convenience of the user.  It shall be
deprecated and eventually removed from future versions of Denote.
</p>

<p>
If you need help with any of this, please do not hesitate to contact me
either in private or in one of Denote&rsquo;s official channels (mailing list,
GitHub/GitLab mirror).
</p>

<p>
Thanks to Alan Schmitt for bringing this matter to my attention:
<a href="https://lists.sr.ht/~protesilaos/denote/%3C871qu0jw5l.fsf%40protesilaos.com%3E">https://lists.sr.ht/~protesilaos/denote/%3C871qu0jw5l.fsf%40protesilaos.com%3E</a>.
Also thanks to Jean-Philippe Gagné Guay for commenting on it as it
helped me decide to include the command in <code>denote.el</code>:
<a href="https://github.com/protesilaos/denote/pull/83#issuecomment-1210167133">https://github.com/protesilaos/denote/pull/83#issuecomment-1210167133</a>.
</p>
</div>
</div>
<div id="outline-container-h:205a09cf-0159-425e-a6b3-41700fa3ad31" class="outline-3">
<h3 id="h:205a09cf-0159-425e-a6b3-41700fa3ad31"><span class="section-number-3">13.3.</span> Revised format for Markdown+YAML <code>tags:</code> entry</h3>
<div class="outline-text-3" id="text-h:205a09cf-0159-425e-a6b3-41700fa3ad31">
<p>
This is the same idea as above.  Before, we were making the mistake of
using incorrect YAML notation:
</p>

<div class="org-src-container">
<pre class="src src-yaml">tags:  tag1  tag2
</pre>
</div>

<p>
Now we do:
</p>

<div class="org-src-container">
<pre class="src src-yaml">tags:  ["tag1", "tag2"]
</pre>
</div>

<p>
This is how the TOML variant always worked.
</p>

<p>
For the user&rsquo;s convenience, we provide a command to migrate from the old
to the new syntax: <code>denote-migrate-old-markdown-yaml-tags</code>.
</p>
</div>
</div>
<div id="outline-container-h:15ecb4e8-d1ce-4e42-b74d-a3a046d93220" class="outline-3">
<h3 id="h:15ecb4e8-d1ce-4e42-b74d-a3a046d93220"><span class="section-number-3">13.4.</span> Changes to file renaming and front matter rewriting</h3>
<div class="outline-text-3" id="text-h:15ecb4e8-d1ce-4e42-b74d-a3a046d93220">
<p>
Denote adds &ldquo;front matter&rdquo; to newly created notes which includes data
such as the title and keywords/tags of the document.  Strictly speaking,
the front matter is not required by Denote.  It is provided for the
user&rsquo;s convenience, such as for readability or if they want to use the
note with other programs (e.g. Org export, a blog with Hugo/Jekyll,
&#x2026;).
</p>

<p>
Denote provides commands which help the user rename their notes, by
changing the file name&rsquo;s <code>TITLE</code> and/or <code>KEYWORDS</code> components (per
Denote&rsquo;s file-naming scheme).  These commands also operate on the front
matter to keep the data between file name and file contents in sync
(again, for the user&rsquo;s convenience).
</p>

<p>
For this release we have consolidated and refined our offerings in order
to improve their ergonomics.  All changes are the result of fruitful
discussions on the mailing list and the issue tracker of the GitHub
mirror:
</p>

<ul class="org-ul">
<li><a href="https://lists.sr.ht/~protesilaos/denote/%3C87k081l6vw.fsf%40silverstone.mail-host-address-is-not-set%3E">https://lists.sr.ht/~protesilaos/denote/%3C87k081l6vw.fsf%40silverstone.mail-host-address-is-not-set%3E</a></li>
<li><a href="https://lists.sr.ht/~protesilaos/denote/%3C878rogw5kk.fsf%40protesilaos.com%3E">https://lists.sr.ht/~protesilaos/denote/%3C878rogw5kk.fsf%40protesilaos.com%3E</a></li>
<li><a href="https://lists.sr.ht/~protesilaos/denote/%3C87fsiljv1s.fsf%40hu.mail-host-address-is-not-set%3E">https://lists.sr.ht/~protesilaos/denote/%3C87fsiljv1s.fsf%40hu.mail-host-address-is-not-set%3E</a></li>
<li><a href="https://lists.sr.ht/~protesilaos/denote/%3C87r122afe3.fsf%40hu.mail-host-address-is-not-set%3E">https://lists.sr.ht/~protesilaos/denote/%3C87r122afe3.fsf%40hu.mail-host-address-is-not-set%3E</a></li>
<li><a href="https://github.com/protesilaos/denote/issues/74">https://github.com/protesilaos/denote/issues/74</a></li>
</ul>

<p>
Thanks to (A-Z) Hanspeter Gisler, Jean-Philippe Gagné Guay, and Peter
Prevos for their participation.
</p>

<p>
Also thanks to Jean-Philippe Gagné Guay for relevant code contributions
(please consult the Git log for the minutiae):
</p>

<ul class="org-ul">
<li><a href="https://github.com/protesilaos/denote/pull/66">https://github.com/protesilaos/denote/pull/66</a></li>
<li><a href="https://github.com/protesilaos/denote/pull/67">https://github.com/protesilaos/denote/pull/67</a></li>
<li><a href="https://github.com/protesilaos/denote/pull/69">https://github.com/protesilaos/denote/pull/69</a></li>
<li><a href="https://github.com/protesilaos/denote/pull/75">https://github.com/protesilaos/denote/pull/75</a></li>
<li><a href="https://github.com/protesilaos/denote/pull/76">https://github.com/protesilaos/denote/pull/76</a></li>
</ul>
</div>
<div id="outline-container-h:1d695e54-1481-42dd-916b-c0542c48aa6f" class="outline-4">
<h4 id="h:1d695e54-1481-42dd-916b-c0542c48aa6f"><span class="section-number-4">13.4.1.</span> Renaming a single file</h4>
<div class="outline-text-4" id="text-h:1d695e54-1481-42dd-916b-c0542c48aa6f">
<p>
The commands <code>denote-dired-rename-file-and-add-front-matter</code> and
<code>denote-dired-rename-file</code> are deprecated and superseded by the new
<code>denote-rename-file</code>.  Please update any key bindings in your setup.
</p>

<p>
The difference between the old commands and the new <code>denote-rename-file</code>
is that the latter will now insert front matter to supported file types
(per <code>denote-file-type</code>) if they have none.  This basically means that,
e.g., renaming a generic Org/Markdown/Plain text file with
<code>denote-rename-file</code> will update its file name to comply with Denote&rsquo;s
file-naming scheme and also add the appropriate front matter (it
&ldquo;converts&rdquo; it to a Denote note).  If front matter exists, this command
will rewrite it to reflect the changes to the file name&rsquo;s <code>TITLE</code> and/or
<code>KEYWORDS</code>.
</p>

<p>
Consult the manual for the details:
<a href="https://protesilaos.com/emacs/denote#h:7cc9e000-806a-48da-945c-711bbc7426b0">https://protesilaos.com/emacs/denote#h:7cc9e000-806a-48da-945c-711bbc7426b0</a>.
</p>

<p>
Or, if the new version of the GNU ELPA package is installed, evaluate:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(info "(denote) Rename a single file")
</pre>
</div>

<p>
The user option <code>denote-dired-rename-expert</code> is obsolete.  Denote always
asks for confirmation when renaming a single file.  This is because the
user can rely on batch-renaming commands which ask for confirmation only
once per batch.
</p>
</div>
</div>
<div id="outline-container-h:82455fb4-576b-4753-af66-ac48fd158327" class="outline-4">
<h4 id="h:82455fb4-576b-4753-af66-ac48fd158327"><span class="section-number-4">13.4.2.</span> Renaming multiple files at once</h4>
<div class="outline-text-4" id="text-h:82455fb4-576b-4753-af66-ac48fd158327">
<p>
The command <code>denote-dired-rename-marked-files-and-add-front-matter</code> is
deprecated and its functionality is absorbed by the existing
<code>denote-dired-rename-marked-files</code> command.  The deprecated command was
used to insert front matter to supported file types (per
<code>denote-file-type</code>) that had none.  We now handle this internally, thus
streamlining the experience for the user.
</p>

<p>
Refer to the manual for the details:
<a href="https://protesilaos.com/emacs/denote#h:1b6b2c78-42f0-45b8-9ef0-6de21a8b2cde">https://protesilaos.com/emacs/denote#h:1b6b2c78-42f0-45b8-9ef0-6de21a8b2cde</a>
</p>

<p>
Assuming the latest Info manual is installed, evaluate:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(info "(denote) Rename multiple files at once")
</pre>
</div>
</div>
</div>
<div id="outline-container-h:d913e369-9325-46c4-985b-cf5b3e35372b" class="outline-4">
<h4 id="h:d913e369-9325-46c4-985b-cf5b3e35372b"><span class="section-number-4">13.4.3.</span> Renaming a single file based on its front matter</h4>
<div class="outline-text-4" id="text-h:d913e369-9325-46c4-985b-cf5b3e35372b">
<p>
Introduced the <code>denote-rename-file-using-front-matter</code> command.  This is
new functionality we provide which uses the front matter as input to
perform a rename of the file.  The aforementioned offerings prompt for
input via the minibuffer and propagate the changes firstly to the file
name and subsequently to the front matter.  Whereas with the command
<code>denote-rename-file-using-front-matter</code>, the user can edit the front
matter manually and then invoke the command to pass the changes to the
file name, subject to a confirmation.  Relevant entries are the title
and tags/filetags (depending on the file type).  The date and the
identifier are not pertinent.  Identifiers in file names are NEVER
rewritten by Denote.
</p>

<p>
Consult the manual:
<a href="https://protesilaos.com/emacs/denote#h:3ab08ff4-81fa-4d24-99cb-79f97c13a373">https://protesilaos.com/emacs/denote#h:3ab08ff4-81fa-4d24-99cb-79f97c13a373</a>.
</p>

<p>
With the latest package, evaluate:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(info "(denote) Rename a single file based on its front matter")
</pre>
</div>
</div>
</div>
<div id="outline-container-h:4efc6c14-fd71-4bd8-8bb1-e8e720b98eff" class="outline-4">
<h4 id="h:4efc6c14-fd71-4bd8-8bb1-e8e720b98eff"><span class="section-number-4">13.4.4.</span> Renaming multiple files based on their front matter</h4>
<div class="outline-text-4" id="text-h:4efc6c14-fd71-4bd8-8bb1-e8e720b98eff">
<p>
The command <code>denote-dired-rename-marked-files-using-front-matter</code>
completes the set of features we provide for syncing between file name
and front matter.  It applies to all marked files in a Dired buffer.
</p>

<p>
Read the manual to understand how the command works and what it does
exactly: <a href="https://protesilaos.com/emacs/denote#h:ea5673cd-e6ca-4c42-a066-07dc6c9d57f8">https://protesilaos.com/emacs/denote#h:ea5673cd-e6ca-4c42-a066-07dc6c9d57f8</a>.
</p>

<p>
Or evaluate:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(info "(denote) Rename multiple files based on their front matter")
</pre>
</div>
</div>
</div>
<div id="outline-container-h:32a103be-71a2-48e4-a18e-7727c04545ed" class="outline-4">
<h4 id="h:32a103be-71a2-48e4-a18e-7727c04545ed"><span class="section-number-4">13.4.5.</span> Add missing front matter on demand</h4>
<div class="outline-text-4" id="text-h:32a103be-71a2-48e4-a18e-7727c04545ed">
<p>
Sometimes the user may have incomplete front matter, perhaps due to a
mistake that was saved on disk.  The command <code>denote-add-front-matter</code>
appends a new front matter block to the current note.
</p>

<p>
Read:
<a href="https://protesilaos.com/emacs/denote#h:54b48277-e0e5-4188-ad54-ef3db3b7e772">https://protesilaos.com/emacs/denote#h:54b48277-e0e5-4188-ad54-ef3db3b7e772</a>
</p>

<p>
Or evaluate:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(info "(denote) Regenerate front matter")
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:507fb46c-a2e9-48a7-8cd2-53c5fc73394d" class="outline-3">
<h3 id="h:507fb46c-a2e9-48a7-8cd2-53c5fc73394d"><span class="section-number-3">13.5.</span> Faces for Denote links</h3>
<div class="outline-text-3" id="text-h:507fb46c-a2e9-48a7-8cd2-53c5fc73394d">
<p>
We provide the <code>denote-faces-link</code> and the <code>denote-faces-broken-link</code>.
The latter is only relevant for Org, as Emacs&rsquo; standard button mechanism
does not have a way to apply a face dynamically.
</p>

<p>
This is a change for themes/tinkerers who need to differentiate
<code>denote:</code> links from other links.  Otherwise, the presentation is the
same as before.
</p>

<p>
Thanks to Peter Prevos for asking about it on the mailing list:
<a href="https://lists.sr.ht/~protesilaos/denote/%3C03618bb20d3eaba78c32cd0cb63bfc71%40prevos.net%3E">https://lists.sr.ht/~protesilaos/denote/%3C03618bb20d3eaba78c32cd0cb63bfc71%40prevos.net%3E</a>.
</p>
</div>
</div>
<div id="outline-container-h:efa3049e-f1fa-48ff-af7d-d16edc677704" class="outline-3">
<h3 id="h:efa3049e-f1fa-48ff-af7d-d16edc677704"><span class="section-number-3">13.6.</span> Use of XDG path in <code>denote-directory</code></h3>
<div class="outline-text-3" id="text-h:efa3049e-f1fa-48ff-af7d-d16edc677704">
<p>
The default value of the <code>denote-directory</code> user option used to be
<code>~/Documents/notes</code> (subject to some conversion via Elisp).  Denote now
conforms with the freedesktop.org specifications by using the <code>XDG</code>
directory for <code>DOCUMENTS</code> instead of <code>~/Documents</code>:
<a href="https://www.freedesktop.org/wiki/Software/xdg-user-dirs/">https://www.freedesktop.org/wiki/Software/xdg-user-dirs/</a>.
</p>

<p>
Users who already bind the <code>denote-directory</code> are not affected by this
change.  Same for those who do not tinker with <code>XDG</code> environment
variables and/or do not use some exotic setup.
</p>

<p>
Thanks to Philip Kaludercic for the patch:
<a href="https://lists.sr.ht/~protesilaos/denote/patches/34561#%3C20220809115824.43089-1-philipk@posteo.net%3E">https://lists.sr.ht/~protesilaos/denote/patches/34561#%3C20220809115824.43089-1-philipk@posteo.net%3E</a>
</p>
</div>
</div>
<div id="outline-container-h:feb9a0ed-ba15-486e-ae11-5b222b00bc31" class="outline-3">
<h3 id="h:feb9a0ed-ba15-486e-ae11-5b222b00bc31"><span class="section-number-3">13.7.</span> Bespoke major-mode for the backlinks&rsquo; buffer</h3>
<div class="outline-text-3" id="text-h:feb9a0ed-ba15-486e-ae11-5b222b00bc31">
<p>
The backlinks&rsquo; buffer now uses the <code>denote-backlink-mode</code> instead of the
generic <code>special-mode</code>.  The former derives from the latter.  It binds
keys to move between links with <code>n</code> (next) and <code>p</code> (previous).  These
are stored in the <code>denote-backlink-mode-map</code> (use <code>M-x describe-mode</code>
(<code>C-h m</code>) in an unfamiliar buffer to learn more about it).
</p>

<p>
Thanks to Philip Kaludercic for the patch:
<a href="https://lists.sr.ht/~protesilaos/denote/patches/34561#%3C20220809115824.43089-2-philipk@posteo.net%3E">https://lists.sr.ht/~protesilaos/denote/patches/34561#%3C20220809115824.43089-2-philipk@posteo.net%3E</a>
</p>
</div>
</div>
<div id="outline-container-h:80217a39-86b8-4310-b7c4-dcc14e0b98fd" class="outline-3">
<h3 id="h:80217a39-86b8-4310-b7c4-dcc14e0b98fd"><span class="section-number-3">13.8.</span> Changes to the manual</h3>
<div class="outline-text-3" id="text-h:80217a39-86b8-4310-b7c4-dcc14e0b98fd">
<ul class="org-ul">
<li>Documented all of the aforementioned.  Improved how information is
presented and, generally, iterated on an already comprehensive
document.</li>

<li><p>
Introduced a node which explains how to tweak the front matter:
<a href="https://protesilaos.com/emacs/denote#h:7f918854-5ed4-4139-821f-8ee9ba06ad15">https://protesilaos.com/emacs/denote#h:7f918854-5ed4-4139-821f-8ee9ba06ad15</a>.
Or evaluate:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (info "(denote) Change the front matter format")
</pre>
</div></li>

<li><p>
Updated the reference to <code>consult-notes</code>.  This is a package that uses
the <code>consult</code> interface to provide access and search facilities for
notes.  It can integrate with Denote.  Thanks to Colin McLear for the
change in pull request 70 on the GitHub mirror:
<a href="https://github.com/protesilaos/denote/pull/70">https://github.com/protesilaos/denote/pull/70</a>.
</p>

<p>
[ The change is below the ~15 line threshold and thus does not require
  copyright assignment to the Free Software Foundation. ]
</p></li>
</ul>
</div>
</div>
<div id="outline-container-h:5d09d0af-3c25-4419-8448-90b8e1adab0d" class="outline-3">
<h3 id="h:5d09d0af-3c25-4419-8448-90b8e1adab0d"><span class="section-number-3">13.9.</span> Internal restructuring</h3>
<div class="outline-text-3" id="text-h:5d09d0af-3c25-4419-8448-90b8e1adab0d">
<ul class="org-ul">
<li><p>
All Denote code is consolidated in <code>denote.el</code>.  We no longer maintain
separate files like <code>denote-link.el</code>, <code>denote-dired.el</code>, etc.  Users
who had <code>require</code> calls to such libraries must remove them and only
keep:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (require 'denote)
</pre>
</div></li>

<li><p>
User options that have an entry in the manual will now provide a link
to it via their Help buffer and/or the Custom UI.  This is done by
adding the <code>:link</code> attribute to their declaration.
</p>

<p>
Furthermore, user options and faces now specify the version of Denote
that last affected their value (e.g. <code>denote-directory</code>, which was
mentioned above for the XDG spec, now informs the user that it changed
for version <code>0.5.0</code>).
</p>

<p>
[ I learnt these by developing the <code>modus-themes</code>. ]
</p></li>

<li>The variables <code>denote-last-title</code>, <code>denote-last-keywords</code>,
<code>denote-last-buffer</code>, and <code>denote-last-front-matter</code> are all obsolete.
These were used prior to version <code>0.1.0</code> to help with development but
are now deemed surplus to requirements.</li>

<li>Lots of changes were made to private functions, variables, doc
strings, and comments, in the interest of simplifying the code and/or
ensuring consistency in how operations are carried out.  Though
everything is the same for the end-user.</li>
</ul>

<p>
Thanks to Jean-Philippe Gagné Guay for the numerous contributions on the
GitHub mirror.  They are important for Denote, though the user does not
need to know what is happening internally (consult the Git log for the
details):
</p>

<ul class="org-ul">
<li><a href="https://github.com/protesilaos/denote/pull/65">https://github.com/protesilaos/denote/pull/65</a></li>
<li><a href="https://github.com/protesilaos/denote/pull/72">https://github.com/protesilaos/denote/pull/72</a></li>
<li><a href="https://github.com/protesilaos/denote/pull/73">https://github.com/protesilaos/denote/pull/73</a></li>
<li><a href="https://github.com/protesilaos/denote/pull/78">https://github.com/protesilaos/denote/pull/78</a></li>
<li><a href="https://github.com/protesilaos/denote/pull/80">https://github.com/protesilaos/denote/pull/80</a></li>
<li><a href="https://github.com/protesilaos/denote/pull/81">https://github.com/protesilaos/denote/pull/81</a></li>
<li><a href="https://github.com/protesilaos/denote/pull/82">https://github.com/protesilaos/denote/pull/82</a></li>
<li><a href="https://github.com/protesilaos/denote/pull/83">https://github.com/protesilaos/denote/pull/83</a></li>
</ul>
</div>
</div>
<div id="outline-container-h:79089c06-9e0c-49cc-9d53-a1a2fd72fb65" class="outline-3">
<h3 id="h:79089c06-9e0c-49cc-9d53-a1a2fd72fb65"><span class="section-number-3">13.10.</span> Discussions</h3>
<div class="outline-text-3" id="text-h:79089c06-9e0c-49cc-9d53-a1a2fd72fb65">
</div>
<div id="outline-container-h:87e4556a-4864-4955-a98c-62b2e6a509c3" class="outline-4">
<h4 id="h:87e4556a-4864-4955-a98c-62b2e6a509c3"><span class="section-number-4">13.10.1.</span> Encrypting Denote notes</h4>
<div class="outline-text-4" id="text-h:87e4556a-4864-4955-a98c-62b2e6a509c3">
<p>
Paul van Gelder asked about this on the mailing list.  I provided
guidelines on what can be done, though did not record anything in the
manual: I prefer to elicit more feedback from users.  The gist is that
Emacs already has all the requisite functionality, though encryption per
se is outside the scope of Denote:
<a href="https://lists.sr.ht/~protesilaos/denote/%3C1123434736.64290.1658954014673%40kpc.webmail.kpnmail.nl%3E">https://lists.sr.ht/~protesilaos/denote/%3C1123434736.64290.1658954014673%40kpc.webmail.kpnmail.nl%3E</a>.
</p>

<p>
Denote&rsquo;s relevant internal mechanisms will recognise files ending in
<code>.gpg</code> (e.g. for fontification in Dired).
</p>
</div>
</div>
<div id="outline-container-h:d94ee5e3-0a54-404c-b44b-34edc3703fbc" class="outline-4">
<h4 id="h:d94ee5e3-0a54-404c-b44b-34edc3703fbc"><span class="section-number-4">13.10.2.</span> Visualise usage of Denote keywords</h4>
<div class="outline-text-4" id="text-h:d94ee5e3-0a54-404c-b44b-34edc3703fbc">
<p>
Peter Prevos shared a proof-of-concept way to visualise keywords in the
<code>denote-directory</code> and show usage statistics:
<a href="https://lists.sr.ht/~protesilaos/denote/%3Ce9e5d6ae85984b51067b47f4d8e134fa%40prevos.net%3E">https://lists.sr.ht/~protesilaos/denote/%3Ce9e5d6ae85984b51067b47f4d8e134fa%40prevos.net%3E</a>.
</p>

<p>
We do not include this information in the manual, as we wait for the
fully fledged code.  Though do give it a try if you are interested and,
perhaps, share your thoughts for Peter&rsquo;s consideration.
</p>
</div>
</div>
<div id="outline-container-h:0cbf504c-676c-436e-8ae8-e7115368e691" class="outline-4">
<h4 id="h:0cbf504c-676c-436e-8ae8-e7115368e691"><span class="section-number-4">13.10.3.</span> Conflict between <code>denote-dired-mode</code> and <code>diredfl-mode</code></h4>
<div class="outline-text-4" id="text-h:0cbf504c-676c-436e-8ae8-e7115368e691">
<p>
Hilde Rhyne shared a workaround they have to disable <code>diredfl-mode</code> in
the buffers where <code>denote-dired-mode</code> is enabled.  The conflict between
the two is a known issue that is acknowledged in the manual:
<a href="https://lists.sr.ht/~protesilaos/denote/%3Cm0tu6q6bg0.fsf%40disroot.org%3E">https://lists.sr.ht/~protesilaos/denote/%3Cm0tu6q6bg0.fsf%40disroot.org%3E</a>.
</p>

<p>
I think we need a proper solution in the code we provide, so this
workaround is not mentioned in the manual.
</p>
</div>
</div>
<div id="outline-container-h:068108f4-a4fa-4ff8-be49-f1f10a862451" class="outline-4">
<h4 id="h:068108f4-a4fa-4ff8-be49-f1f10a862451"><span class="section-number-4">13.10.4.</span> Why doesn&rsquo;t Denote provide a search facility?</h4>
<div class="outline-text-4" id="text-h:068108f4-a4fa-4ff8-be49-f1f10a862451">
<p>
There was a discussion started by Fourchaux, with the participation of
basaran and Andre0991 on the GitHub mirror:
<a href="https://github.com/protesilaos/denote/issues/71">https://github.com/protesilaos/denote/issues/71</a>.
</p>

<p>
The gist of my answer is that Denote does not need to provide such a
facility because notes are ordinary files: whatever the user already has
for them should apply to Denote.  If the user has nothing to search
through files, they anyhow need something that works outside the
confines of Denote: a <code>denote-SEARCH</code> command is not an adequate
solution.
</p>

<p>
Emacs has numerous built-in commands, such as <code>grep</code> (<code>lgrep</code> and
<code>rgrep</code>), <code>project-find-regexp</code>, <code>find-grep-dired</code>, <code>ibuffer-do-occur</code>,
&#x2026;  Furthermore, there are lots of high quality packages that have
their own wrappers or extensions for searching file contents, such as
the <code>ivy</code> and <code>helm</code> completion frameworks, as well as <code>consult</code> (the
commands <code>consult-grep</code> and <code>consult-ripgrep</code>), <code>consult-notes</code>, <code>rg</code>,
<code>deadgrep</code>, <code>deft</code>, and probably plenty more that do not come to mind
right now.
</p>

<p>
I strongly encourage the user to find a universal search solution to the
problem of searching file contents.
</p>
</div>
</div>
</div>
</div>
<div id="outline-container-h:1c8098ee-089c-4511-bc6a-4140aab01321" class="outline-2">
<h2 id="h:1c8098ee-089c-4511-bc6a-4140aab01321"><span class="section-number-2">14.</span> Version 0.4.0 on 2022-07-25</h2>
<div class="outline-text-2" id="text-h:1c8098ee-089c-4511-bc6a-4140aab01321">
<ul class="org-ul">
<li><p>
Defined the <code>denote-link-dired-marked-notes</code> command.  It lets the
user produce a typographic list of links to the note files that are
marked in Dired.  The list is written at point.  If there are multiple
buffers which visit Denote notes, the command first prompts with
minibuffer completion for one among them.
</p>

<p>
In terms of workflow, <code>denote-link-dired-marked-notes</code> complements the
<code>denote-link-add-links</code> command for those cases where it is easier to
select files than write an elegant regular expression.
</p></li>

<li><p>
Implemented the <code>denote-dired-rename-marked-files</code> command.  This
provides a much-requested facility to perform the familiar renaming
operation on a set of files.  In particular:
</p>

<ul class="org-ul">
<li>the file&rsquo;s existing file name is retained and becomes the <code>TITLE</code>
field, per Denote&rsquo;s file-naming scheme;</li>

<li>the <code>TITLE</code> is sluggified and downcased, per our conventions;</li>

<li>an identifier is prepended to the <code>TITLE</code>;</li>

<li>the file&rsquo;s extension is retained;</li>

<li>a prompt is asked once for the <code>KEYWORDS</code> field and the input is
applied to all file names;</li>

<li>if the file is recognised as a Denote note, the command rewrites its
front matter to include the new keywords.  A confirmation to carry
out this step is performed once at the outset.  Note that the
affected buffers are not saved.  The user can thus check them to
confirm that the new front matter does not cause any problems
(e.g. with the command <code>diff-buffer-with-file</code>).  Multiple buffers
can be saved with <code>save-some-buffers</code> (read its doc string).</li>
</ul>

<p>
Parts of <code>denote-dired-rename-marked-files</code> were added or refined over
a series of commits.  Consult the Git log for the minutia.  Thanks to
Jean-Philippe Gagné Guay for the relevant additions in pull requests
51 and 52 on the GitHub mirror:
</p>

<ul class="org-ul">
<li><a href="https://github.com/protesilaos/denote/pull/51">https://github.com/protesilaos/denote/pull/51</a></li>
<li><a href="https://github.com/protesilaos/denote/pull/52">https://github.com/protesilaos/denote/pull/52</a></li>
</ul>

<p>
Jean-Philippe has assigned copyright to the Free Software Foundation.
</p></li>

<li>Improved how the <code>denote-dired-rename-file</code> command rewrites front
matter.  Before, it would perform a replacement of the whole block,
which had the adverse effect of overwriting custom front matter
entries.  Now, it only targets the lines which hold the title and
keywords, leaving everything else intact.  Thanks to Peter Prevos for
reporting the problem and testing the solution to it in issue 60 on
the GitHub mirror: <a href="https://github.com/protesilaos/denote/issues/60">https://github.com/protesilaos/denote/issues/60</a>.</li>

<li><p>
Introduced the <code>denote-dired-rename-file-and-add-front-matter</code> command
that always prepends front matter to a file whose extension is among
the supported ones (per the user option <code>denote-file-type</code>).  This
differs from the standard <code>denote-dired-rename-file</code> command which
only rewrites the front matter&rsquo;s title and keywords if they exist.
</p>

<p>
In practice, <code>denote-dired-rename-file-and-add-front-matter</code> empowers
the user to convert a generic text file to a Denote note.
</p>

<p>
This command was originally added by Jean-Philippe Gagné Guay in pull
request 49 on the GitHub mirror and refined in subsequent commits:
<a href="https://github.com/protesilaos/denote/pull/49">https://github.com/protesilaos/denote/pull/49</a>.  Also read issue 48
where this idea was originally discussed:
<a href="https://github.com/protesilaos/denote/issues/48">https://github.com/protesilaos/denote/issues/48</a>.
</p></li>

<li>Added the <code>denote-dired-rename-marked-files-and-add-front-matters</code>
command, which is like the <code>denote-dired-rename-marked-files</code> but adds
front matter instead of rewriting existing one, just how the command
<code>denote-dired-rename-file-and-add-front-matter</code> does it (both are
mentioned above).  Thanks to Jean-Philippe Gagné Guay for the
refinements to it in pull request 53 on the GitHub mirror:
<a href="https://github.com/protesilaos/denote/pull/53">https://github.com/protesilaos/denote/pull/53</a>.</li>

<li>Wrote an interactive spec for <code>denote-link-buttonize-buffer</code>.  It can
now be invoked with <code>M-x</code> or a key binding, should the need arise.
This function is normally called via a hook and takes effect in plain
text as well as Markdown files.</li>

<li><p>
Extended the fontification rules so that file names with non-ASCII
characters are styled properly.  This issue was brought up on the
mailing list by Frank Ehmsen and was discussed with the participation
of Peter Prevos:
<a href="https://lists.sr.ht/~protesilaos/denote/%3C2273b3b1-344c-6c6e-3ab6-a227b6bc3721%40eh-is.de%3E">https://lists.sr.ht/~protesilaos/denote/%3C2273b3b1-344c-6c6e-3ab6-a227b6bc3721%40eh-is.de%3E</a>.
</p>

<p>
The same topic was raised at the same time on the GitHub mirror by
user hpgisler in issue 61:
<a href="https://github.com/protesilaos/denote/issues/61">https://github.com/protesilaos/denote/issues/61</a>.
</p>

<p>
After some discussion, we agreed on the right approach, which was
formalised by Peter Prevos as pull request 64 on the GitHub mirror:
<a href="https://github.com/protesilaos/denote/pull/64">https://github.com/protesilaos/denote/pull/64</a>.  The change is below
the ~15 line threshold and thus does not require copyright assignment
to the Free Software Foundation.
</p></li>

<li>Made the registration of the <code>denote:</code> custom Org hyperlink type
conditional on the availability of the <code>org</code> feature.  In other words,
those who do not use Org will not be loading this part of the code.
Thanks to Abin Simon for reporting the problem and for showing how
Elfeed handles this case.  This was done in issue 47 on the GitHub
mirror: <a href="https://github.com/protesilaos/denote/issues/47">https://github.com/protesilaos/denote/issues/47</a>.</li>

<li>Ensured that duplicate keywords are not produced by the relevant
prompt.  Thanks to user Taoufik for the contribution in pull request
50 on the GitHub mirror: <a href="https://github.com/protesilaos/denote/pull/50">https://github.com/protesilaos/denote/pull/50</a>.
The change is below the ~15 line threshold and thus does not require
copyright assignment to the Free Software Foundation.</li>

<li>Fixed a typo in the reference to the <code>crm-separator</code> in the manual.
David Wilson (System Crafters channel) spotted the error in a recent
live stream whose main topic was about Denote (thanks, by the way!):
<a href="https://www.youtube.com/watch?v=QcRY_rsX0yY">https://www.youtube.com/watch?v=QcRY_rsX0yY</a>.</li>

<li>Addressed an inconsistency in the command <code>denote-link-find-file</code>
where it would not recognise links without a title in their format
(those can be inserted by passing a prefix argument (<code>C-u</code> by default)
to the commands that insert links, such as <code>denote-link</code>).</li>

<li>Attached conditionality to the <code>denote</code> command&rsquo;s <code>SUBDIRECTORY</code>
argument, so that it does not create new file paths.  This is only
relevant for those who call <code>denote</code> from Lisp.  Interactive use is
the same as before.</li>

<li>Clarified that the user option <code>denote-org-capture-specifiers</code> can
accept arbitrary text in addition to the formatting specifiers that
Org&rsquo;s capture mechanism introduces.</li>

<li>Explained in the manual why <code>denote-org-capture-specifiers</code> is needed
instead of writing the capture template directly the way one normally
does.  The gist is that because our file names are derived dynamically
based on user input, we need to account for the sequence in which the
value of arguments is reified by <code>org-capture</code>.</li>

<li>Refactored how notes are prepared internally.  Thanks to Jean-Philippe
Gagné Guay for the contribution in pull request 55 on the GitHub
mirror: <a href="https://github.com/protesilaos/denote/pull/55">https://github.com/protesilaos/denote/pull/55</a>.</li>

<li><p>
Declared the <code>denote-punctuation-excluded-extra-regexp</code> variable which
is, for the time being, targeted at experienced users.  Its purpose is
to extend what we consider &ldquo;illegal&rdquo; punctuation for the file name.
Thanks to pRot0ta1p for the feedback in issue 57 over at the GitHub
mirror: <a href="https://github.com/protesilaos/denote/issues/57">https://github.com/protesilaos/denote/issues/57</a>.  Example
based on the input of pRot0ta1p:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (setq denote-punctuation-excluded-extra-regexp
        "[『』〖〗｛｝「」【】〔〕［］（）《》〈〉«»！＃￥％…＆＂＇＊，。；：、？—]*")
</pre>
</div>

<p>
The ideal is to make <code>denote--punctuation-regexp</code> work for all
scripts, but that may be unrealistic.
</p></li>

<li>Clarified what the manual means by &ldquo;attachments&rdquo; to notes.  Those are
for Org, if the user resorts to the relevant Org mechanisms.  Denote
does not do any of that.</li>

<li><p>
Revised the parsing of a date input as used in the <code>denote-date</code>
command or related.  The idea is to turn <code>2020-01-15</code> into something
like <code>2020-01-15 16:19</code> by using the current time, so that the hour
and minute component is not left to <code>00:00</code> when the user does not
specify it explicitly.
</p>

<p>
This reduces the burden on the user who would otherwise need to input
the time value in order to avoid the error of duplicate identifiers in
the scenario where the same date is used more than once.
</p>

<p>
The change also addresses a difference between Emacs 28 and Emacs 29
where the former does not read dates without a time component.
</p>

<p>
Thanks to Peter Prevos for the feedback in issue 58 over at the GitHub
mirror: <a href="https://github.com/protesilaos/denote/issues/58">https://github.com/protesilaos/denote/issues/58</a>.
</p></li>

<li>Fixed compilation warnings in Emacs 29 about the format of doc strings
that need to output a literal single quote.  Thanks to Kyle Meyer for
the patch, which was sent on the mailing list:
<a href="https://lists.sr.ht/~protesilaos/denote/patches/34117">https://lists.sr.ht/~protesilaos/denote/patches/34117</a>.</li>

<li>Fixed typo in the user option <code>denote-prompts</code> about the
<code>crm-separator</code>.  Thanks to Kyle Meyer for the patch, which was sent
on the mailing list:
<a href="https://lists.sr.ht/~protesilaos/denote/patches/34116">https://lists.sr.ht/~protesilaos/denote/patches/34116</a>.</li>

<li>Made the built-in <code>subr-x</code> library a runtime dependency, due to
complications with the <code>when-let*</code> form.  The problem was made
manifest in a renaming operation, though it was not about renaming per
se.  Thanks to hpgisler for reporting the problem in issue 62 and for
testing the proposed solution:
<a href="https://github.com/protesilaos/denote/issues/62">https://github.com/protesilaos/denote/issues/62</a>.</li>

<li>Streamlined the use of the <code>seq</code> library instead of <code>cl-lib</code>, as we
were already using the former more heavily and there was no need for
the latter.  Thanks to Philip Kaludercic for pointing this out on the
emacs-devel mailing list:
<a href="https://lists.gnu.org/archive/html/emacs-devel/2022-07/msg00838.html">https://lists.gnu.org/archive/html/emacs-devel/2022-07/msg00838.html</a>.</li>

<li>Added a generic <code>README.md</code> file to placate the Git forges.  Neither
SourceHut nor GitHub/GitLab are fully compliant with the Org markup we
use in <code>README.org</code> (we use Org because it is easy to generate the
Info manual and HTML pages out of it).  SourceHut will not render the
file at all, while the others render it but do not parse it properly.</li>

<li>Made several other internal tweaks and refinements in the interest of
robustness and/or clarity.</li>

<li>Rewrote all relevant documentation.</li>
</ul>
</div>
<div id="outline-container-h:0ac79968-a575-4380-addc-d58cc2b5f627" class="outline-3">
<h3 id="h:0ac79968-a575-4380-addc-d58cc2b5f627"><span class="section-number-3">14.1.</span> Non-changes</h3>
<div class="outline-text-3" id="text-h:0ac79968-a575-4380-addc-d58cc2b5f627">
<p>
The following are not part of any changes that were made during this
release cycle, though they provide potentially interesting insight into
the workings of the project.
</p>

<dl class="org-dl">
<dt>Identifiers with milliseconds</dt><dd>Denote&rsquo;s identifier format extends up
to seconds.  This is the product of years of experimentation and is,
in my opinion, the best compromise between usability/readability and
precision.  If a user produces two notes within a fraction of a
second, then yes they will have duplicate identifiers.  In principle,
there is no reason not to address this potential problem, provided we
do not compromise on Denote&rsquo;s file-naming scheme (making the
identifier less readable is a compromise).  We shall see what the best
course of action is.  Thanks to Felipe Balbi and Jean-Philippe Gagné
Guay for the discussion thus far in issue 54 on the GitHub mirror:
<a href="https://github.com/protesilaos/denote/issues/54">https://github.com/protesilaos/denote/issues/54</a>.</dd>

<dt>Denote and evil-mode</dt><dd>Users of evil-mode do not have to worry about
Denote, as we do not define any key bindings.  The manual includes
sample configuration, which proposes some key bindings, but that is
the user&rsquo;s prerogative.  Thanks to Saša Janiška and Alan Schmitt for
their participation on the mailing list:
<a href="https://lists.sr.ht/~protesilaos/denote/%3C87czdxf1dz.fsf%40atmarama.ddns.net%3E">https://lists.sr.ht/~protesilaos/denote/%3C87czdxf1dz.fsf%40atmarama.ddns.net%3E</a>.</dd>

<dt>Denote and Citar</dt><dd>Peter Prevos started developing a package that
connects Denote with Citar: <a href="https://github.com/pprevos/denote-citar">https://github.com/pprevos/denote-citar</a>.
The idea is to use notes as part of one&rsquo;s bibliography.  Discussions
which include sample code on how to leverage <code>denote</code> from Lisp:

<ul class="org-ul">
<li><a href="https://lists.sr.ht/~protesilaos/denote/%3C6add8bc63cab0a557fa4b9919e025afc%40prevos.net%3E">https://lists.sr.ht/~protesilaos/denote/%3C6add8bc63cab0a557fa4b9919e025afc%40prevos.net%3E</a></li>
<li><a href="https://lists.sr.ht/~protesilaos/denote/%3C87r12d2w96.fsf%40protesilaos.com%3E">https://lists.sr.ht/~protesilaos/denote/%3C87r12d2w96.fsf%40protesilaos.com%3E</a></li>
<li><a href="https://lists.sr.ht/~protesilaos/denote/%3C87a69060q6.fsf%40protesilaos.com%3E">https://lists.sr.ht/~protesilaos/denote/%3C87a69060q6.fsf%40protesilaos.com%3E</a></li>
</ul></dd>

<dt>Denote and graph of connections</dt><dd>Saša Janiška asked whether Denote
will provide some way to visualise links between notes.  The answer is
negative.  Denote&rsquo;s scope is clearly delineated and its feature set is
largely complete (notwithstanding refinements to what we already
provide).  Peter Prevos is experimenting with some code that uses the
R language.  Any such facility will have to be implemented as a
separate package.  I remain at the disposal of anyone who needs help
with Denote&rsquo;s internals.  Thanks to the aforementioned fellows for
their participation on the mailing list:
<a href="https://lists.sr.ht/~protesilaos/denote/%3C878roleze1.fsf%40atmarama.ddns.net%3E">https://lists.sr.ht/~protesilaos/denote/%3C878roleze1.fsf%40atmarama.ddns.net%3E</a>.</dd>

<dt>Denote&rsquo;s scalability</dt><dd>There was a discussion whether Denote will
work well with very large sets of files.  The short answer is that it
will work the same way Emacs and/or standard Unix tools do: good
enough!  If there are improvements to be made, which do not jeopardise
the principles of the project, we shall implement them without
hesitation.  Thanks to Saša Janiška and Peter Prevos for their
participation on the mailing list:
<a href="https://lists.sr.ht/~protesilaos/denote/%3C87sfmtf7im.fsf%40atmarama.ddns.net%3E">https://lists.sr.ht/~protesilaos/denote/%3C87sfmtf7im.fsf%40atmarama.ddns.net%3E</a>.</dd>

<dt>Denote&rsquo;s minimum requirement of Emacs 27.2</dt><dd><p>
We cannot depend on
Emacs 27.1 due to this message from the byte compiler:
</p>

<pre class="example">
You should depend on (emacs "27.2") or the (org "9.3") package if you need `org-link-open-as-file'.
</pre>


<p>
Depending on Org is not an option because Denote optionally works
without Org, so Emacs 27.2 is what we have to opt for.  If your
operating system does not provide this version in package format,
please petition its maintainers/providers to do so.  Thanks to
Alexander for asking about it on the mailing list:
<a href="https://lists.sr.ht/~protesilaos/denote/%3C9ec818e6a7979efbb2f8b1f5a497665b%40purelymail.com%3E">https://lists.sr.ht/~protesilaos/denote/%3C9ec818e6a7979efbb2f8b1f5a497665b%40purelymail.com%3E</a>.
</p></dd>
</dl>

<p>
Finally, a mildly interesting piece of trivia: we have exceeded 600
commits since the first day of the project&rsquo;s Git history on 2022-06-04
(the actual history is much longer).  That averages to more than 10 per
day!  I think things will slow down eventually.
</p>
</div>
</div>
</div>
<div id="outline-container-h:6864cfd4-d0be-4c89-b313-39ba6e892a03" class="outline-2">
<h2 id="h:6864cfd4-d0be-4c89-b313-39ba6e892a03"><span class="section-number-2">15.</span> Version 0.3.0 on 2022-07-11</h2>
<div class="outline-text-2" id="text-h:6864cfd4-d0be-4c89-b313-39ba6e892a03">
<ul class="org-ul">
<li><p>
Fixed how references are analysed to produce the backlinks&rsquo; buffer.
This should resolve the issue that some users faced where the
backlinks would not be produced.
</p>

<p>
The previous implementation would not yield the appropriate results if
(i) the value of the user option <code>denote-directory</code> was a &ldquo;project&rdquo;
per the built-in project.el and (ii) the link to the given entry was
from a subdirectory.  In short, the references were sometimes returned
as relative file paths, whereas they should always be absolute.
Thanks to Jean-Philippe Gagné Guay for the feedback in issue 42 over
at the GitHub mirror: <a href="https://github.com/protesilaos/denote/pull/42">https://github.com/protesilaos/denote/pull/42</a>.
</p>

<p>
[ Jean-Philippe has assigned copyright to the Free Software
  Foundation.  It is a prerequisite for contributing to core Emacs
  and/or any package distributed via the official GNU ELPA. ]
</p></li>

<li><p>
Addressed a regression in the function <code>denote-directory</code> (this is the
function that normalises the variable of the same name) which
prevented it from returning an expanded file path.  This too
contributed to problems with the backlinking facility.  Thanks to
Jean-Philippe Gagné Guay for the contribution in pull request 44 over
at the GitHub mirror: <a href="https://github.com/protesilaos/denote/pull/44">https://github.com/protesilaos/denote/pull/44</a>.
</p>

<p>
Also thanks to user pRot0ta1p for the relevant feedback in issue 43
(also on the mirror): <a href="https://github.com/protesilaos/denote/issues/43">https://github.com/protesilaos/denote/issues/43</a>.
More thanks to Alfredo Borrás, Benjamin Kästner, and Sven Seebeck for
their comments in a related thread on the mailing list:
<a href="https://lists.sr.ht/~protesilaos/denote/%3CCA73E705-1194-4324-9962-70708C4C72E5%40zoho.eu%3E">https://lists.sr.ht/~protesilaos/denote/%3CCA73E705-1194-4324-9962-70708C4C72E5%40zoho.eu%3E</a>.
These discussions showed we had a problem, which we managed to
identify.
</p></li>

<li><p>
Introduced the user option <code>denote-prompts</code> (read its doc string or
the relevant entry in the manual).  It governs how the standard
<code>denote</code> command for creating new notes will behave in interactive
usage.  By default, <code>denote</code> prompts for a title and keywords.  With
<code>denote-prompts</code>, the command can also ask for a file type (per
<code>denote-file-type</code>), subdirectory of the <code>denote-directory</code>, and a
specific date+time.  Prompts occur in the order they are specified.
Furthermore, the <code>denote-prompts</code> can be set to values which do not
include the title and keywords.  This means that the resulting file
names can be any of those permutations:
</p>

<pre class="example">
DATE.EXT
DATE--TITLE.EXT
DATE__KEYWORDS.EXT
</pre>


<p>
Recall that Denote&rsquo;s standard file-naming scheme is defined as follows
(read the manual for the details):
</p>

<pre class="example">
DATE--TITLE__KEYWORDS.EXT
</pre>


<p>
For our purposes, Denote will work perfectly fine for linking and
backlinking, even if file names do not include the <code>TITLE</code> and
<code>KEYWORDS</code> fields.  However, the user is advised to consider the
implications on usability: notes without a descriptive title and/or
useful keywords may be hard to filter and practically impossible to
manage at scale.  File names without such information should at least
be added to subdirectories which themselves have a descriptive name.
</p>

<p>
At any rate, Denote does not have strong opinions about one&rsquo;s
workflow.  The standard file name is the culmination of years of
experience.
</p>

<p>
Consider the <code>denote-prompts</code> the affirmative answer to the question
&ldquo;Can keywords be optional?&rdquo; as posed by Jack Baty on the mailing list:
<a href="https://lists.sr.ht/~protesilaos/denote/%3C8D392BC3-980A-4E5B-9480-D6A00BE8279F%40baty.net%3E">https://lists.sr.ht/~protesilaos/denote/%3C8D392BC3-980A-4E5B-9480-D6A00BE8279F%40baty.net%3E</a>.
</p>

<p>
Thanks to Jean-Philippe Gagné Guay for the original contribution in
commit 9b981a2.  It was originally part of a pull request, but due to
some internal changes I had to merge it as a patch and technically the
web UI did not count the PR as &ldquo;merged&rdquo; (though it was in terms of
substance).
</p></li>

<li><p>
Refactored the <code>denote</code> command to (i) accommodate the new user option
<code>denote-prompts</code> via its interactive specification and (ii) be more
flexible when called from Lisp.  The latter scenario is for advanced
users or, generally, those who can maintain some custom code in their
configuration.  A case in point is one of the examples we show in the
manual for a programmatic way to create notes that automatically get
the <code>journal</code> tag:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (defun my-denote-journal ()
    "Create an entry tagged 'journal', while prompting for a title."
    (interactive)
    (denote
     (denote--title-prompt)
     '("journal")))
</pre>
</div>

<p>
Notice that the <code>'("journal")</code> is a list of strings even for a single
keyword.  Whereas before a single one was a plain string.  This is a
breaking change.
</p>

<p>
Please consult the doc string of the <code>denote</code> command for the
technicalities.
</p></li>

<li><p>
Refashioned the interactive convenience functions of <code>denote-type</code>,
<code>denote-date</code>, <code>denote-subdirectory</code> to leverage the <code>denote-prompts</code>
user option while calling <code>denote</code> interactively.  In practical terms,
they no longer accept any arguments when called from Lisp.  Users who
need a programmatic approach are advised to either call <code>denote</code>
directly, or check how these commands <code>let</code> bind the <code>denote-prompts</code>
to carry out their operations.  The doc string of each command
explains how it works.  Or evaluate this to check the manual:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (info "(denote) Convenience commands for note creation")
</pre>
</div>

<p>
Else visit:
<a href="https://protesilaos.com/emacs/denote#h:887bdced-9686-4e80-906f-789e407f2e8f">https://protesilaos.com/emacs/denote#h:887bdced-9686-4e80-906f-789e407f2e8f</a>
</p></li>

<li><p>
Documented how the user option <code>denote-directory</code> can accept a local
value.  This is pertinent to scenaria where the user needs to maintain
separate directories of notes.  By &ldquo;separate&rdquo; we mean sets of notes
that do not communicate with each other, cannot create links between
them, etc.  The manual delves into the technicalities.  If you have
the Info entry installed, evaluate:
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (info "(denote) Maintain separate directories for notes")
</pre>
</div>

<p>
Else visit:
<a href="https://protesilaos.com/emacs/denote#h:15719799-a5ff-4e9a-9f10-4ca03ef8f6c5">https://protesilaos.com/emacs/denote#h:15719799-a5ff-4e9a-9f10-4ca03ef8f6c5</a>.
</p>

<p>
Thanks to user &ldquo;Summer Emacs&rdquo; for starting the discussion on the
mailing list, and Benjamin Kästner for their participation:
<a href="https://lists.sr.ht/~protesilaos/denote/%3Cm25yk5e856.fsf@gmail.com%3E">https://lists.sr.ht/~protesilaos/denote/%3Cm25yk5e856.fsf@gmail.com%3E</a>.
</p></li>

<li>Added an entry to the manual&rsquo;s Frequently Asked Questions about a
failed search for backlinks.  It includes sample code that users of
Windows can apply, if necessary.  (The error is not Denote&rsquo;s fault.)
Thanks to Benjamin Kästner for the patch, which is below the ~15 line
threshold and thus does not require copyright assignment to the Free
Software Foundation:
<a href="https://lists.sr.ht/~protesilaos/denote/%3Cce117b14-55cf-622e-6cd8-0af698091ae3%40gmail.com%3E">https://lists.sr.ht/~protesilaos/denote/%3Cce117b14-55cf-622e-6cd8-0af698091ae3%40gmail.com%3E</a>.</li>

<li>Removed duplicate entries from the list of file paths that the <code>xref</code>
library returns for the purposes of backlinking.  Thanks to
Jean-Philippe Gagné Guay for the contribution in pull request 44 on
the GitHub mirror: <a href="https://github.com/protesilaos/denote/issues/44">https://github.com/protesilaos/denote/issues/44</a>.</li>

<li>Applied an appropriate face to the backlinks&rsquo; button to mitigate an
error.  Thanks to Jean-Philippe Gagné Guay for the contribution in
pull request 45 on the GitHub mirror and for later testing a
subsequent tweak: <a href="https://github.com/protesilaos/denote/issues/45">https://github.com/protesilaos/denote/issues/45</a>.</li>

<li>Simplfied all the faces we define to make them work with all themes.
The previous colours were consistent with the <code>modus-themes</code>:
<a href="https://protesilaos.com/emacs/modus-themes">https://protesilaos.com/emacs/modus-themes</a>.</li>

<li>Refined how strings are sluggified under all circumstances.  Before, a
nil value for the user option <code>denote-allow-multi-word-keywords</code> would
have the adverse effect of joining all the strings in the title field
of the file name.  The intent always was to do that only for
multi-word keywords, not the title.  This change was part of a hotfix,
formalised as version <code>0.2.1</code> a day after the release of <code>0.2.0</code>.</li>

<li>Made the fontification rules more robust, while avoiding any false
positives.  This was done over a series of commits as it had
implications for the file name permutations that were mentioned
earlier.  Thanks to Jean-Philippe Gagné Guay for the patches and/or
discussion about the merits of each change and concomitant
considerations:

<ul class="org-ul">
<li><a href="https://github.com/protesilaos/denote/pull/36">https://github.com/protesilaos/denote/pull/36</a></li>
<li><a href="https://github.com/protesilaos/denote/pull/38">https://github.com/protesilaos/denote/pull/38</a></li>
<li><a href="https://github.com/protesilaos/denote/pull/40">https://github.com/protesilaos/denote/pull/40</a></li>
<li><a href="https://github.com/protesilaos/denote/pull/42">https://github.com/protesilaos/denote/pull/42</a></li>
</ul></li>

<li>Rewrote all relevant entries in the manual to reflect all the
user-facing aspects of the aforementioned.</li>

<li><p>
Discussed a use-case of rewriting old journal entries as Denote-style
files.  As of this writing, we do not support migration of files in
bulk.  It might happen at some point, though it is no mean task.
Thanks to Summer Emacs and Alan Schmitt for their participation:
<a href="https://lists.sr.ht/~protesilaos/denote/%3Cm27d4mbktj.fsf%40gmail.com%3E">https://lists.sr.ht/~protesilaos/denote/%3Cm27d4mbktj.fsf%40gmail.com%3E</a>.
</p>

<p>
An aside here as this topic was brought up: my packages are open to
users of all skill levels and is why I maintain a mailing list as well
as mirrors of the official git repository on SourceHut.  Do not
hesitate to ask a question.  If, for whatever reason, those
communication channels are not appropriate, you are welcome to contact
me in private: <a href="https://protesilaos.com/contact">https://protesilaos.com/contact</a>.
</p></li>
</ul>

<p>
Thanks again to Jean-Philippe Gagné Guay for the numerous contributions.
Please read the commit log for the minutia, as this change log entry
omitted some of the finer yet important details.
</p>
</div>
</div>
<div id="outline-container-h:2002fee6-3f0c-48be-9727-6d4e20f34856" class="outline-2">
<h2 id="h:2002fee6-3f0c-48be-9727-6d4e20f34856"><span class="section-number-2">16.</span> Version 0.2.0 on 2022-07-04</h2>
<div class="outline-text-2" id="text-h:2002fee6-3f0c-48be-9727-6d4e20f34856">
<ul class="org-ul">
<li>Version <code>0.1.0</code> (from 2022-06-27) was never built as a package.  The
reason is that the GNU ELPA machinery reads the <code>Version:</code> header of
the main file, not the git tag.  As the original commit in <code>denote.el</code>
included <code>Version: 0.1.0</code>, GNU ELPA rightly tries to build the package
using that reference.  But because at that time I had not yet updated
the Copyright header to name the Free Software Foundation, the package
could not be prepared.  As such, please consider this release to be
the &ldquo;first formal stable version&rdquo;.  My apologies for the delay,
contrary to what was promised in the last change log entry.

<ul class="org-ul">
<li>Prospective users are advised to read the manual:
<a href="https://protesilaos.com/emacs/denote">https://protesilaos.com/emacs/denote</a>.  For a video demonstration:
<a href="https://protesilaos.com/codelog/2022-06-18-denote-demo/">https://protesilaos.com/codelog/2022-06-18-denote-demo/</a>.</li>

<li>Thanks to Benjamin Kästner for reporting the issue with the GNU ELPA
package on the mailing list:
<a href="https://lists.sr.ht/~protesilaos/denote/%3C9d600ff0-4fed-2ad7-5dbc-5a194639a045@gmail.com%3E">https://lists.sr.ht/~protesilaos/denote/%3C9d600ff0-4fed-2ad7-5dbc-5a194639a045@gmail.com%3E</a>.</li>
</ul></li>

<li>Originally, Denote was designed to only work with notes in a flat
directory.  With code contributions from Jean-Philippe Gagné Guay,
support for subdirectories of the user option <code>denote-directory</code> is
now available.  This covers the case of creating links between notes,
following them, and viewing the backlinks&rsquo; buffer of the current
entry.

<ul class="org-ul">
<li>Thanks to Jean-Philippe for the contributions which took place on
the GitHub mirror:

<ul class="org-ul">
<li><a href="https://github.com/protesilaos/denote/pull/24">https://github.com/protesilaos/denote/pull/24</a></li>
<li><a href="https://github.com/protesilaos/denote/pull/25">https://github.com/protesilaos/denote/pull/25</a></li>
<li><a href="https://github.com/protesilaos/denote/pull/26">https://github.com/protesilaos/denote/pull/26</a></li>
</ul></li>

<li>Jean-Philippe Gagné Guay has assigned copyright to the Free Software
Foundation.  This is a prerequisite to contribute code to any
package on the official GNU ELPA archive (and to emacs.git for that
matter).</li>
</ul></li>

<li>The new <code>denote-subdirectory</code> command lets the user select a directory
to place the new note in.  Available candidates are the value of the
<code>denote-directory</code> as well as all of its subdirectories, minus <code>.git</code>.
In future versions, we will consider how to provide a blocklist or a
regexp filter for the user to specify which subdirectories should be
omitted from minibuffer completion.  Please consider providing your
feedback on the technicalities.

<ul class="org-ul">
<li>Thanks to Jean-Philippe Gagné Guay and Shreyas Ragavan for the
feedback in issue 31 on the GitHub mirror:
<a href="https://github.com/protesilaos/denote/issues/31">https://github.com/protesilaos/denote/issues/31</a>.</li>

<li>Thanks to Jean-Philippe Gagné Guay for fixing a potential problem in
how directories are represented when commands enter the directory
instead of selecting it (again, at the GitHub mirror):
<a href="https://github.com/protesilaos/denote/pull/35">https://github.com/protesilaos/denote/pull/35</a>.</li>
</ul></li>

<li>From 2022-06-24 to 2022-07-03, Denote provided support for links
between Org notes that leveraged the <code>id:</code> hyperlink type.
Discussions on the mailing list and the GitHub mirror revealed the
longer-term problems in our implementation.  In the Annex below, I
provide my detailed opinion on the matter.  The gist is that Denote
does not&#x2014;and will not&#x2014;create <code>id:</code> links between its notes, but
shall use the <code>denote:</code> hyperlink type instead (which works like the
standard <code>file:</code> type).  As the Annex explains, Denote is not org-roam
lite and we try not to engender such false expectations.

<ul class="org-ul">
<li>Despite the fact that the relevant patches are no longer applicable,
I wish to thank Kaushal Modi and Jean-Philippe Gagné Guay for their
contributions over at the GitHub mirror:

<ul class="org-ul">
<li><a href="https://github.com/protesilaos/denote/pull/20">https://github.com/protesilaos/denote/pull/20</a></li>
<li><a href="https://github.com/protesilaos/denote/pull/28">https://github.com/protesilaos/denote/pull/28</a></li>
</ul></li>
</ul></li>

<li><p>
The user option <code>denote-date-format</code> controls how the date and time is
recorded in the file&rsquo;s contents (what we call &ldquo;front matter&rdquo;).  When
nil (the default value), we use a file-type-specific format (also
check the user option <code>denote-file-type</code>):
</p>

<ul class="org-ul">
<li>For Org, an inactive timestamp is used, such as <code>[2022-06-30 Wed 15:31]</code>.</li>

<li>For Markdown, the RFC3339 standard is applied: <code>2022-06-30T15:48:00+03:00</code>.</li>

<li>For plain text, the format is that of ISO 8601: <code>2022-06-30</code>.</li>
</ul>

<p>
If the value is a string, ignore the above and use it instead.  The
string must include format specifiers for the date.  These are described
in the doc string of <code>format-time-string</code>.
</p>

<p>
The <code>denote-date-format</code> supersedes the now obsolete
<code>denote-front-matter-date-format</code>.
</p>

<p>
Thanks to Peter Prevos and Kaushal Modi for their feedback in issue 27
on the GitHub mirror: <a href="https://github.com/protesilaos/denote/issues/27">https://github.com/protesilaos/denote/issues/27</a>.
</p></li>

<li>All the faces we define are now declared in the <code>denote-faces.el</code>
file.  The fontification rules are shared by <code>denote-dired-mode</code> and
the backlinks&rsquo; buffer (invoked by <code>denote-link-backlinks</code> and
controlled by the user option <code>denote-link-fontify-backlinks</code>).  The
current list of faces:

<ul class="org-ul">
<li><code>denote-faces-date</code></li>
<li><code>denote-faces-delimiter</code></li>
<li><code>denote-faces-extension</code></li>
<li><code>denote-faces-keywords</code></li>
<li><code>denote-faces-subdirectory</code></li>
<li><code>denote-faces-time</code></li>
<li><code>denote-faces-title</code></li>
</ul></li>

<li>Named the mailing list address as the <code>Maintainer:</code> of Denote.
Together with the other package headers, they help the user find our
primary sources and/or communication channels.  This change conforms
with work being done upstream in package.el by Philip Kaludercic.  I
was informed about it here:
<a href="https://lists.sr.ht/~protesilaos/general-issues/%3C875ykl84yi.fsf%40posteo.net%3E">https://lists.sr.ht/~protesilaos/general-issues/%3C875ykl84yi.fsf%40posteo.net%3E</a>.</li>

<li>Fixed how keywords are inferred and combined.  The previous code did not
work properly when the user option <code>denote-infer-keywords</code> was nil.
It would return a list of symbols, with the parentheses, whereas the
file name needs a string where each keyword is delimited by an
underscore.</li>

<li>Simplified how information in the front matter is retrieved.  It fixes
cases where, for example, a special character at the end of the title
was ignored.  Thanks to Jean-Philippe Gagné Guay for the patch over at
the GitHub mirror: <a href="https://github.com/protesilaos/denote/pull/21">https://github.com/protesilaos/denote/pull/21</a>.</li>

<li>Rewrote parts of the manual in the interest of clarity.</li>
</ul>
</div>
<div id="outline-container-h:647d6155-1ac3-4ecb-bd4c-06d09fecd3ba" class="outline-3">
<h3 id="h:647d6155-1ac3-4ecb-bd4c-06d09fecd3ba"><span class="section-number-3">16.1.</span> Annex about discontinuing support for org-id</h3>
<div class="outline-text-3" id="text-h:647d6155-1ac3-4ecb-bd4c-06d09fecd3ba">
<p>
My thanks for their participation in the discussions go to Jean-Philippe
Gagné Guay, Kaushal Modi, and Shreyas Ragavan.
</p>

<pre class="example" id="org4469f1b">
commit f35ef05cb451f265213c3aafc1e62c425b1ff043
Author: Protesilaos Stavrou &lt;info@protesilaos.com&gt;
Date:   Sun Jul 3 17:34:38 2022 +0300

    REMOVE support for 'id:' hyperlink types

    The original idea was to support the 'org-id' library on the premise
    that it makes Denote a good Emacs citizen.  However, discussions on the
    mailing list[0] and the GitHub mirror[1] have made it clear to me that
    'org-id' is not consistent with Denote's emphasis on simplicity.

    To support the way 'org-id' works, we will eventually have to develop
    some caching mechanism, just how the org-roam package does it.  This is
    because the variable 'org-id-extra-files' needs to be kept up-to-date
    whenever an operation on a file is performed.  At scale, this sort of
    monitoring requires specialised software.  Such a mechanism is outside
    the scope of Denote---if you need a db, use org-roam which is already
    great.

    [0] &lt;https://lists.sr.ht/~protesilaos/denote/%3C8735fk4y1w.fsf%40hallac.net%3E#%3C877d4un73c.fsf@protesilaos.com%3E&gt;

    [1] &lt;https://github.com/protesilaos/denote/issues/29&gt;

    Quote of what I wrote on the GitHub mirror issue 29:

            [ggjp] This is what I was implying.  That we are, in fact,
            providing an option that is not viable long-term, but keeping
            the option for expert users who will be able to handle this.
            And we should warn about this clearly in the doc of that option.

        [protesilaos] What you write here @ggjp and what @shrysr explained
        tells me that those expert users will need to be real experts.  To
        put it concretely, I am an experienced Emacs user with no
        programming background, who has written several Emacs
        packages (including the modus-themes which are built into Emacs),
        but I have zero knowledge of using a db or of handling things with
        python and the like.  So if I opt in to 'denote-link-use-org-id' I
        will eventually run into problems that my non-existent skills will
        prevent me from solving.  At that point, I will just use org-roam
        which already handles this use-case in a competent way (and has a
        massive community to rely on in case I need further support).

        If each package needs to write its own optimisations and maintain
        its own cache, to me this shows that 'org-id' is not good enough for
        the time being: more work needs to be done in org.git to provide a
        universal solution.

        I wanted to support 'org-id' by default on the premise that Denote
        must be a good Emacs citizen which interoperates with the rest of
        the wider ecosystem.  But if 'org-id' leaves something to be
        desired, then that goal is not worth pursuing: we add complexity to
        our code, offer an option that we cannot genuinely/adequately
        support, and make usage of it contingent on reading the docs and
        having a high level of expertise.

        I think being a good Emacs citizen is a laudable principle.  In this
        case, the right thing to do is to recommend the use of org-roam
        instead of trying to accommodate 'org-id'.  As such, I have now
        changed my mind and think we should remove what we previously added.

        For some context here: the reason I never used org-roam is
        because (i) it is Org-specific whereas I write notes in different
        file types and (ii) I did not want to ever rely on a db or
        equivalent dependency.

        &lt;https://github.com/protesilaos/denote/issues/29#issuecomment-1173036924&gt;

 README.org         | 226 ++++++++---------------------------------------------
 denote-link.el     |  99 ++++++-----------------
 denote-retrieve.el |   2 +-
 denote.el          |  14 +---
 4 files changed, 63 insertions(+), 278 deletions(-)
</pre>

<p>
Followed up by my explanation:
</p>

<div class="org-src-container">
<pre class="src src-text">&gt; can we not have denote style links to be default for (de)notes - and
&gt; explicitly supported, while if they need to, users can still link
&gt; denote org files via org-id to any other notes/files (and vice versa)
&gt; -- in which case performance + testing for org-id driven linking is
&gt; not within Denote's purview at all?

The formal support for `id:` links was added shortly before the release
of version `0.1.0`.  In the days prior, we supported what you describe
via the manual.  The user could change the `denote-org-front-matter`
variable to include a `PROPERTIES` drawer.  This possibility still
exists, though yesterday I removed the relevant entry from the manual.
This way only the real do-it-yourself experts will go down that path.

My concern here is with managing expectations.  If our Org notes are
superficially the same as org-roam's, an unsuspecting user may think
that Denote is an org-roam lite.  We will thus get issues/requests, such
as those already mentioned in this GitHub repo, about migrating from
org-roam to Denote.  While there are similarities, Denote is not a
minimalist org-roam and I would not like to encourage the idea of
treating the two as interchangeable.

Doing things half-way-through is a way to create false expectations.  A
package on GNU ELPA must be usable by users of all skill levels.  If the
functionality we provide is incomplete and needs to be covered by
user-level tweaks, we are excluding a portion of the user base while
still assuming the maintenance burden.  If someone trusts Denote to,
say, write a 1000 notes, we do not want to surprise them after the fact.
Imagine if the reported issues that triggered this change happened 6
months into one's daily usage of Denote: it wouldn't be nice.

Setting the right expectations is a matter of responsibility: we let the
user make a more informed choice and show respect for their time.  It
also makes it easier for me to keep Denote's scope in check by not
supporting every little extra that Org implements.  The premier Org
extension is org-roam: we do not need another one (or, if we do, I am
not the one to implement it).

* * *

Some comments on the `denote:` hyperlink type for Org as they may be
relevant in this context:

* It is meant to work like the standard `file:` type.  This means that
  it links to a file, while it can also have additional search
  parameters, as explained in the Org manual.  Evaluate:

      (info "(org) Search Options")

* It does not read the front matter, but only the file name.  You can
  create a note as usual, delete all its contents, save it, and try to
  link to it from another note.  It works.

* Exporting now works like the `file:` type for HTML, LaTeX, Texinfo,
  and Markdown.  Technically, it also supports the ASCII backend but the
  format of the output could be tweaked further.

There may be refinements to be made, which is okay as that is part of a
maintainer's duties.
</pre>
</div>
</div>
</div>
</div>
<div id="outline-container-h:33939747-ad60-4913-a170-4b2f48f139cc" class="outline-2">
<h2 id="h:33939747-ad60-4913-a170-4b2f48f139cc"><span class="section-number-2">17.</span> Version 0.1.0 on 2022-06-27</h2>
<div class="outline-text-2" id="text-h:33939747-ad60-4913-a170-4b2f48f139cc">
<p>
The present entry is intended for early adopters of Denote who may have
not caught up with the latest developments.  Prospective users are
advised to read the manual: <a href="https://protesilaos.com/emacs/denote">https://protesilaos.com/emacs/denote</a>.  For
a video demonstration: <a href="https://protesilaos.com/codelog/2022-06-18-denote-demo/">https://protesilaos.com/codelog/2022-06-18-denote-demo/</a>.
</p>

<ul class="org-ul">
<li>The <code>denote</code> package on GNU ELPA will be available a few hours after
this release.  GNU ELPA provides the latest stable release.  To use a
development snapshot, read:
<a href="https://protesilaos.com/codelog/2022-05-13-emacs-elpa-devel/">https://protesilaos.com/codelog/2022-05-13-emacs-elpa-devel/</a>.</li>

<li>Remember that any significant contribution (above ~15 lines) requires
copyright assignment to the Free Software Foundation.  A form with
instructions is included in the manual&rsquo;s &ldquo;Contributing&rdquo; section:
<a href="https://protesilaos.com/emacs/denote#h:1ebe4865-c001-4747-a6f2-0fe45aad71cd">https://protesilaos.com/emacs/denote#h:1ebe4865-c001-4747-a6f2-0fe45aad71cd</a>.</li>

<li><p>
The front matter of notes in Org has changed to be compliant with the
standard <code>org-id</code> infrastructure.  A <code>PROPERTIES</code> drawer is added to
the top of the file, which includes an <code>ID</code> property with the value of
the Denote identifier.  Sample:
</p>

<div class="org-src-container">
<pre class="src src-org">  :PROPERTIES:
  :ID:          20220610T202537
  :END:
  #+title:      Sample Org front matter
  #+date:       2022-06-10
  #+filetags:   denote  testing
</pre>
</div></li>

<li><p>
The front matter of Markdown (YAML or TOML) and plain text files
remains constant.  For completeness, this is how they look:
</p>

<div class="org-src-container">
<pre class="src src-md">   ---
   title:      "Sample with Markdown and YAML"
   date:       2022-06-10
   tags:       denote  testing
   identifier: "20220610T202021"
   ---
</pre>
</div>

<div class="org-src-container">
<pre class="src src-md">  +++
  title      = "Sample with Markdown and TOML"
  date       = 2022-06-10
  tags       = ["denote", "testing"]
  identifier = "20220610T201510"
  +++
</pre>
</div>

<pre class="example" id="orge6337b7">
  title:      Sample plain text
  date:       2022-06-10
  tags:       denote  testing
  identifier: 20220610T202232
  ---------------------------
</pre></li>

<li>The integration with <code>org-id</code> extends to how linking works.  By
default, Denote uses its own custom hyperlink type which starts with
the <code>denote:</code> prefix.  In Org, it works like the <code>file:</code> type.  When
the user option <code>denote-link-use-org-id</code> is non-nil, links from Org
notes to other Org notes will use the standard <code>id:</code> type instead.  As
this is an Org-specific feature, Denote takes care to use the
major-mode-agnostic <code>denote:</code> type when the link targets a non-Org
note.</li>

<li><p>
In Org files the links created by Denote are buttonized automatically.
For Markdown and plain text, we use our own methods.  When a link is
inserted it is buttonized outright.  To buttonize links in existing
notes while visiting them in a buffer, add/evaluate this (it excludes
Org on its own):
</p>

<div class="org-src-container">
<pre class="src src-emacs-lisp">  (add-hook 'find-file-hook #'denote-link-buttonize-buffer)
</pre>
</div></li>

<li>The generation of the backlinks&rsquo; buffer now uses the built-in <code>xref</code>
library instead of relying on a hardcoded call to the <code>find</code>
executable.  This means that the <code>denote-link-backlinks</code> command will,
in principle, work properly with all Emacs builds.</li>

<li>Users of Emacs 28 or higher can configure <code>xref-search-program</code> to
change from the default <code>grep</code> to <code>ripgrep</code>, <code>ugrep</code>, or a
user-defined alternative.</li>

<li>This is the first stable release of Denote.  It covers close to 400
commits starting from 2022-06-04.  Denote is the successor to a toy
package of mine, USLS, whose first public version was made available
in early November 2020: <a href="https://gitlab.com/protesilaos/usls">https://gitlab.com/protesilaos/usls</a>.</li>

<li>Thanks to everyone involved in the development of Denote.  Code
contributions, bug reports, discussion of ideas, are all valuable.
From A-Z the names mentioned in the manual&rsquo;s &ldquo;Acknowledgements&rdquo;
section: Colin McLear, Damien Cassou, Frank Ehmsen, Jack Baty, Kaushal
Modi, Peter Povinec, Sven Seebeck, Ypot.</li>

<li>Sources of Denote:

<ul class="org-ul">
<li>Package name (GNU ELPA): <code>denote</code></li>
<li>Official manual: <a href="https://protesilaos.com/emacs/denote">https://protesilaos.com/emacs/denote</a></li>
<li>Change log: <a href="https://protesilaos.com/emacs/denote-changelog">https://protesilaos.com/emacs/denote-changelog</a></li>
<li>Git repo on SourceHut: <a href="https://git.sr.ht/~protesilaos/denote">https://git.sr.ht/~protesilaos/denote</a>
<ul class="org-ul">
<li>Mirrors:
<ul class="org-ul">
<li>GitHub: <a href="https://github.com/protesilaos/denote">https://github.com/protesilaos/denote</a></li>
<li>GitLab: <a href="https://gitlab.com/protesilaos/denote">https://gitlab.com/protesilaos/denote</a></li>
</ul></li>
</ul></li>
<li>Mailing list: <a href="https://lists.sr.ht/~protesilaos/denote">https://lists.sr.ht/~protesilaos/denote</a></li>
</ul></li>
</ul>
</div>
</div>
